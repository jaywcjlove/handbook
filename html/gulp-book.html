<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>handbook</title>
        
    <link rel="stylesheet" type="text/css" href="../static/css/main.css">
</head>
<body>
<div class="navbar navbar-line">
    <div class="container">
        <div class="logo">
            
                handbook
            
        </div>
        <input type="checkbox" id="idoc_nav" />
        <div class="menu_tree">
        <ul><li><a href="../index.html">Backbone.js</a></li><li><a href="../html/Lua5.3.html">Lua5.3</a></li><li><a href="#"><span></span>Shortcuts</a><ul><li><a href="../html/Shortcuts/Sketch.html">Sketch</a></li><li><a href="../html/Shortcuts/bash.html">bash</a></li><li><a href="../html/Shortcuts/sublime.html">sublime</a></li></ul></li><li><a href="../html/git.html">git</a></li><li><a href="#"><span></span>测试工具</a><ul><li><a href="../html/测试工具/chai.html">chai</a></li><li><a href="../html/测试工具/mocha.html">mocha</a></li><li><a href="../html/测试工具/should.html">should</a></li></ul></li><li class="active"><a href="../html/gulp-book.html">gulp-book</a></li><li><a href="../html/shell常用命令.html">shell常用命令</a></li><li><a href="../html/MySQL安装.html">MySQL安装</a></li><li><a href="../html/Vim理解.html">Vim理解</a></li></ul>    
        </div>
        
        
        <div class="forkgithub"><a target="_blank" href="https://github.com/jaywcjlove/handbook">fork on github</a></div>
        

        <section class="idoc_nav_btn">
            <label for="idoc_nav"><span></span></label>
        </section>
    </div>
    
</div>




<div class="container">

    <div class="page-toc">
        <ul><li><a href="#t0安装gulp">安装gulp</a><ul><li><a href="#t1使用终端/命令行">使用终端/命令行</a></li><li><a href="#t2命令行">命令行</a></li><li><a href="#t3终端(Mac)">终端(Mac)</a></li><li><a href="#t4查看 node 版本号">查看 node 版本号</a></li><li><a href="#t5跳转目录">跳转目录</a><ul><li><a href="#t6Windows">Windows</a></li><li><a href="#t7Mac">Mac</a></li></ul></li><li><a href="#t8退出运行状态">退出运行状态</a></li><li><a href="#t9npm 模块管理器">npm 模块管理器</a></li><li><a href="#t10安装 gulp">安装 gulp</a></li></ul></li><li><a href="#t11压缩JS">压缩JS</a><ul><li><a href="#t12操作步骤">操作步骤</a><ul><li><a href="#t13新建gulpfile.js文件">新建gulpfile.js文件</a></li><li><a href="#t14gulpfile.js 中编码">gulpfile.js 中编码</a></li><li><a href="#t15获取gulp-uglify组件">获取gulp-uglify组件</a></li><li><a href="#t16创建压缩任务">创建压缩任务</a></li><li><a href="#t17进入项目目录">进入项目目录</a></li><li><a href="#t18使用命令行运行任务">使用命令行运行任务</a></li><li><a href="#t19安装 gulp-uglify 模块">安装 gulp-uglify 模块</a></li><li><a href="#t20编写 js 文件">编写 js 文件</a></li><li><a href="#t21检测代码修改自动执行任务">检测代码修改自动执行任务</a></li><li><a href="#t22使用定义默认任务">使用定义默认任务</a></li></ul></li></ul></li><li><a href="#t23压缩 CSS">压缩 CSS</a><ul><li><a href="#t24操作步骤">操作步骤</a><ul><li><a href="#t25安装 gulp-minify-css">安装 gulp-minify-css</a></li><li><a href="#t26创建 gulpfile.js 文件">创建 gulpfile.js 文件</a></li><li><a href="#t27创建 css 文件">创建 css 文件</a></li><li><a href="#t28运行 gulp 查看效果">运行 gulp 查看效果</a></li></ul></li></ul></li><li><a href="#t29压缩图片">压缩图片</a><ul><li><a href="#t30操作步骤">操作步骤</a><ul><li><a href="#t31安装 gulp-imagemin">安装 gulp-imagemin</a></li><li><a href="#t32创建 gulpfile.js 文件">创建 gulpfile.js 文件</a></li><li><a href="#t33在 images/ 目录下存放图片">在 images/ 目录下存放图片</a></li><li><a href="#t34运行 gulp 查看效果">运行 gulp 查看效果</a></li></ul></li></ul></li><li><a href="#t35编译 LESS">编译 LESS</a><ul><li><a href="#t36安装">安装</a></li><li><a href="#t37基本用法">基本用法</a></li><li><a href="#t38编译后的对比">编译后的对比</a></li></ul></li><li><a href="#t39gulp 开发一个项目">gulp 开发一个项目</a><ul><li><a href="#t40package.json">package.json</a></li><li><a href="#t41安装依赖">安装依赖</a></li><li><a href="#t42设计目录结构">设计目录结构</a></li><li><a href="#t43让命令行输出的文字带颜色">让命令行输出的文字带颜色</a></li><li><a href="#t44配置 JS 任务">配置 JS 任务</a><ul><li><a href="#t45gulp-uglify">gulp-uglify</a></li><li><a href="#t46gulp-watch-path">gulp-watch-path</a></li><li><a href="#t47stream-combiner2">stream-combiner2</a></li><li><a href="#t48gulp-sourcemaps">gulp-sourcemaps</a></li></ul></li><li><a href="#t49配置 CSS 任务">配置 CSS 任务</a><ul><li><a href="#t50gulp-minify-css">gulp-minify-css</a></li><li><a href="#t51gulp-autoprefixer">gulp-autoprefixer</a></li></ul></li><li><a href="#t52配置 Less 任务">配置 Less 任务</a></li><li><a href="#t53配置 Sass 任务">配置 Sass 任务</a></li><li><a href="#t54配置 image 任务">配置 image 任务</a></li><li><a href="#t55配置文件复制任务">配置文件复制任务</a></li><li><a href="#t56结语">结语</a></li></ul></li></ul>
    </div>
    
    <div class="content markdown-body">
        <p>&#x6765;&#x6E90;&#x4E8E;&#x6B64;<a href="https://github.com/nimojs/gulp-book">&#x8F6C;&#x8F7D;</a></p>
<h1 id="t0&#x5B89;&#x88C5;gulp">&#x5B89;&#x88C5;gulp <a href="#t0&#x5B89;&#x88C5;gulp"> # </a></h1>
<p>gulp &#x662F;&#x57FA;&#x4E8E; node &#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x5C31;&#x9700;&#x8981;&#x5148;&#x5B89;&#x88C5; node&#x3002;</p>
<blockquote>
<p>Node &#x662F;&#x4E00;&#x4E2A;&#x57FA;&#x4E8E;Chrome JavaScript V8&#x5F15;&#x64CE;&#x5EFA;&#x7ACB;&#x7684;&#x4E00;&#x4E2A;&#x5E73;&#x53F0;&#xFF0C;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x5B83;&#x5B9E;&#x73B0; Web&#x670D;&#x52A1;&#xFF0C;&#x505A;&#x7C7B;&#x4F3C;PHP&#x7684;&#x4E8B;&#x3002;</p>
</blockquote>
<p>&#x6253;&#x5F00; <a href="https://nodejs.org/">https://nodejs.org/</a> &#x70B9;&#x51FB;&#x7EFF;&#x8272;&#x7684; <strong>INSTALL</strong> &#x6309;&#x94AE;&#x4E0B;&#x8F7D;&#x5B89;&#x88C5; node&#x3002;</p>
<p><a href="https://github.com/nimojs/gulp-book/issues/10">&#x8BBF;&#x95EE;&#x8BBA;&#x575B;&#x83B7;&#x53D6;&#x5E2E;&#x52A9;</a></p>
<h2 id="t1&#x4F7F;&#x7528;&#x7EC8;&#x7AEF;/&#x547D;&#x4EE4;&#x884C;">&#x4F7F;&#x7528;&#x7EC8;&#x7AEF;/&#x547D;&#x4EE4;&#x884C; <a href="#t1&#x4F7F;&#x7528;&#x7EC8;&#x7AEF;/&#x547D;&#x4EE4;&#x884C;"> # </a></h2>
<h2 id="t2&#x547D;&#x4EE4;&#x884C;">&#x547D;&#x4EE4;&#x884C; <a href="#t2&#x547D;&#x4EE4;&#x884C;"> # </a></h2>
<p>&#x5728; Windows &#x4E2D;&#x53EF;&#x6309; <kbd>&#x5FBD;&#x6807;&#x952E;</kbd>&#xFF08;alt&#x952E;&#x5DE6;&#x8FB9;&#xFF09;+ <kbd>R</kbd> &#x6253;&#x5F00;&#x8F93;&#x5165; <code>cmd</code> + <kbd>Enter</kbd> &#x6253;&#x5F00;&#x547D;&#x4EE4;&#x884C;&#x3002;</p>
<h2 id="t3&#x7EC8;&#x7AEF;(Mac)">&#x7EC8;&#x7AEF;(Mac) <a href="#t3&#x7EC8;&#x7AEF;(Mac)"> # </a></h2>
<p>&#x6253;&#x5F00; Launchpad&#xFF08;&#x50CF;&#x706B;&#x7BAD;&#x4E00;&#x6837;&#x7684;&#x56FE;&#x6807;&#xFF09;&#xFF0C;&#x5728;&#x5C4F;&#x5E55;&#x4E0A;&#x65B9;&#x641C;&#x7D22;&#x6846;&#x4E2D;&#x8F93;&#x5165; <code>&#x7EC8;&#x7AEF;</code> + <kbd>Enter</kbd> &#x6253;&#x5F00;&#x7EC8;&#x7AEF;&#x3002;</p>
<h2 id="t4&#x67E5;&#x770B; node &#x7248;&#x672C;&#x53F7;">&#x67E5;&#x770B; node &#x7248;&#x672C;&#x53F7; <a href="#t4&#x67E5;&#x770B; node &#x7248;&#x672C;&#x53F7;"> # </a></h2>
<p>&#x5728;&#x7EC8;&#x7AEF;/&#x547D;&#x4EE4;&#x884C;&#x4E2D;&#x8F93;&#x5165; <code>node -v</code> &#x68C0;&#x6D4B;node&#x662F;&#x5426;&#x5B89;&#x88C5;&#x6210;&#x529F;&#xFF0C;&#x5B89;&#x88C5;&#x6210;&#x529F;&#x4F1A;&#x663E;&#x793A;&#x51FA; node &#x7684;&#x7248;&#x672C;&#x53F7;&#x3002;</p>
<h2 id="t5&#x8DF3;&#x8F6C;&#x76EE;&#x5F55;">&#x8DF3;&#x8F6C;&#x76EE;&#x5F55; <a href="#t5&#x8DF3;&#x8F6C;&#x76EE;&#x5F55;"> # </a></h2>
<p>&#x7EC8;&#x7AEF;/&#x547D;&#x4EE4;&#x884C; &#x4E2D;&#x53EF;&#x4F7F;&#x7528; <code>cd &#x76EE;&#x5F55;&#x540D;</code> &#x8DF3;&#x8F6C;&#x81F3;&#x6307;&#x5B9A;&#x76EE;&#x5F55;&#xFF0C;Mac &#x4E2D;&#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <code>ls</code> &#x67E5;&#x770B;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x6587;&#x4EF6;&#x5217;&#x8868;&#x3002;</p>
<h3 id="t6Windows">Windows <a href="#t6Windows"> # </a></h3>
<p>Windows &#x4E0B;&#x53EF;&#x4F7F;&#x7528;&#x5982;&#x4E0B;&#x547D;&#x4EE4;&#x8DF3;&#x8F6C;&#x81F3;&#x6307;&#x5B9A;&#x76EE;&#x5F55;&#xFF1A;</p>
<pre><code>// &#x8DF3;&#x8F6C;&#x81F3; C &#x76D8;&#x6839;&#x76EE;&#x5F55;
cd c:\
// &#x8DF3;&#x8F6C;&#x81F3;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x7684; demo &#x6587;&#x4EF6;&#x5939;
cd demo
// &#x8DF3;&#x8F6C;&#x81F3;&#x4E0A;&#x4E00;&#x7EA7;
cd ..
</code></pre><h3 id="t7Mac">Mac <a href="#t7Mac"> # </a></h3>
<p>Mac &#x4E2D;&#x5EFA;&#x8BAE;&#x53EA;&#x5728; Documents &#x76EE;&#x5F55;&#x4E0B;&#x8FDB;&#x884C;&#x6587;&#x4EF6;&#x64CD;&#x4F5C;&#x3002;</p>
<pre><code>// &#x8DF3;&#x8F6C;&#x81F3;&#x6587;&#x6863;&#x76EE;&#x5F55;
cd /Users/&#x4F60;&#x7684;&#x7528;&#x6237;&#x540D;/Documents/
// &#x6216;&#x7B2C;&#x4E00;&#x6B21;&#x6253;&#x5F00;&#x7EC8;&#x7AEF;&#x65F6;&#x76F4;&#x63A5;&#x8F93;&#x5165;
cd Documents
// &#x67E5;&#x770B;&#x76EE;&#x5F55;&#x4E0B;&#x6587;&#x4EF6;&#x5217;&#x8868;
ls
// &#x521B;&#x5EFA;&#x6587;&#x4EF6;&#x5939;
mkdir demo
// &#x8DF3;&#x8F6C;&#x81F3;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x4E0B;&#x7684; demo &#x6587;&#x4EF6;&#x5939;
cd demo
// &#x8DF3;&#x8F6C;&#x81F3;&#x4E0A;&#x7EA7;&#x76EE;&#x5F55;
cd ..
</code></pre><h2 id="t8&#x9000;&#x51FA;&#x8FD0;&#x884C;&#x72B6;&#x6001;">&#x9000;&#x51FA;&#x8FD0;&#x884C;&#x72B6;&#x6001; <a href="#t8&#x9000;&#x51FA;&#x8FD0;&#x884C;&#x72B6;&#x6001;"> # </a></h2>
<p>&#x5982;&#x679C;&#x4F60;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x4E2D;&#x542F;&#x52A8;&#x4E86;&#x4E00;&#x4E9B;&#x4E00;&#x76F4;&#x8FD0;&#x884C;&#x7684;&#x547D;&#x4EE4;&#xFF0C;&#x4F60;&#x7684;&#x547D;&#x4EE4;&#x884C;&#x4F1A;&#x8FDB;&#x5165;&#x201C;&#x8FD0;&#x884C;&#x201D;&#x72B6;&#x6001;&#xFF0C;&#x6B64;&#x65F6;&#x4F60;&#x4E0D;&#x53EF;&#x4EE5;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8FDB;&#x884C;&#x5176;&#x4ED6;&#x64CD;&#x4F5C;&#x3002;&#x53EF;&#x901A;&#x8FC7; <code>Ctrl + C</code> &#x505C;&#x6B62; gulp&#x3002;&#xFF08;Mac &#x4E2D;&#x4F7F;&#x7528; <code>control + C</code>&#xFF09;</p>
<p>&#x540E;&#x9762;&#x7684;&#x7AE0;&#x8282;&#x4E2D;&#x5982;&#x679C;&#x4EE3;&#x7801;&#x4E2D;&#x5B58;&#x5728; <code>gulp.watch</code> &#x5E76;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8FD0;&#x884C;&#x4E86; <code>gulp</code> &#x5219;&#x9700;&#x8981;&#x4F7F;&#x7528; <code>Ctrl + C</code> &#x9000;&#x51FA;&#x4EFB;&#x52A1;&#x3002;</p>
<h2 id="t9npm &#x6A21;&#x5757;&#x7BA1;&#x7406;&#x5668;">npm &#x6A21;&#x5757;&#x7BA1;&#x7406;&#x5668; <a href="#t9npm &#x6A21;&#x5757;&#x7BA1;&#x7406;&#x5668;"> # </a></h2>
<p>&#x5982;&#x679C;&#x4F60;&#x4E86;&#x89E3; npm &#x5219;&#x8DF3;&#x8FC7;&#x6B64;&#x7AE0;&#x8282;</p>
<p>&#x82E5;&#x4F60;&#x4E0D;&#x4E86;&#x89E3;npm &#x8BF7;&#x9605;&#x8BFB; <a href="http://javascript.ruanyifeng.com/nodejs/npm.html">npm&#x6A21;&#x5757;&#x7BA1;&#x7406;&#x5668;</a></p>
<h2 id="t10&#x5B89;&#x88C5; gulp">&#x5B89;&#x88C5; gulp <a href="#t10&#x5B89;&#x88C5; gulp"> # </a></h2>
<p>npm &#x662F; node &#x7684;&#x5305;&#x7BA1;&#x7406;&#x5DE5;&#x5177;&#xFF0C;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x5B83;&#x5B89;&#x88C5; gulp &#x6240;&#x9700;&#x7684;&#x5305;&#x3002;&#xFF08;&#x5728;&#x5B89;&#x88C5; node &#x65F6;&#x5DF2;&#x7ECF;&#x81EA;&#x52A8;&#x5B89;&#x88C5;&#x4E86; npm&#xFF09;</p>
<p>&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x5165;</p>
<pre><code>npm install -g gulp
</code></pre><p>&#x82E5;&#x4E00;&#x76F4;&#x6CA1;&#x5B89;&#x88C5;&#x6210;&#x529F;&#xFF0C;&#x8BF7;<a href="https://github.com/nimojs/blog/issues/20">&#x4F7F;&#x7528; cnpm &#x5B89;&#x88C5;</a>(npm&#x7684;&#x56FD;&#x5185;&#x52A0;&#x901F;&#x955C;&#x50CF;)</p>
<p>&#x610F;&#x601D;&#x662F;&#xFF1A;&#x4F7F;&#x7528; npm &#x5B89;&#x88C5;&#x5168;&#x5C40;&#x6027;&#x7684;(<code>-g</code>) gulp &#x5305;&#x3002;</p>
<blockquote>
<p>&#x5982;&#x679C;&#x4F60;&#x5B89;&#x88C5;&#x5931;&#x8D25;&#xFF0C;&#x8BF7;&#x8F93;&#x5165;<code>sudo npm install -g gulp</code>&#x4F7F;&#x7528;&#x7BA1;&#x7406;&#x5458;&#x6743;&#x9650;&#x5B89;&#x88C5;&#x3002;&#xFF08;&#x53EF;&#x80FD;&#x4F1A;&#x8981;&#x6C42;&#x8F93;&#x5165;&#x5BC6;&#x7801;&#xFF09;</p>
</blockquote>
<p>&#x5B89;&#x88C5;&#x65F6;&#x8BF7;&#x6CE8;&#x610F;&#x547D;&#x4EE4;&#x884C;&#x7684;&#x63D0;&#x793A;&#x4FE1;&#x606F;&#xFF0C;&#x5B89;&#x88C5;&#x5B8C;&#x6210;&#x540E;&#x53EF;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x5165; <code>gulp -v</code> &#x4EE5;&#x786E;&#x8BA4;&#x5B89;&#x88C5;&#x6210;&#x529F;&#x3002;</p>
<p>&#x81F3;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x5B8C;&#x6210;&#x4E86;&#x51C6;&#x5907;&#x5DE5;&#x4F5C;&#x3002;&#x63A5;&#x7740;&#x8BA9; gulp &#x5F00;&#x59CB;&#x5E2E;&#x6211;&#x4EEC;&#x5E72;&#x6D3B;&#x5427;&#xFF01;</p>
<p><a href="https://github.com/nimojs/gulp-book/issues/10">&#x8BBF;&#x95EE;&#x8BBA;&#x575B;&#x83B7;&#x53D6;&#x5E2E;&#x52A9;</a></p>
<h1 id="t11&#x538B;&#x7F29;JS">&#x538B;&#x7F29;JS <a href="#t11&#x538B;&#x7F29;JS"> # </a></h1>
<p>&#x538B;&#x7F29; js &#x4EE3;&#x7801;&#x53EF;&#x964D;&#x4F4E; js &#x6587;&#x4EF6;&#x5927;&#x5C0F;&#xFF0C;&#x63D0;&#x9AD8;&#x9875;&#x9762;&#x6253;&#x5F00;&#x901F;&#x5EA6;&#x3002;&#x5728;&#x4E0D;&#x5229;&#x7528; gulp &#x65F6;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x901A;&#x8FC7;&#x5404;&#x79CD;&#x5DE5;&#x5177;&#x624B;&#x52A8;&#x5B8C;&#x6210;&#x538B;&#x7F29;&#x5DE5;&#x4F5C;&#x3002;</p>
<p>&#x6240;&#x6709;&#x7684; gulp &#x4EE3;&#x7801;&#x7F16;&#x5199;&#x90FD;&#x53EF;&#x4EE5;&#x770B;&#x505A;&#x662F;&#x5C06;&#x89C4;&#x5F8B;&#x8F6C;&#x5316;&#x4E3A;&#x4EE3;&#x7801;&#x7684;&#x8FC7;&#x7A0B;&#x3002;</p>
<p><strong>&#x89C4;&#x5F8B;</strong></p>
<blockquote>
<p>&#x627E;&#x5230; <code>js/</code> &#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x6240;&#x6709; js &#x6587;&#x4EF6;&#xFF0C;&#x538B;&#x7F29;&#x5B83;&#x4EEC;&#xFF0C;&#x5C06;&#x538B;&#x7F29;&#x540E;&#x7684;&#x6587;&#x4EF6;&#x5B58;&#x653E;&#x5728; <code>dist/js/</code> &#x76EE;&#x5F55;&#x4E0B;&#x3002;</p>
</blockquote>
<h2 id="t12&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;">&#x64CD;&#x4F5C;&#x6B65;&#x9AA4; <a href="#t12&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;"> # </a></h2>
<p>&#x4F60;&#x53EF;&#x4EE5; <a href="https://github.com/nimojs/gulp-book/archive/master.zip">&#x4E0B;&#x8F7D;&#x6240;&#x6709;&#x793A;&#x4F8B;&#x4EE3;&#x7801;</a> &#x6216; <a href="https://github.com/nimojs/gulp-book/tree/master/demo/chapter2">&#x5728;&#x7EBF;&#x67E5;&#x770B;&#x4EE3;&#x7801;</a></p>
<p><strong>&#x5EFA;&#x8BAE;</strong>&#xFF1A;&#x4F60;&#x53EF;&#x4EE5;&#x53EA;&#x9605;&#x8BFB;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x4E0E;&#x6CE8;&#x91CA;&#x6216;&#x540C;&#x65F6;&#x9605;&#x8BFB;&#x4EE3;&#x7801;&#x89E3;&#x91CA;</p>
<p>gulp &#x7684;&#x6240;&#x6709;&#x914D;&#x7F6E;&#x4EE3;&#x7801;&#x90FD;&#x5199;&#x5728; <code>gulpfile.js</code> &#x6587;&#x4EF6;&#x3002;</p>
<h3 id="t13&#x65B0;&#x5EFA;gulpfile.js&#x6587;&#x4EF6;">&#x65B0;&#x5EFA;gulpfile.js&#x6587;&#x4EF6; <a href="#t13&#x65B0;&#x5EFA;gulpfile.js&#x6587;&#x4EF6;"> # </a></h3>
<pre><code>chapter2
&#x2514;&#x2500;&#x2500; gulpfile.js
</code></pre><h3 id="t14gulpfile.js &#x4E2D;&#x7F16;&#x7801;">gulpfile.js &#x4E2D;&#x7F16;&#x7801; <a href="#t14gulpfile.js &#x4E2D;&#x7F16;&#x7801;"> # </a></h3>
<pre><code class="lang-js"><span class="hljs-comment">// &#x83B7;&#x53D6; gulp</span>
<span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;gulp&apos;</span>)
</code></pre>
<blockquote>
<p><code>require()</code> &#x662F; node &#xFF08;CommonJS&#xFF09;&#x4E2D;&#x83B7;&#x53D6;&#x6A21;&#x5757;&#x7684;&#x8BED;&#x6CD5;&#x3002;</p>
<p>&#x5728; gulp &#x4E2D;&#x4F60;&#x53EA;&#x9700;&#x8981;&#x7406;&#x89E3; <code>require()</code> &#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x6A21;&#x5757;&#x3002;</p>
</blockquote>
<h3 id="t15&#x83B7;&#x53D6;gulp-uglify&#x7EC4;&#x4EF6;">&#x83B7;&#x53D6;gulp-uglify&#x7EC4;&#x4EF6; <a href="#t15&#x83B7;&#x53D6;gulp-uglify&#x7EC4;&#x4EF6;"> # </a></h3>
<pre><code class="lang-js"><span class="hljs-comment">// &#x83B7;&#x53D6; uglify &#x6A21;&#x5757;&#xFF08;&#x7528;&#x4E8E;&#x538B;&#x7F29; JS&#xFF09;</span>
<span class="hljs-keyword">var</span> uglify = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;gulp-uglify&apos;</span>)
</code></pre>
<h3 id="t16&#x521B;&#x5EFA;&#x538B;&#x7F29;&#x4EFB;&#x52A1;">&#x521B;&#x5EFA;&#x538B;&#x7F29;&#x4EFB;&#x52A1; <a href="#t16&#x521B;&#x5EFA;&#x538B;&#x7F29;&#x4EFB;&#x52A1;"> # </a></h3>
<pre><code class="lang-js"><span class="hljs-comment">// &#x538B;&#x7F29; js &#x6587;&#x4EF6;</span>
<span class="hljs-comment">// &#x5728;&#x547D;&#x4EE4;&#x884C;&#x4F7F;&#x7528; gulp script &#x542F;&#x52A8;&#x6B64;&#x4EFB;&#x52A1;</span>
gulp.task(<span class="hljs-string">&apos;script&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// 1. &#x627E;&#x5230;&#x6587;&#x4EF6;</span>
    gulp.src(<span class="hljs-string">&apos;js/*.js&apos;</span>)
    <span class="hljs-comment">// 2. &#x538B;&#x7F29;&#x6587;&#x4EF6;</span>
        .pipe(uglify())
    <span class="hljs-comment">// 3. &#x53E6;&#x5B58;&#x538B;&#x7F29;&#x540E;&#x7684;&#x6587;&#x4EF6;</span>
        .pipe(gulp.dest(<span class="hljs-string">&apos;dist/js&apos;</span>))
})
</code></pre>
<ul>
<li><code>gulp.task(name, fn)</code> - &#x5B9A;&#x4E49;&#x4EFB;&#x52A1;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x4EFB;&#x52A1;&#x540D;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x4EFB;&#x52A1;&#x5185;&#x5BB9;&#x3002;</li>
<li><code>gulp.src(path)</code> - &#x9009;&#x62E9;&#x6587;&#x4EF6;&#xFF0C;&#x4F20;&#x5165;&#x53C2;&#x6570;&#x662F;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;&#x3002;</li>
<li><code>gulp.dest(path)</code> - &#x8F93;&#x51FA;&#x6587;&#x4EF6;</li>
<li><code>gulp.pipe()</code> - &#x7BA1;&#x9053;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x6682;&#x65F6;&#x5C06; pipe &#x7406;&#x89E3;&#x4E3A;&#x5C06;&#x64CD;&#x4F5C;&#x52A0;&#x5165;&#x6267;&#x884C;&#x961F;&#x5217;</li>
</ul>
<p>&#x53C2;&#x8003;&#xFF1A;<a href="http://www.gulpjs.com.cn/docs/api/">gulp API&#x6587;&#x6863;</a></p>
<h3 id="t17&#x8FDB;&#x5165;&#x9879;&#x76EE;&#x76EE;&#x5F55;">&#x8FDB;&#x5165;&#x9879;&#x76EE;&#x76EE;&#x5F55; <a href="#t17&#x8FDB;&#x5165;&#x9879;&#x76EE;&#x76EE;&#x5F55;"> # </a></h3>
<p>&#x6253;&#x5F00;&#x547D;&#x4EE4;&#x884C;&#x4F7F;&#x7528; <code>cd</code> &#x547D;&#x4EE4;&#x8DF3;&#x8F6C;&#x81F3; <code>gulpfile.js</code> &#x6587;&#x4EF6;&#x6240;&#x5728;&#x76EE;&#x5F55;&#x3002;</p>
<p>&#x4F8B;&#x5982;&#x6211;&#x7684; <code>gulpfile.js</code> &#x6587;&#x4EF6;&#x4FDD;&#x5B58;&#x5728; <code>C:\gulp-book\demo\chapter2\gulpfile.js</code>&#x3002;</p>
<p>&#x90A3;&#x4E48;&#x5C31;&#x9700;&#x8981;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x5165;</p>
<pre><code>cd C:\gulp-book\demo\chapter2
</code></pre><blockquote>
<p>Mac &#x7528;&#x6237;&#x53EF;&#x4F7F;&#x7528; <code>cd Documents/gulp-book/demo/chapter2/</code> &#x8DF3;&#x8F6C;</p>
</blockquote>
<h3 id="t18&#x4F7F;&#x7528;&#x547D;&#x4EE4;&#x884C;&#x8FD0;&#x884C;&#x4EFB;&#x52A1;">&#x4F7F;&#x7528;&#x547D;&#x4EE4;&#x884C;&#x8FD0;&#x884C;&#x4EFB;&#x52A1; <a href="#t18&#x4F7F;&#x7528;&#x547D;&#x4EE4;&#x884C;&#x8FD0;&#x884C;&#x4EFB;&#x52A1;"> # </a></h3>
<p>&#x5728;&#x63A7;&#x5236;&#x53F0;&#x8F93;&#x5165; <code>gulp &#x4EFB;&#x52A1;&#x540D;</code> &#x53EF;&#x8FD0;&#x884C;&#x4EFB;&#x52A1;&#xFF0C;&#x6B64;&#x5904;&#x6211;&#x4EEC;&#x8F93;&#x5165; <code>gulp script</code> &#x56DE;&#x8F66;&#x3002;</p>
<p>&#x6CE8;&#x610F;&#xFF1A;&#x8F93;&#x5165; <code>gulp script</code> &#x540E;&#x547D;&#x4EE4;&#x884C;&#x5C06;&#x4F1A;&#x63D0;&#x793A;&#x9519;&#x8BEF;&#x4FE1;&#x606F;</p>
<pre><code>// &#x5728;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x5165;
gulp script

Error: Cannot find module &apos;gulp-uglify&apos;
    at Function.Module._resolveFilename (module.js:338:15)
    at Function.Module._load (module.js:280:25)
</code></pre><p><code>Cannot find module &apos;gulp-uglify&apos;</code> &#x6CA1;&#x6709;&#x627E;&#x5230; <code>gulp-uglify</code> &#x6A21;&#x5757;&#x3002;</p>
<h3 id="t19&#x5B89;&#x88C5; gulp-uglify &#x6A21;&#x5757;">&#x5B89;&#x88C5; gulp-uglify &#x6A21;&#x5757; <a href="#t19&#x5B89;&#x88C5; gulp-uglify &#x6A21;&#x5757;"> # </a></h3>
<p>&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x5E76;&#x6CA1;&#x6709;&#x5B89;&#x88C5; <code>gulp-uglify</code> &#x6A21;&#x5757;&#x5230;&#x672C;&#x5730;&#xFF0C;&#x6240;&#x4EE5;&#x627E;&#x4E0D;&#x5230;&#x6B64;&#x6A21;&#x5757;&#x3002;</p>
<p>&#x4F7F;&#x7528; npm &#x5B89;&#x88C5; <code>gulp-uglify</code> &#x5230;&#x672C;&#x5730;</p>
<pre><code>npm install gulp-uglify
</code></pre><p>&#x5B89;&#x88C5;&#x6210;&#x529F;&#x540E;&#x4F60;&#x4F1A;&#x770B;&#x5230;&#x5982;&#x4E0B;&#x4FE1;&#x606F;&#xFF1A;</p>
<pre><code>gulp-uglify@1.1.0 node_modules/gulp-uglify
&#x251C;&#x2500;&#x2500; deepmerge@0.2.7
&#x251C;&#x2500;&#x2500; uglify-js@2.4.16 (uglify-to-browserify@1.0.2, async@0.2.10, source-map@0.1.34, optimist@0.3.7)
&#x251C;&#x2500;&#x2500; vinyl-sourcemaps-apply@0.1.4 (source-map@0.1.43)
&#x251C;&#x2500;&#x2500; through2@0.6.3 (xtend@4.0.0, readable-stream@1.0.33)
&#x2514;&#x2500;&#x2500; gulp-util@3.0.4 (array-differ@1.0.0, beeper@1.0.0, array-uniq@1.0.2, object-assign@2.0.0, lodash._reinterpolate@3.0.0, lodash._reescape@3.0.0, lodash._reevaluate@3.0.0, replace-ext@0.0.1, minimist@1.1.1, chalk@1.0.0, lodash.template@3.3.2, vinyl@0.4.6, multipipe@0.1.2, dateformat@1.0.11)
chapter2 $
</code></pre><p>&#x5728;&#x4F60;&#x7684;&#x6587;&#x4EF6;&#x5939;&#x4E2D;&#x4F1A;&#x65B0;&#x589E;&#x4E00;&#x4E2A; <code>node_modules</code> &#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x8FD9;&#x91CC;&#x9762;&#x5B58;&#x653E;&#x7740; npm &#x5B89;&#x88C5;&#x7684;&#x6A21;&#x5757;&#x3002;</p>
<p>&#x76EE;&#x5F55;&#x7ED3;&#x6784;&#xFF1A;</p>
<pre><code>&#x251C;&#x2500;&#x2500; gulpfile.js
&#x2514;&#x2500;&#x2500; node_modules
    &#x2514;&#x2500;&#x2500; gulp-uglify
</code></pre><p>&#x63A5;&#x7740;&#x8F93;&#x5165; <code>gulp script</code> &#x6267;&#x884C;&#x4EFB;&#x52A1;</p>
<pre><code>gulp script
[13:34:57] Using gulpfile ~/Documents/code/gulp-book/demo/chapter2/gulpfile.js
[13:34:57] Starting &apos;script&apos;...
[13:34:57] Finished &apos;script&apos; after 6.13 ms
</code></pre><h3 id="t20&#x7F16;&#x5199; js &#x6587;&#x4EF6;">&#x7F16;&#x5199; js &#x6587;&#x4EF6; <a href="#t20&#x7F16;&#x5199; js &#x6587;&#x4EF6;"> # </a></h3>
<p>&#x6211;&#x4EEC;&#x53D1;&#x73B0; gulp &#x6CA1;&#x6709;&#x8FDB;&#x884C;&#x4EFB;&#x4F55;&#x538B;&#x7F29;&#x64CD;&#x4F5C;&#x3002;&#x56E0;&#x4E3A;&#x6CA1;&#x6709;js&#x8FD9;&#x4E2A;&#x76EE;&#x5F55;&#xFF0C;&#x4E5F;&#x6CA1;&#x6709; js &#x76EE;&#x5F55;&#x4E0B;&#x7684; <code>.js</code> &#x540E;&#x7F00;&#x6587;&#x4EF6;&#x3002;</p>
<p>&#x521B;&#x5EFA; <code>a.js</code> &#x6587;&#x4EF6;&#xFF0C;&#x5E76;&#x7F16;&#x5199;&#x5982;&#x4E0B;&#x5185;&#x5BB9;</p>
<pre><code>// a.js
function demo (msg) {
    alert(&apos;--------\r\n&apos; + msg + &apos;\r\n--------&apos;)
}

demo(&apos;Hi&apos;)
</code></pre><p>&#x76EE;&#x5F55;&#x7ED3;&#x6784;&#xFF1A;</p>
<pre><code>&#x251C;&#x2500;&#x2500; gulpfile.js
&#x251C;&#x2500;&#x2500;  js
&#x2502;   &#x2514;&#x2500;&#x2500; a.js
&#x2514;&#x2500;&#x2500; node_modules
    &#x2514;&#x2500;&#x2500; gulp-uglify
</code></pre><p>&#x63A5;&#x7740;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x5165; <code>gulp script</code> &#x6267;&#x884C;&#x4EFB;&#x52A1;</p>
<p>gulp &#x4F1A;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x4E0B;&#x521B;&#x5EFA; <code>dist/js/</code> &#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x5E76;&#x521B;&#x5EFA;&#x538B;&#x7F29;&#x540E;&#x7684; <code>a.js</code> &#x6587;&#x4EF6;&#x3002;</p>
<p>&#x76EE;&#x5F55;&#x7ED3;&#x6784;&#xFF1A;</p>
<pre><code>&#x251C;&#x2500;&#x2500; gulpfile.js
&#x251C;&#x2500;&#x2500;  js
&#x2502;   &#x2514;&#x2500;&#x2500; a.js
&#x251C;&#x2500;&#x2500;  dist
&#x2502;   &#x2514;&#x2500;&#x2500; js
&#x2502;       &#x2514;&#x2500;&#x2500; a.js
&#x2514;&#x2500;&#x2500; node_modules
    &#x2514;&#x2500;&#x2500; gulp-uglify
</code></pre><p><a href="https://github.com/nimojs/gulp-book/blob/master/demo/chapter2/dist/js/a.js">dist/js/a.js</a></p>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">demo</span>(<span class="hljs-params">n</span>)</span>{alert(<span class="hljs-string">&quot;--------\r\n&quot;</span>+n+<span class="hljs-string">&quot;\r\n--------&quot;</span>)}demo(<span class="hljs-string">&quot;Hi&quot;</span>);
</code></pre>
<h3 id="t21&#x68C0;&#x6D4B;&#x4EE3;&#x7801;&#x4FEE;&#x6539;&#x81EA;&#x52A8;&#x6267;&#x884C;&#x4EFB;&#x52A1;">&#x68C0;&#x6D4B;&#x4EE3;&#x7801;&#x4FEE;&#x6539;&#x81EA;&#x52A8;&#x6267;&#x884C;&#x4EFB;&#x52A1; <a href="#t21&#x68C0;&#x6D4B;&#x4EE3;&#x7801;&#x4FEE;&#x6539;&#x81EA;&#x52A8;&#x6267;&#x884C;&#x4EFB;&#x52A1;"> # </a></h3>
<p><code>js/a.js</code>&#x4E00;&#x65E6;&#x6709;&#x4FEE;&#x6539; &#x5C31;&#x5FC5;&#x987B;&#x91CD;&#x65B0;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x5165; <code>gulp script</code> &#xFF0C;&#x8FD9;&#x5F88;&#x9EBB;&#x70E6;&#x3002;</p>
<p>&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <code>gulp.watch(src, fn)</code> &#x68C0;&#x6D4B;&#x6307;&#x5B9A;&#x76EE;&#x5F55;&#x4E0B;&#x6587;&#x4EF6;&#x7684;&#x4FEE;&#x6539;&#x540E;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#x3002;</p>
<p>&#x5728; <code>gulpfile.js</code> &#x4E2D;&#x7F16;&#x5199;&#x5982;&#x4E0B;&#x4EE3;&#x7801;&#xFF1A;</p>
<pre><code>// &#x76D1;&#x542C;&#x6587;&#x4EF6;&#x4FEE;&#x6539;&#xFF0C;&#x5F53;&#x6587;&#x4EF6;&#x88AB;&#x4FEE;&#x6539;&#x5219;&#x6267;&#x884C; script &#x4EFB;&#x52A1;
gulp.watch(&apos;js/*.js&apos;, [&apos;script&apos;]);
</code></pre><p>&#x4F46;&#x662F;&#x6CA1;&#x6709;&#x547D;&#x4EE4;&#x53EF;&#x4EE5;&#x8FD0;&#x884C; <code>gulp.watch()</code>&#xFF0C;&#x9700;&#x8981;&#x5C06; <code>gulp.watch()</code> &#x5305;&#x542B;&#x5728;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x4E2D;&#x3002;</p>
<pre><code>// &#x5728;&#x547D;&#x4EE4;&#x884C;&#x4F7F;&#x7528; gulp auto &#x542F;&#x52A8;&#x6B64;&#x4EFB;&#x52A1;
gulp.task(&apos;auto&apos;, function () {
    // &#x76D1;&#x542C;&#x6587;&#x4EF6;&#x4FEE;&#x6539;&#xFF0C;&#x5F53;&#x6587;&#x4EF6;&#x88AB;&#x4FEE;&#x6539;&#x5219;&#x6267;&#x884C; script &#x4EFB;&#x52A1;
    gulp.watch(&apos;js/*.js&apos;, [&apos;script&apos;])
})
</code></pre><p>&#x63A5;&#x5728;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x5165; <code>gulp auto</code>&#xFF0C;&#x81EA;&#x52A8;&#x76D1;&#x542C; <code>js/*.js</code> &#x6587;&#x4EF6;&#x7684;&#x4FEE;&#x6539;&#x540E;&#x538B;&#x7F29;js&#x3002;</p>
<pre><code>$gulp auto
[21:09:45] Using gulpfile ~/Documents/code/gulp-book/demo/chapter2/gulpfile.js
[21:09:45] Starting &apos;auto&apos;...
[21:09:45] Finished &apos;auto&apos; after 9.19 ms
</code></pre><p>&#x6B64;&#x65F6;&#x4FEE;&#x6539; <code>js/a.js</code> &#x4E2D;&#x7684;&#x4EE3;&#x7801;&#x5E76;&#x4FDD;&#x5B58;&#x3002;&#x547D;&#x4EE4;&#x884C;&#x5C06;&#x4F1A;&#x51FA;&#x73B0;&#x63D0;&#x793A;&#xFF0C;&#x8868;&#x793A;&#x68C0;&#x6D4B;&#x5230;&#x6587;&#x4EF6;&#x4FEE;&#x6539;&#x5E76;&#x538B;&#x7F29;&#x6587;&#x4EF6;&#x3002;</p>
<pre><code>[21:11:01] Starting &apos;script&apos;...
[21:11:01] Finished &apos;script&apos; after 2.85 ms
</code></pre><p>&#x81F3;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x5B8C;&#x6210;&#x4E86; gulp &#x538B;&#x7F29; js &#x6587;&#x4EF6;&#x7684;&#x81EA;&#x52A8;&#x5316;&#x4EE3;&#x7801;&#x7F16;&#x5199;&#x3002;</p>
<p><strong>&#x6CE8;&#x610F;&#xFF1A;</strong>&#x4F7F;&#x7528; <code>gulp.watch</code> &#x540E;&#x4F60;&#x7684;&#x547D;&#x4EE4;&#x884C;&#x4F1A;&#x8FDB;&#x5165;&#x201C;&#x8FD0;&#x884C;&#x201D;&#x72B6;&#x6001;&#xFF0C;&#x6B64;&#x65F6;&#x4F60;&#x4E0D;&#x53EF;&#x4EE5;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8FDB;&#x884C;&#x5176;&#x4ED6;&#x64CD;&#x4F5C;&#x3002;&#x53EF;&#x901A;&#x8FC7; <code>Ctrl + C</code> &#x505C;&#x6B62; gulp&#x3002;</p>
<blockquote>
<p>Mac &#x4E0B;&#x4F7F;&#x7528; <code>control + C</code> &#x505C;&#x6B62; gulp</p>
</blockquote>
<h3 id="t22&#x4F7F;&#x7528;&#x5B9A;&#x4E49;&#x9ED8;&#x8BA4;&#x4EFB;&#x52A1;">&#x4F7F;&#x7528;&#x5B9A;&#x4E49;&#x9ED8;&#x8BA4;&#x4EFB;&#x52A1; <a href="#t22&#x4F7F;&#x7528;&#x5B9A;&#x4E49;&#x9ED8;&#x8BA4;&#x4EFB;&#x52A1;"> # </a></h3>
<blockquote>
<p>gulp.task(&apos;default&apos;, fn)</p>
</blockquote>
<p>&#x589E;&#x52A0;&#x5982;&#x4E0B;&#x4EE3;&#x7801;</p>
<pre><code class="lang-js">gulp.task(<span class="hljs-string">&apos;default&apos;</span>, [<span class="hljs-string">&apos;script&apos;</span>, <span class="hljs-string">&apos;auto&apos;</span>]);
</code></pre>
<p>&#x6B64;&#x65F6;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x76F4;&#x63A5;&#x8F93;&#x5165; <code>gulp</code> +&#x56DE;&#x8F66;&#xFF0C;&#x8FD0;&#x884C; <code>script</code> &#x548C; <code>auto</code> &#x4EFB;&#x52A1;&#x3002;</p>
<p>&#x6700;&#x7EC8;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-js"><span class="hljs-comment">// &#x83B7;&#x53D6; gulp</span>
<span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;gulp&apos;</span>)

<span class="hljs-comment">// &#x83B7;&#x53D6; uglify &#x6A21;&#x5757;&#xFF08;&#x7528;&#x4E8E;&#x538B;&#x7F29; JS&#xFF09;</span>
<span class="hljs-keyword">var</span> uglify = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;gulp-uglify&apos;</span>)

<span class="hljs-comment">// &#x538B;&#x7F29; js &#x6587;&#x4EF6;</span>
<span class="hljs-comment">// &#x5728;&#x547D;&#x4EE4;&#x884C;&#x4F7F;&#x7528; gulp script &#x542F;&#x52A8;&#x6B64;&#x4EFB;&#x52A1;</span>
gulp.task(<span class="hljs-string">&apos;script&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// 1. &#x627E;&#x5230;&#x6587;&#x4EF6;</span>
    gulp.src(<span class="hljs-string">&apos;js/*.js&apos;</span>)
    <span class="hljs-comment">// 2. &#x538B;&#x7F29;&#x6587;&#x4EF6;</span>
        .pipe(uglify())
    <span class="hljs-comment">// 3. &#x53E6;&#x5B58;&#x538B;&#x7F29;&#x540E;&#x7684;&#x6587;&#x4EF6;</span>
        .pipe(gulp.dest(<span class="hljs-string">&apos;dist/js&apos;</span>))
})

<span class="hljs-comment">// &#x5728;&#x547D;&#x4EE4;&#x884C;&#x4F7F;&#x7528; gulp auto &#x542F;&#x52A8;&#x6B64;&#x4EFB;&#x52A1;</span>
gulp.task(<span class="hljs-string">&apos;auto&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// &#x76D1;&#x542C;&#x6587;&#x4EF6;&#x4FEE;&#x6539;&#xFF0C;&#x5F53;&#x6587;&#x4EF6;&#x88AB;&#x4FEE;&#x6539;&#x5219;&#x6267;&#x884C; script &#x4EFB;&#x52A1;</span>
    gulp.watch(<span class="hljs-string">&apos;js/*.js&apos;</span>, [<span class="hljs-string">&apos;script&apos;</span>])
})


<span class="hljs-comment">// &#x4F7F;&#x7528; gulp.task(&apos;default&apos;) &#x5B9A;&#x4E49;&#x9ED8;&#x8BA4;&#x4EFB;&#x52A1;</span>
<span class="hljs-comment">// &#x5728;&#x547D;&#x4EE4;&#x884C;&#x4F7F;&#x7528; gulp &#x542F;&#x52A8; script &#x4EFB;&#x52A1;&#x548C; auto &#x4EFB;&#x52A1;</span>
gulp.task(<span class="hljs-string">&apos;default&apos;</span>, [<span class="hljs-string">&apos;script&apos;</span>, <span class="hljs-string">&apos;auto&apos;</span>])
</code></pre>
<p>&#x53BB;&#x9664;&#x6CE8;&#x91CA;&#x540E;&#xFF0C;&#x4F60;&#x4F1A;&#x53D1;&#x73B0;&#x53EA;&#x9700;&#x8981; 11 &#x884C;&#x4EE3;&#x7801;&#x5C31;&#x53EF;&#x4EE5;&#x8BA9; gulp &#x81EA;&#x52A8;&#x76D1;&#x542C; js &#x6587;&#x4EF6;&#x7684;&#x4FEE;&#x6539;&#x540E;&#x538B;&#x7F29;&#x4EE3;&#x7801;&#x3002;&#x4F46;&#x662F;&#x8FD8;&#x6709;&#x8FD8;&#x6709;&#x4E00;&#x4E9B;&#x6027;&#x80FD;&#x95EE;&#x9898;&#x548C;&#x7F3A;&#x5C11;&#x5BB9;&#x9519;&#x6027;&#xFF0C;&#x5C06;&#x5728;&#x540E;&#x9762;&#x7684;&#x7AE0;&#x8282;&#x8BE6;&#x7EC6;&#x8BF4;&#x660E;&#x3002;</p>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE; <a href="https://github.com/terinjokes/gulp-uglify">gulp-uglify</a> &#x4EE5;&#x67E5;&#x770B;&#x66F4;&#x591A;&#x7528;&#x6CD5;&#x3002;</p>
<p><a href="https://github.com/nimojs/gulp-book/issues/11">&#x8BBF;&#x95EE;&#x8BBA;&#x575B;&#x83B7;&#x53D6;&#x5E2E;&#x52A9;</a></p>
<h1 id="t23&#x538B;&#x7F29; CSS">&#x538B;&#x7F29; CSS <a href="#t23&#x538B;&#x7F29; CSS"> # </a></h1>
<p>&#x538B;&#x7F29; css &#x4EE3;&#x7801;&#x53EF;&#x964D;&#x4F4E; css &#x6587;&#x4EF6;&#x5927;&#x5C0F;&#xFF0C;&#x63D0;&#x9AD8;&#x9875;&#x9762;&#x6253;&#x5F00;&#x901F;&#x5EA6;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x63A5;&#x7740;&#x5C06;&#x89C4;&#x5F8B;&#x8F6C;&#x6362;&#x4E3A; gulp &#x4EE3;&#x7801;</p>
<p><strong>&#x89C4;&#x5F8B;</strong></p>
<blockquote>
<p>&#x627E;&#x5230; <code>css/</code> &#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x6240;&#x6709; css &#x6587;&#x4EF6;&#xFF0C;&#x538B;&#x7F29;&#x5B83;&#x4EEC;&#xFF0C;&#x5C06;&#x538B;&#x7F29;&#x540E;&#x7684;&#x6587;&#x4EF6;&#x5B58;&#x653E;&#x5728; <code>dist/css/</code> &#x76EE;&#x5F55;&#x4E0B;&#x3002;</p>
</blockquote>
<h2 id="t24&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;">&#x64CD;&#x4F5C;&#x6B65;&#x9AA4; <a href="#t24&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;"> # </a></h2>
<p>&#x4F60;&#x53EF;&#x4EE5; <a href="https://github.com/nimojs/gulp-book/archive/master.zip">&#x4E0B;&#x8F7D;&#x6240;&#x6709;&#x793A;&#x4F8B;&#x4EE3;&#x7801;</a> &#x6216; <a href="https://github.com/nimojs/gulp-book/tree/master/demo/chapter3">&#x5728;&#x7EBF;&#x67E5;&#x770B;&#x4EE3;&#x7801;</a></p>
<p>&#x5F53;&#x719F;&#x6089; <a href="chapter2.md">&#x4F7F;&#x7528; gulp &#x538B;&#x7F29; JS</a> &#x7684;&#x65B9;&#x6CD5;&#x540E;&#xFF0C;&#x914D;&#x7F6E;&#x538B;&#x7F29; CSS &#x7684; gulp &#x4EE3;&#x7801;&#x5C31;&#x53D8;&#x5F97;&#x5F88;&#x8F7B;&#x677E;&#x3002;</p>
<h3 id="t25&#x5B89;&#x88C5; gulp-minify-css">&#x5B89;&#x88C5; gulp-minify-css <a href="#t25&#x5B89;&#x88C5; gulp-minify-css"> # </a></h3>
<p>&#x63D0;&#x793A;&#xFF1A;&#x4F60;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x547D;&#x4EE4;&#x884C;&#x7684; <code>cd</code> &#x5207;&#x6362;&#x5230;&#x5BF9;&#x5E94;&#x76EE;&#x5F55;&#x540E;&#x8FDB;&#x884C;&#x5B89;&#x88C5;&#x64CD;&#x4F5C;&#x3002;</p>
<p><a href="chapter1.md">&#x5B66;&#x4E60;&#x4F7F;&#x7528;&#x547D;&#x4EE4;&#x884C;</a></p>
<p>&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x5165;</p>
<pre><code>npm install gulp-minify-css
</code></pre><p>&#x5B89;&#x88C5;&#x6210;&#x529F;&#x540E;&#x4F60;&#x4F1A;&#x770B;&#x5230;&#x5982;&#x4E0B;&#x4FE1;&#x606F;&#xFF1A;(&#x5B89;&#x88C5;&#x65F6;&#x95F4;&#x53EF;&#x80FD;&#x4F1A;&#x6BD4;&#x8F83;&#x957F;)</p>
<pre><code>gulp-minify-css@1.0.0 node_modules/gulp-minify-css
&#x251C;&#x2500;&#x2500; object-assign@2.0.0
&#x251C;&#x2500;&#x2500; vinyl-sourcemaps-apply@0.1.4 (source-map@0.1.43)
&#x251C;&#x2500;&#x2500; clean-css@3.1.8 (commander@2.6.0, source-map@0.1.43)
&#x251C;&#x2500;&#x2500; through2@0.6.3 (xtend@4.0.0, readable-stream@1.0.33)
&#x251C;&#x2500;&#x2500; vinyl-bufferstream@1.0.1 (bufferstreams@1.0.1)
&#x2514;&#x2500;&#x2500; gulp-util@3.0.4 (array-differ@1.0.0, beeper@1.0.0, array-uniq@1.0.2, lodash._reescape@3.0.0, lodash._reinterpolate@3.0.0, lodash._reevaluate@3.0.0, replace-ext@0.0.1, minimist@1.1.1, multipipe@0.1.2, vinyl@0.4.6, chalk@1.0.0, lodash.template@3.3.2, dateformat@1.0.11)
</code></pre><h3 id="t26&#x521B;&#x5EFA; gulpfile.js &#x6587;&#x4EF6;">&#x521B;&#x5EFA; gulpfile.js &#x6587;&#x4EF6; <a href="#t26&#x521B;&#x5EFA; gulpfile.js &#x6587;&#x4EF6;"> # </a></h3>
<p>&#x5728;&#x5BF9;&#x5E94;&#x76EE;&#x5F55;&#x521B;&#x5EFA; <code>gulpfile.js</code> &#x6587;&#x4EF6;&#x5E76;&#x5199;&#x5165;&#x5982;&#x4E0B;&#x5185;&#x5BB9;&#xFF1A;</p>
<pre><code class="lang-js"><span class="hljs-comment">// &#x83B7;&#x53D6; gulp</span>
<span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;gulp&apos;</span>)

<span class="hljs-comment">// &#x83B7;&#x53D6; minify-css &#x6A21;&#x5757;&#xFF08;&#x7528;&#x4E8E;&#x538B;&#x7F29; CSS&#xFF09;</span>
<span class="hljs-keyword">var</span> minifyCSS = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;gulp-minify-css&apos;</span>)

<span class="hljs-comment">// &#x538B;&#x7F29; css &#x6587;&#x4EF6;</span>
<span class="hljs-comment">// &#x5728;&#x547D;&#x4EE4;&#x884C;&#x4F7F;&#x7528; gulp css &#x542F;&#x52A8;&#x6B64;&#x4EFB;&#x52A1;</span>
gulp.task(<span class="hljs-string">&apos;css&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// 1. &#x627E;&#x5230;&#x6587;&#x4EF6;</span>
    gulp.src(<span class="hljs-string">&apos;css/*.css&apos;</span>)
    <span class="hljs-comment">// 2. &#x538B;&#x7F29;&#x6587;&#x4EF6;</span>
        .pipe(minifyCSS())
    <span class="hljs-comment">// 3. &#x53E6;&#x5B58;&#x4E3A;&#x538B;&#x7F29;&#x6587;&#x4EF6;</span>
        .pipe(gulp.dest(<span class="hljs-string">&apos;dist/css&apos;</span>))
})

<span class="hljs-comment">// &#x5728;&#x547D;&#x4EE4;&#x884C;&#x4F7F;&#x7528; gulp auto &#x542F;&#x52A8;&#x6B64;&#x4EFB;&#x52A1;</span>
gulp.task(<span class="hljs-string">&apos;auto&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// &#x76D1;&#x542C;&#x6587;&#x4EF6;&#x4FEE;&#x6539;&#xFF0C;&#x5F53;&#x6587;&#x4EF6;&#x88AB;&#x4FEE;&#x6539;&#x5219;&#x6267;&#x884C; css &#x4EFB;&#x52A1;</span>
    gulp.watch(<span class="hljs-string">&apos;css/*.css&apos;</span>, [<span class="hljs-string">&apos;css&apos;</span>])
});

<span class="hljs-comment">// &#x4F7F;&#x7528; gulp.task(&apos;default&apos;) &#x5B9A;&#x4E49;&#x9ED8;&#x8BA4;&#x4EFB;&#x52A1;</span>
<span class="hljs-comment">// &#x5728;&#x547D;&#x4EE4;&#x884C;&#x4F7F;&#x7528; gulp &#x542F;&#x52A8; css &#x4EFB;&#x52A1;&#x548C; auto &#x4EFB;&#x52A1;</span>
gulp.task(<span class="hljs-string">&apos;default&apos;</span>, [<span class="hljs-string">&apos;css&apos;</span>, <span class="hljs-string">&apos;auto&apos;</span>])
</code></pre>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE; <a href="https://github.com/jonathanepollack/gulp-minify-css">gulp-minify-css</a> &#x4EE5;&#x67E5;&#x770B;&#x66F4;&#x591A;&#x7528;&#x6CD5;&#x3002;</p>
<h3 id="t27&#x521B;&#x5EFA; css &#x6587;&#x4EF6;">&#x521B;&#x5EFA; css &#x6587;&#x4EF6; <a href="#t27&#x521B;&#x5EFA; css &#x6587;&#x4EF6;"> # </a></h3>
<p>&#x5728; <code>gulpfile.js</code> &#x5BF9;&#x5E94;&#x76EE;&#x5F55;&#x521B;&#x5EFA; <code>css</code> &#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x5E76;&#x5728; <code>css/</code> &#x76EE;&#x5F55;&#x4E0B;&#x521B;&#x5EFA; <code>a.css</code> &#x6587;&#x4EF6;&#x3002;</p>
<pre><code class="lang-css"><span class="hljs-comment">/* a.css */</span>
<span class="hljs-tag">body</span> <span class="hljs-tag">a</span><span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">color</span>:<span class="hljs-value">pink</span></span>;
}</span>
</code></pre>
<h3 id="t28&#x8FD0;&#x884C; gulp &#x67E5;&#x770B;&#x6548;&#x679C;">&#x8FD0;&#x884C; gulp &#x67E5;&#x770B;&#x6548;&#x679C; <a href="#t28&#x8FD0;&#x884C; gulp &#x67E5;&#x770B;&#x6548;&#x679C;"> # </a></h3>
<p>&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x5165; <code>gulp</code> +&#x56DE;&#x8F66;</p>
<p>&#x4F60;&#x5C06;&#x770B;&#x5230;&#x547D;&#x4EE4;&#x884C;&#x51FA;&#x73B0;&#x5982;&#x4E0B;&#x63D0;&#x793A;</p>
<pre><code>gulp
[17:01:19] Using gulpfile ~/Documents/code/gulp-book/demo/chapter3/gulpfile.js
[17:01:19] Starting &apos;css&apos;...
[17:01:19] Finished &apos;css&apos; after 6.21 ms
[17:01:19] Starting &apos;auto&apos;...
[17:01:19] Finished &apos;auto&apos; after 5.42 ms
[17:01:19] Starting &apos;default&apos;...
[17:01:19] Finished &apos;default&apos; after 5.71 &#x3BC;s
</code></pre><p>gulp &#x4F1A;&#x521B;&#x5EFA; <code>dist/css</code> &#x76EE;&#x5F55;&#xFF0C;&#x5E76;&#x521B;&#x5EFA; <code>a.css</code> &#x6587;&#x4EF6;&#xFF0C;&#x6B64;&#x6587;&#x4EF6;&#x5B58;&#x653E;&#x538B;&#x7F29;&#x540E;&#x7684; css &#x4EE3;&#x7801;&#x3002;
<a href="https://github.com/nimojs/gulp-book/blob/master/demo/chapter3/dist/css/a.css">dist/css/a.css</a></p>
<p><a href="https://github.com/nimojs/gulp-book/issues/12">&#x8BBF;&#x95EE;&#x8BBA;&#x575B;&#x83B7;&#x53D6;&#x5E2E;&#x52A9;</a></p>
<h1 id="t29&#x538B;&#x7F29;&#x56FE;&#x7247;">&#x538B;&#x7F29;&#x56FE;&#x7247; <a href="#t29&#x538B;&#x7F29;&#x56FE;&#x7247;"> # </a></h1>
<p>&#x538B;&#x7F29; &#x56FE;&#x7247;&#x6587;&#x4EF6;&#x53EF;&#x964D;&#x4F4E;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#xFF0C;&#x63D0;&#x9AD8;&#x56FE;&#x7247;&#x52A0;&#x8F7D;&#x901F;&#x5EA6;&#x3002;</p>
<p>&#x627E;&#x5230;&#x89C4;&#x5F8B;&#x8F6C;&#x6362;&#x4E3A; gulp &#x4EE3;&#x7801;</p>
<p><strong>&#x89C4;&#x5F8B;</strong></p>
<blockquote>
<p>&#x627E;&#x5230; <code>images/</code> &#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x6240;&#x6709;&#x6587;&#x4EF6;&#xFF0C;&#x538B;&#x7F29;&#x5B83;&#x4EEC;&#xFF0C;&#x5C06;&#x538B;&#x7F29;&#x540E;&#x7684;&#x6587;&#x4EF6;&#x5B58;&#x653E;&#x5728; <code>dist/images/</code> &#x76EE;&#x5F55;&#x4E0B;&#x3002;</p>
</blockquote>
<h2 id="t30&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;">&#x64CD;&#x4F5C;&#x6B65;&#x9AA4; <a href="#t30&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;"> # </a></h2>
<p>&#x4F60;&#x53EF;&#x4EE5; <a href="https://github.com/nimojs/gulp-book/archive/master.zip">&#x4E0B;&#x8F7D;&#x6240;&#x6709;&#x793A;&#x4F8B;&#x4EE3;&#x7801;</a> &#x6216; <a href="https://github.com/nimojs/gulp-book/tree/master/demo/chapter4">&#x5728;&#x7EBF;&#x67E5;&#x770B;&#x4EE3;&#x7801;</a></p>
<h3 id="t31&#x5B89;&#x88C5; gulp-imagemin">&#x5B89;&#x88C5; gulp-imagemin <a href="#t31&#x5B89;&#x88C5; gulp-imagemin"> # </a></h3>
<p>&#x63D0;&#x793A;&#xFF1A;&#x4F60;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x547D;&#x4EE4;&#x884C;&#x7684; <code>cd</code> &#x5207;&#x6362;&#x81F3;&#x5BF9;&#x5E94;&#x76EE;&#x5F55;&#x518D;&#x8FDB;&#x884C;&#x5B89;&#x88C5;&#x64CD;&#x4F5C;&#x548C; gulp &#x542F;&#x52A8;&#x64CD;&#x4F5C;&#x3002;</p>
<p>&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x5165;</p>
<pre><code>npm instal gulp-imagemin
</code></pre><p>&#x5B89;&#x88C5;&#x6210;&#x529F;&#x540E;&#x4F60;&#x4F1A;&#x770B;&#x5230;&#x5982;&#x4E0B;&#x4FE1;&#x606F;&#xFF1A;(&#x5B89;&#x88C5;&#x65F6;&#x95F4;&#x53EF;&#x80FD;&#x4F1A;&#x6BD4;&#x8F83;&#x957F;)</p>
<pre><code>gulp-imagemin@2.2.1 node_modules/gulp-imagemin
&#x251C;&#x2500;&#x2500; object-assign@2.0.0
&#x251C;&#x2500;&#x2500; pretty-bytes@1.0.3 (get-stdin@4.0.1)
&#x251C;&#x2500;&#x2500; chalk@1.0.0 (escape-string-regexp@1.0.3, ansi-styles@2.0.1, supports-color@1.3.1, has-ansi@1.0.3, strip-ansi@2.0.1)
&#x251C;&#x2500;&#x2500; through2-concurrent@0.3.1 (through2@0.6.3)
&#x251C;&#x2500;&#x2500; gulp-util@3.0.4 (array-differ@1.0.0, beeper@1.0.0, array-uniq@1.0.2, lodash._reevaluate@3.0.0, lodash._reescape@3.0.0, lodash._reinterpolate@3.0.0, replace-ext@0.0.1, minimist@1.1.1, vinyl@0.4.6, through2@0.6.3, multipipe@0.1.2, lodash.template@3.3.2, dateformat@1.0.11)
&#x2514;&#x2500;&#x2500; imagemin@3.1.0 (get-stdin@3.0.2, optional@0.1.3, vinyl@0.4.6, through2@0.6.3, stream-combiner@0.2.1, concat-stream@1.4.7, meow@2.1.0, vinyl-fs@0.3.13, imagemin-svgo@4.1.2, imagemin-optipng@4.2.0, imagemin-jpegtran@4.1.0, imagemin-pngquant@4.0.0, imagemin-gifsicle@4.1.0)
</code></pre><h3 id="t32&#x521B;&#x5EFA; gulpfile.js &#x6587;&#x4EF6;">&#x521B;&#x5EFA; gulpfile.js &#x6587;&#x4EF6; <a href="#t32&#x521B;&#x5EFA; gulpfile.js &#x6587;&#x4EF6;"> # </a></h3>
<p>&#x5728;&#x5BF9;&#x5E94;&#x76EE;&#x5F55;&#x521B;&#x5EFA; <code>gulpfile.js</code> &#x6587;&#x4EF6;&#x5E76;&#x5199;&#x5165;&#x5982;&#x4E0B;&#x5185;&#x5BB9;&#xFF1A;</p>
<pre><code class="lang-js"><span class="hljs-comment">// &#x83B7;&#x53D6; gulp</span>
<span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;gulp&apos;</span>);

<span class="hljs-comment">// &#x83B7;&#x53D6; gulp-imagemin &#x6A21;&#x5757;</span>
<span class="hljs-keyword">var</span> imagemin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;gulp-imagemin&apos;</span>)

<span class="hljs-comment">// &#x538B;&#x7F29;&#x56FE;&#x7247;&#x4EFB;&#x52A1;</span>
<span class="hljs-comment">// &#x5728;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x5165; gulp images &#x542F;&#x52A8;&#x6B64;&#x4EFB;&#x52A1;</span>
gulp.task(<span class="hljs-string">&apos;images&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// 1. &#x627E;&#x5230;&#x56FE;&#x7247;</span>
    gulp.src(<span class="hljs-string">&apos;images/*.*&apos;</span>)
    <span class="hljs-comment">// 2. &#x538B;&#x7F29;&#x56FE;&#x7247;</span>
        .pipe(imagemin({
            progressive: <span class="hljs-literal">true</span>
        }))
    <span class="hljs-comment">// 3. &#x53E6;&#x5B58;&#x56FE;&#x7247;</span>
        .pipe(gulp.dest(<span class="hljs-string">&apos;dist/images&apos;</span>))
});

<span class="hljs-comment">// &#x5728;&#x547D;&#x4EE4;&#x884C;&#x4F7F;&#x7528; gulp auto &#x542F;&#x52A8;&#x6B64;&#x4EFB;&#x52A1;</span>
gulp.task(<span class="hljs-string">&apos;auto&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// &#x76D1;&#x542C;&#x6587;&#x4EF6;&#x4FEE;&#x6539;&#xFF0C;&#x5F53;&#x6587;&#x4EF6;&#x88AB;&#x4FEE;&#x6539;&#x5219;&#x6267;&#x884C; images &#x4EFB;&#x52A1;</span>
    gulp.watch(<span class="hljs-string">&apos;images/*.*)&apos;</span>, [<span class="hljs-string">&apos;images&apos;</span>])
});

<span class="hljs-comment">// &#x4F7F;&#x7528; gulp.task(&apos;default&apos;) &#x5B9A;&#x4E49;&#x9ED8;&#x8BA4;&#x4EFB;&#x52A1;</span>
<span class="hljs-comment">// &#x5728;&#x547D;&#x4EE4;&#x884C;&#x4F7F;&#x7528; gulp &#x542F;&#x52A8; images &#x4EFB;&#x52A1;&#x548C; auto &#x4EFB;&#x52A1;</span>
gulp.task(<span class="hljs-string">&apos;default&apos;</span>, [<span class="hljs-string">&apos;images&apos;</span>, <span class="hljs-string">&apos;auto&apos;</span>])
</code></pre>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE; <a href="https://github.com/sindresorhus/gulp-imagemin">gulp-imagemin</a> &#x4EE5;&#x67E5;&#x770B;&#x66F4;&#x591A;&#x7528;&#x6CD5;&#x3002;</p>
<h3 id="t33&#x5728; images/ &#x76EE;&#x5F55;&#x4E0B;&#x5B58;&#x653E;&#x56FE;&#x7247;">&#x5728; images/ &#x76EE;&#x5F55;&#x4E0B;&#x5B58;&#x653E;&#x56FE;&#x7247; <a href="#t33&#x5728; images/ &#x76EE;&#x5F55;&#x4E0B;&#x5B58;&#x653E;&#x56FE;&#x7247;"> # </a></h3>
<p>&#x5728; <code>gulpfile.js</code> &#x5BF9;&#x5E94;&#x76EE;&#x5F55;&#x521B;&#x5EFA; <code>images</code> &#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x5E76;&#x5728; <code>images/</code> &#x76EE;&#x5F55;&#x4E0B;&#x5B58;&#x653E;&#x56FE;&#x7247;&#x3002;</p>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE; <a href="https://github.com/nimojs/gulp-book/tree/master/demo/chapter4/images/">https://github.com/nimojs/gulp-book/tree/master/demo/chapter4/images/</a> &#x4E0B;&#x8F7D;&#x793A;&#x4F8B;&#x56FE;&#x7247;</p>
<h3 id="t34&#x8FD0;&#x884C; gulp &#x67E5;&#x770B;&#x6548;&#x679C;">&#x8FD0;&#x884C; gulp &#x67E5;&#x770B;&#x6548;&#x679C; <a href="#t34&#x8FD0;&#x884C; gulp &#x67E5;&#x770B;&#x6548;&#x679C;"> # </a></h3>
<p>&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x5165; <code>gulp</code> +&#x56DE;&#x8F66;</p>
<p>&#x4F60;&#x5C06;&#x770B;&#x5230;&#x547D;&#x4EE4;&#x884C;&#x51FA;&#x73B0;&#x5982;&#x4E0B;&#x63D0;&#x793A;</p>
<pre><code>gulp
[18:10:42] Using gulpfile ~/Documents/code/gulp-book/demo/chapter4/gulpfile.js
[18:10:42] Starting &apos;images&apos;...
[18:10:42] Finished &apos;images&apos; after 5.72 ms
[18:10:42] Starting &apos;auto&apos;...
[18:10:42] Finished &apos;auto&apos; after 6.39 ms
[18:10:42] Starting &apos;default&apos;...
[18:10:42] Finished &apos;default&apos; after 5.91 &#x3BC;s
[18:10:42] gulp-imagemin: Minified 3 images (saved 25.83 kB - 5.2%)
</code></pre><p><a href="https://github.com/nimojs/gulp-book/issues/13">&#x8BBF;&#x95EE;&#x8BBA;&#x575B;&#x83B7;&#x53D6;&#x5E2E;&#x52A9;</a></p>
<h1 id="t35&#x7F16;&#x8BD1; LESS">&#x7F16;&#x8BD1; LESS <a href="#t35&#x7F16;&#x8BD1; LESS"> # </a></h1>
<blockquote>
<p>Sass &#x662F;&#x4E00;&#x79CD; CSS &#x7684;&#x5F00;&#x53D1;&#x5DE5;&#x5177;&#xFF0C;&#x63D0;&#x4F9B;&#x4E86;&#x8BB8;&#x591A;&#x4FBF;&#x5229;&#x7684;&#x5199;&#x6CD5;&#xFF0C;&#x5927;&#x5927;&#x8282;&#x7701;&#x4E86;&#x5F00;&#x53D1;&#x8005;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x4F7F;&#x5F97; CSS &#x7684;&#x5F00;&#x53D1;&#xFF0C;&#x53D8;&#x5F97;&#x7B80;&#x5355;&#x548C;&#x53EF;&#x7EF4;&#x62A4;&#x3002;</p>
</blockquote>
<p>&#x672C;&#x7AE0;&#x4F7F;&#x7528; <code>ruby-sass</code> &#x7F16;&#x8BD1; css,&#x82E5;&#x4F60;&#x6CA1;&#x6709;&#x5B89;&#x88C5; ruby &#x548C; sass &#x8BF7;&#x79FB;&#x6B65; <a href="https://github.com/nimojs/blog/issues/14">&#x4F7F;&#x7528;ruby.taobao&#x5B89;&#x88C5; Sass</a></p>
<h2 id="t36&#x5B89;&#x88C5;">&#x5B89;&#x88C5; <a href="#t36&#x5B89;&#x88C5;"> # </a></h2>
<pre><code>npm install gulp-ruby-sass
</code></pre><h2 id="t37&#x57FA;&#x672C;&#x7528;&#x6CD5;">&#x57FA;&#x672C;&#x7528;&#x6CD5; <a href="#t37&#x57FA;&#x672C;&#x7528;&#x6CD5;"> # </a></h2>
<p>&#x4F60;&#x53EF;&#x4EE5; <a href="https://github.com/nimojs/gulp-book/archive/master.zip">&#x4E0B;&#x8F7D;&#x6240;&#x6709;&#x793A;&#x4F8B;&#x4EE3;&#x7801;</a> &#x6216; <a href="https://github.com/nimojs/gulp-book/tree/master/demo/chapter6">&#x5728;&#x7EBF;&#x67E5;&#x770B;&#x4EE3;&#x7801;</a></p>
<pre><code class="lang-js"><span class="hljs-comment">// &#x83B7;&#x53D6; gulp</span>
<span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;gulp&apos;</span>)
<span class="hljs-comment">// &#x83B7;&#x53D6; gulp-ruby-sass &#x6A21;&#x5757;</span>
<span class="hljs-keyword">var</span> sass = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;gulp-ruby-sass&apos;</span>)

<span class="hljs-comment">// &#x7F16;&#x8BD1;sass</span>
<span class="hljs-comment">// &#x5728;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x5165; gulp sass &#x542F;&#x52A8;&#x6B64;&#x4EFB;&#x52A1;</span>
gulp.task(<span class="hljs-string">&apos;sass&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> sass(<span class="hljs-string">&apos;sass/&apos;</span>) 
    .on(<span class="hljs-string">&apos;error&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">&apos;Error!&apos;</span>, err.message);
   })
    .pipe(gulp.dest(<span class="hljs-string">&apos;dist/css&apos;</span>))
});


<span class="hljs-comment">// &#x5728;&#x547D;&#x4EE4;&#x884C;&#x4F7F;&#x7528; gulp auto &#x542F;&#x52A8;&#x6B64;&#x4EFB;&#x52A1;</span>
gulp.task(<span class="hljs-string">&apos;auto&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// &#x76D1;&#x542C;&#x6587;&#x4EF6;&#x4FEE;&#x6539;&#xFF0C;&#x5F53;&#x6587;&#x4EF6;&#x88AB;&#x4FEE;&#x6539;&#x5219;&#x6267;&#x884C; images &#x4EFB;&#x52A1;</span>
    gulp.watch(<span class="hljs-string">&apos;sass/**/*.scss&apos;</span>, [<span class="hljs-string">&apos;sass&apos;</span>])
});

<span class="hljs-comment">// &#x4F7F;&#x7528; gulp.task(&apos;default&apos;) &#x5B9A;&#x4E49;&#x9ED8;&#x8BA4;&#x4EFB;&#x52A1;</span>
<span class="hljs-comment">// &#x5728;&#x547D;&#x4EE4;&#x884C;&#x4F7F;&#x7528; gulp &#x542F;&#x52A8; sass &#x4EFB;&#x52A1;&#x548C; auto &#x4EFB;&#x52A1;</span>
gulp.task(<span class="hljs-string">&apos;default&apos;</span>, [<span class="hljs-string">&apos;sass&apos;</span>, <span class="hljs-string">&apos;auto&apos;</span>])
</code></pre>
<h2 id="t38&#x7F16;&#x8BD1;&#x540E;&#x7684;&#x5BF9;&#x6BD4;">&#x7F16;&#x8BD1;&#x540E;&#x7684;&#x5BF9;&#x6BD4; <a href="#t38&#x7F16;&#x8BD1;&#x540E;&#x7684;&#x5BF9;&#x6BD4;"> # </a></h2>
<p>Sass &#x4EE3;&#x7801;&#x548C;&#x7F16;&#x8BD1;&#x540E;&#x7684; CSS &#x4EE3;&#x7801;</p>
<p><a href="https://github.com/nimojs/gulp-book/tree/master/demo/chapter6/sass/a.scss">sass/a.scss</a></p>
<pre><code class="lang-css">.sass{
    a{
        color:pink;
    }
}
</code></pre>
<p><a href="https://github.com/nimojs/gulp-book/tree/master/demo/chapter6/sass/import.scss">sass/import.scss</a></p>
<pre><code class="lang-css">@import &quot;a.scss&quot;;
.import{
    a{
        color:red;
    }
}
</code></pre>
<p><a href="https://github.com/nimojs/gulp-book/tree/master/demo/chapter6/dist/css/a.css">sass/a.css</a></p>
<pre><code class="lang-css"><span class="hljs-class">.sass</span> <span class="hljs-tag">a</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">color</span>:<span class="hljs-value"> pink</span></span>;
}</span>
</code></pre>
<p><a href="https://github.com/nimojs/gulp-book/tree/master/demo/chapter6/dist/css/import.css">sass/import.css</a></p>
<pre><code class="lang-css"><span class="hljs-class">.sass</span> <span class="hljs-tag">a</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">color</span>:<span class="hljs-value"> pink</span></span>;
}</span>
<span class="hljs-class">.import</span> <span class="hljs-tag">a</span><span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">color</span>:<span class="hljs-value"> red</span></span>;
}</span>
</code></pre>
<p><a href="https://github.com/nimojs/gulp-book/issues/15">&#x8BBF;&#x95EE;&#x8BBA;&#x575B;&#x83B7;&#x53D6;&#x5E2E;&#x52A9;</a></p>
<h1 id="t39gulp &#x5F00;&#x53D1;&#x4E00;&#x4E2A;&#x9879;&#x76EE;">gulp &#x5F00;&#x53D1;&#x4E00;&#x4E2A;&#x9879;&#x76EE; <a href="#t39gulp &#x5F00;&#x53D1;&#x4E00;&#x4E2A;&#x9879;&#x76EE;"> # </a></h1>
<ul>
<li><a href="https://github.com/gulpjs/gulp/blob/master/docs/recipes/combining-streams-to-handle-errors.md">stream-combiner2</a></li>
<li><a href="https://github.com/floridoo/gulp-sourcemaps">gulp-sourcemaps</a></li>
<li><a href="https://github.com/sindresorhus/gulp-autoprefixer/blob/master/package.json">gulp-autoprefixer</a></li>
</ul>
<p>&#x5E76;&#x5C06;&#x4E4B;&#x524D;&#x6240;&#x6709;&#x7AE0;&#x8282;&#x7684;&#x5185;&#x5BB9;&#x7EC4;&#x5408;&#x8D77;&#x6765;&#x7F16;&#x5199;&#x4E00;&#x4E2A;&#x524D;&#x7AEF;&#x9879;&#x76EE;&#x6240;&#x9700;&#x7684; gulp &#x4EE3;&#x7801;&#x3002;</p>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x5728; <a href="https://github.com/nimojs/gulp-demo">nimojs/gulp-demo</a> &#x67E5;&#x770B;&#x5B8C;&#x6574;&#x4EE3;&#x7801;&#x3002;</p>
<p>&#x82E5;&#x4F60;&#x4E0D;&#x4E86;&#x89E3;npm &#x8BF7;&#x52A1;&#x5FC5;&#x9605;&#x8BFB; <a href="http://javascript.ruanyifeng.com/nodejs/npm.html">npm&#x6A21;&#x5757;&#x7BA1;&#x7406;&#x5668;</a></p>
<h2 id="t40package.json">package.json <a href="#t40package.json"> # </a></h2>
<p>&#x5982;&#x679C;&#x4F60;&#x719F;&#x6089; npm &#x5219;&#x53EF;&#x4EE5;&#x5229;&#x7528; <code>package.json</code> &#x4FDD;&#x5B58;&#x6240;&#x6709; <code>npm install --save-dev gulp-xxx</code> &#x6A21;&#x5757;&#x4F9D;&#x8D56;&#x548C;&#x6A21;&#x5757;&#x7248;&#x672C;&#x3002;</p>
<p>&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x5165;</p>
<pre><code>npm init
</code></pre><p>&#x4F1A;&#x4F9D;&#x6B21;&#x8981;&#x6C42;&#x8865;&#x5168;&#x9879;&#x76EE;&#x4FE1;&#x606F;&#xFF0C;&#x4E0D;&#x6E05;&#x695A;&#x7684;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x56DE;&#x8F66;&#x8DF3;&#x8FC7;</p>
<pre><code>name: (gulp-demo) 
version: (1.0.0) 
description: 
entry point: (index.js) 
test command: 
...
...
Is this ok? (yes)
</code></pre><p>&#x6700;&#x7EC8;&#x4F1A;&#x5728;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x4E2D;&#x521B;&#x5EFA; <code>package.json</code> &#x6587;&#x4EF6;&#x5E76;&#x751F;&#x6210;&#x7C7B;&#x4F3C;&#x5982;&#x4E0B;&#x4EE3;&#x7801;&#xFF1A;</p>
<pre><code class="lang-js">{
  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;gulp-demo&quot;</span>,
  <span class="hljs-string">&quot;version&quot;</span>: <span class="hljs-string">&quot;0.0.0&quot;</span>,
  <span class="hljs-string">&quot;description&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,
  <span class="hljs-string">&quot;scripts&quot;</span>: {
    <span class="hljs-string">&quot;test&quot;</span>: <span class="hljs-string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span>
  },
  <span class="hljs-string">&quot;repository&quot;</span>: {
    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;git&quot;</span>,
    <span class="hljs-string">&quot;url&quot;</span>: <span class="hljs-string">&quot;https://github.com/nimojs/gulp-demo.git&quot;</span>
  },
  <span class="hljs-string">&quot;keywords&quot;</span>: [
    <span class="hljs-string">&quot;gulp&quot;</span>,
  ],
  <span class="hljs-string">&quot;author&quot;</span>: <span class="hljs-string">&quot;nimojs &lt;nimo.jser@gmail.com&gt;&quot;</span>,
  <span class="hljs-string">&quot;license&quot;</span>: <span class="hljs-string">&quot;MIT&quot;</span>,
  <span class="hljs-string">&quot;bugs&quot;</span>: {
    <span class="hljs-string">&quot;url&quot;</span>: <span class="hljs-string">&quot;https://github.com/nimojs/gulp-demo/issues&quot;</span>
  },
  <span class="hljs-string">&quot;homepage&quot;</span>: <span class="hljs-string">&quot;https://github.com/nimojs/gulp-demo&quot;</span>
}
</code></pre>
<h2 id="t41&#x5B89;&#x88C5;&#x4F9D;&#x8D56;">&#x5B89;&#x88C5;&#x4F9D;&#x8D56; <a href="#t41&#x5B89;&#x88C5;&#x4F9D;&#x8D56;"> # </a></h2>
<p>&#x5B89;&#x88C5; gulp &#x5230;&#x9879;&#x76EE;&#xFF08;&#x9632;&#x6B62;&#x5168;&#x5C40; gulp &#x5347;&#x7EA7;&#x540E;&#x4E0E;&#x6B64;&#x9879;&#x76EE; <code>gulpfile.js</code> &#x4EE3;&#x7801;&#x4E0D;&#x517C;&#x5BB9;&#xFF09;</p>
<pre><code>npm install gulp --save-dev
</code></pre><p>&#x6B64;&#x65F6;&#x6253;&#x5F00; <code>package.json</code> &#x4F1A;&#x53D1;&#x73B0;&#x591A;&#x4E86;&#x5982;&#x4E0B;&#x4EE3;&#x7801;</p>
<pre><code class="lang-js"><span class="hljs-string">&quot;devDependencies&quot;</span>: {
    <span class="hljs-string">&quot;gulp&quot;</span>: <span class="hljs-string">&quot;^3.8.11&quot;</span>
}
</code></pre>
<p>&#x58F0;&#x660E;&#x6B64;&#x9879;&#x76EE;&#x7684;&#x5F00;&#x53D1;&#x4F9D;&#x8D56; gulp</p>
<p>&#x63A5;&#x7740;&#x5B89;&#x88C5;&#x5176;&#x4ED6;&#x4F9D;&#x8D56;&#xFF1A;</p>
<blockquote>
<p>&#x5B89;&#x88C5;&#x6A21;&#x5757;&#x8F83;&#x591A;&#xFF0C;&#x8BF7;&#x8010;&#x5FC3;&#x7B49;&#x5F85;&#xFF0C;&#x82E5;&#x4E00;&#x76F4;&#x5B89;&#x88C5;&#x5931;&#x8D25;&#x53EF;&#x4F7F;&#x7528;<a href="http://npm.taobao.org/">npm.taobao.org</a></p>
</blockquote>
<pre><code>npm install gulp-uglify gulp-watch-path stream-combiner2 gulp-sourcemaps gulp-minify-css gulp-autoprefixer gulp-less gulp-ruby-sass gulp-imagemin gulp-util --save-dev
</code></pre><p>&#x6B64;&#x65F6;&#xFF0C;<a href="https://github.com/nimojs/gulp-demo/blob/master/package.json">package.json</a> &#x5C06;&#x4F1A;&#x66F4;&#x65B0;</p>
<pre><code class="lang-js"><span class="hljs-string">&quot;devDependencies&quot;</span>: {
    <span class="hljs-string">&quot;colors&quot;</span>: <span class="hljs-string">&quot;^1.0.3&quot;</span>,
    <span class="hljs-string">&quot;gulp&quot;</span>: <span class="hljs-string">&quot;^3.8.11&quot;</span>,
    <span class="hljs-string">&quot;gulp-autoprefixer&quot;</span>: <span class="hljs-string">&quot;^2.1.0&quot;</span>,
    <span class="hljs-string">&quot;gulp-imagemin&quot;</span>: <span class="hljs-string">&quot;^2.2.1&quot;</span>,
    <span class="hljs-string">&quot;gulp-less&quot;</span>: <span class="hljs-string">&quot;^3.0.2&quot;</span>,
    <span class="hljs-string">&quot;gulp-minify-css&quot;</span>: <span class="hljs-string">&quot;^1.0.0&quot;</span>,
    <span class="hljs-string">&quot;gulp-ruby-sass&quot;</span>: <span class="hljs-string">&quot;^1.0.1&quot;</span>,
    <span class="hljs-string">&quot;gulp-sourcemaps&quot;</span>: <span class="hljs-string">&quot;^1.5.1&quot;</span>,
    <span class="hljs-string">&quot;gulp-uglify&quot;</span>: <span class="hljs-string">&quot;^1.1.0&quot;</span>,
    <span class="hljs-string">&quot;gulp-watch-path&quot;</span>: <span class="hljs-string">&quot;^0.0.7&quot;</span>,
    <span class="hljs-string">&quot;stream-combiner2&quot;</span>: <span class="hljs-string">&quot;^1.0.2&quot;</span>
}
</code></pre>
<p>&#x5F53;&#x4F60;&#x5C06;&#x8FD9;&#x4EFD; gulpfile.js &#x914D;&#x7F6E;&#x5206;&#x4EAB;&#x7ED9;&#x4F60;&#x7684;&#x670B;&#x53CB;&#x65F6;&#xFF0C;&#x5C31;&#x4E0D;&#x9700;&#x8981;&#x5C06; <code>node_modules/</code> &#x53D1;&#x9001;&#x7ED9;&#x4ED6;&#xFF0C;&#x4ED6;&#x53EA;&#x9700;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x5165;</p>
<pre><code>npm install
</code></pre><p>&#x5C31;&#x53EF;&#x4EE5;&#x68C0;&#x6D4B; <code>package.json</code> &#x4E2D;&#x7684; <code>devDependencies</code> &#x5E76;&#x5B89;&#x88C5;&#x6240;&#x6709;&#x4F9D;&#x8D56;&#x3002;</p>
<h2 id="t42&#x8BBE;&#x8BA1;&#x76EE;&#x5F55;&#x7ED3;&#x6784;">&#x8BBE;&#x8BA1;&#x76EE;&#x5F55;&#x7ED3;&#x6784; <a href="#t42&#x8BBE;&#x8BA1;&#x76EE;&#x5F55;&#x7ED3;&#x6784;"> # </a></h2>
<p>&#x6211;&#x4EEC;&#x5C06;&#x6587;&#x4EF6;&#x5206;&#x4E3A;2&#x7C7B;&#xFF0C;&#x4E00;&#x7C7B;&#x662F;&#x6E90;&#x7801;&#xFF0C;&#x4E00;&#x7C7B;&#x662F;&#x7F16;&#x8BD1;&#x538B;&#x7F29;&#x540E;&#x7684;&#x7248;&#x672C;&#x3002;&#x6587;&#x4EF6;&#x5939;&#x5206;&#x522B;&#x4E3A; <code>src</code> &#x548C; <code>dist</code>&#x3002;(&#x6CE8;&#x610F;&#x533A;&#x5206; <code>dist</code> &#x548C; &#xB7;<code>dest</code> &#x7684;&#x533A;&#x522B;)</p>
<pre><code>&#x2514;&#x2500;&#x2500; src/
&#x2502;
&#x2514;&#x2500;&#x2500; dist/
</code></pre><p><code>dist/</code> &#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x6587;&#x4EF6;&#x90FD;&#x662F;&#x6839;&#x636E; <code>src/</code> &#x4E0B;&#x6240;&#x6709;&#x6E90;&#x7801;&#x6587;&#x4EF6;&#x6784;&#x5EFA;&#x800C;&#x6210;&#x3002;</p>
<p>&#x5728; <code>src/</code> &#x4E0B;&#x521B;&#x5EFA;&#x524D;&#x7AEF;&#x8D44;&#x6E90;&#x5BF9;&#x5E94;&#x7684;&#x7684;&#x6587;&#x4EF6;&#x5939;</p>
<pre><code>&#x2514;&#x2500;&#x2500; src/
    &#x251C;&#x2500;&#x2500; less/    *.less &#x6587;&#x4EF6;
    &#x251C;&#x2500;&#x2500; sass/    *.scss *.sass &#x6587;&#x4EF6;
    &#x251C;&#x2500;&#x2500; css/     *.css  &#x6587;&#x4EF6;
    &#x251C;&#x2500;&#x2500; js/      *.js &#x6587;&#x4EF6;
    &#x251C;&#x2500;&#x2500; fonts/   &#x5B57;&#x4F53;&#x6587;&#x4EF6;
    &#x2514;&#x2500;&#x2500; images/   &#x56FE;&#x7247;
&#x2514;&#x2500;&#x2500; dist/
</code></pre><p>&#x4F60;&#x53EF;&#x4EE5;&#x70B9;&#x51FB; <a href="https://github.com/nimojs/gulp-demo/archive/master.zip">nimojs/gulp-demo</a> &#x4E0B;&#x8F7D;&#x672C;&#x7AE0;&#x4EE3;&#x7801;&#x3002;</p>
<h2 id="t43&#x8BA9;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x51FA;&#x7684;&#x6587;&#x5B57;&#x5E26;&#x989C;&#x8272;">&#x8BA9;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x51FA;&#x7684;&#x6587;&#x5B57;&#x5E26;&#x989C;&#x8272; <a href="#t43&#x8BA9;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x51FA;&#x7684;&#x6587;&#x5B57;&#x5E26;&#x989C;&#x8272;"> # </a></h2>
<p>gulp &#x81EA;&#x5E26;&#x7684;&#x8F93;&#x51FA;&#x90FD;&#x5E26;&#x65F6;&#x95F4;&#x548C;&#x989C;&#x8272;&#xFF0C;&#x8FD9;&#x6837;&#x5F88;&#x5BB9;&#x6613;&#x8BC6;&#x522B;&#x3002;&#x6211;&#x4EEC;&#x5229;&#x7528; <a href="https://github.com/gulpjs/gulp-util">gulp-util</a> &#x5B9E;&#x73B0;&#x540C;&#x6837;&#x7684;&#x6548;&#x679C;&#x3002;</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;gulp&apos;</span>)
<span class="hljs-keyword">var</span> gutil = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;gulp-util&apos;</span>)

gulp.task(<span class="hljs-string">&apos;default&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    gutil.log(<span class="hljs-string">&apos;message&apos;</span>)
    gutil.log(gutil.colors.red(<span class="hljs-string">&apos;error&apos;</span>))
    gutil.log(gutil.colors.green(<span class="hljs-string">&apos;message:&apos;</span>) + <span class="hljs-string">&quot;some&quot;</span>)
})
</code></pre>
<p>&#x4F7F;&#x7528; <code>gulp</code> &#x542F;&#x52A8;&#x9ED8;&#x8BA4;&#x4EFB;&#x52A1;&#x4EE5;&#x6D4B;&#x8BD5;
<img src="https://cloud.githubusercontent.com/assets/3949015/7137629/a1def1b8-e2ed-11e4-83e0-5a6adb22de6f.png" alt="gulp-util"></p>
<h2 id="t44&#x914D;&#x7F6E; JS &#x4EFB;&#x52A1;">&#x914D;&#x7F6E; JS &#x4EFB;&#x52A1; <a href="#t44&#x914D;&#x7F6E; JS &#x4EFB;&#x52A1;"> # </a></h2>
<h3 id="t45gulp-uglify">gulp-uglify <a href="#t45gulp-uglify"> # </a></h3>
<p>&#x68C0;&#x6D4B;<code>src/js/</code>&#x76EE;&#x5F55;&#x4E0B;&#x7684; js &#x6587;&#x4EF6;&#x4FEE;&#x6539;&#x540E;&#xFF0C;&#x538B;&#x7F29; <code>js/</code> &#x4E2D;&#x6240;&#x6709; js &#x6587;&#x4EF6;&#x5E76;&#x8F93;&#x51FA;&#x5230; <code>dist/js/</code> &#x4E2D;</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> uglify = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;gulp-uglify&apos;</span>)

gulp.task(<span class="hljs-string">&apos;uglifyjs&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    gulp.src(<span class="hljs-string">&apos;src/js/**/*.js&apos;</span>)
        .pipe(uglify())
        .pipe(gulp.dest(<span class="hljs-string">&apos;dist/js&apos;</span>))
})

gulp.task(<span class="hljs-string">&apos;default&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    gulp.watch(<span class="hljs-string">&apos;src/js/**/*.js&apos;</span>, [<span class="hljs-string">&apos;uglifyjs&apos;</span>])
})
</code></pre>
<p><code>src/js/**/*.js</code> &#x662F; glob &#x8BED;&#x6CD5;&#x3002;<a href="http://baike.baidu.com/view/4019153.htm">&#x767E;&#x5EA6;&#x767E;&#x79D1;&#xFF1A;glob&#x6A21;&#x5F0F;</a> &#x3001;<a href="https://github.com/isaacs/node-glob">node-glob</a></p>
<p>&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x5165; <code>gulp</code> &#x540E;&#x4F1A;&#x51FA;&#x73B0;&#x5982;&#x4E0B;&#x6D88;&#x606F;&#xFF0C;&#x8868;&#x793A;&#x5DF2;&#x7ECF;&#x542F;&#x52A8;&#x3002;</p>
<pre><code class="lang-ruby">[<span class="hljs-number">20</span><span class="hljs-symbol">:</span><span class="hljs-number">39</span><span class="hljs-symbol">:</span><span class="hljs-number">50</span>] <span class="hljs-constant">Using</span> gulpfile ~<span class="hljs-regexp">/Documents/code</span><span class="hljs-regexp">/gulp-book/demo</span><span class="hljs-regexp">/chapter7/gulpfile</span>.js
[<span class="hljs-number">20</span><span class="hljs-symbol">:</span><span class="hljs-number">39</span><span class="hljs-symbol">:</span><span class="hljs-number">50</span>] <span class="hljs-constant">Starting</span> <span class="hljs-string">&apos;default&apos;</span>...
[<span class="hljs-number">20</span><span class="hljs-symbol">:</span><span class="hljs-number">39</span><span class="hljs-symbol">:</span><span class="hljs-number">50</span>] <span class="hljs-constant">Finished</span> <span class="hljs-string">&apos;default&apos;</span> after <span class="hljs-number">13</span> ms
</code></pre>
<p>&#x6B64;&#x65F6;&#x7F16;&#x8F91; <a href="https://github.com/nimojs/gulp-demo/blob/master/src/js/log.js">src/js/log.js</a> &#x6587;&#x4EF6;&#x5E76;&#x4FDD;&#x5B58;&#xFF0C;&#x547D;&#x4EE4;&#x884C;&#x4F1A;&#x51FA;&#x73B0;&#x5982;&#x4E0B;&#x6D88;&#x606F;&#xFF0C;&#x8868;&#x793A;&#x68C0;&#x6D4B;&#x5230; <code>src/js/**/*.js</code> &#x6587;&#x4EF6;&#x4FEE;&#x6539;&#x540E;&#x91CD;&#x65B0;&#x7F16;&#x8BD1;&#x6240;&#x6709; js&#x3002;</p>
<pre><code class="lang-ruby">[<span class="hljs-number">20</span><span class="hljs-symbol">:</span><span class="hljs-number">39</span><span class="hljs-symbol">:</span><span class="hljs-number">52</span>] <span class="hljs-constant">Starting</span> <span class="hljs-string">&apos;js&apos;</span>...
[<span class="hljs-number">20</span><span class="hljs-symbol">:</span><span class="hljs-number">39</span><span class="hljs-symbol">:</span><span class="hljs-number">52</span>] <span class="hljs-constant">Finished</span> <span class="hljs-string">&apos;js&apos;</span> after <span class="hljs-number">14</span> ms
</code></pre>
<h3 id="t46gulp-watch-path">gulp-watch-path <a href="#t46gulp-watch-path"> # </a></h3>
<p>&#x6B64;&#x914D;&#x7F6E;&#x6709;&#x4E2A;&#x6027;&#x80FD;&#x95EE;&#x9898;&#xFF0C;&#x5F53; <code>gulp.watch</code> &#x68C0;&#x6D4B;&#x5230;  <code>src/js/</code> &#x76EE;&#x5F55;&#x4E0B;&#x7684;js&#x6587;&#x4EF6;&#x6709;&#x4FEE;&#x6539;&#x65F6;&#x4F1A;&#x5C06;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x5168;&#x90E8;&#x7F16;&#x8BD1;&#x3002;&#x5B9E;&#x9645;&#x4E0A;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x91CD;&#x65B0;&#x7F16;&#x8BD1;&#x88AB;&#x4FEE;&#x6539;&#x7684;&#x6587;&#x4EF6;&#x3002;</p>
<p>&#x7B80;&#x5355;&#x4ECB;&#x7ECD; <code>gulp.watch</code> &#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x4E3A; <code>function</code> &#x65F6;&#x7684;&#x7528;&#x6CD5;&#x3002;</p>
<pre><code class="lang-js">gulp.watch(<span class="hljs-string">&apos;src/js/**/*.js&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
    <span class="hljs-built_in">console</span>.log(event);
    <span class="hljs-comment">/*
    &#x5F53;&#x4FEE;&#x6539; src/js/log.js &#x6587;&#x4EF6;&#x65F6;
    event {
        // &#x53D1;&#x751F;&#x6539;&#x53D8;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x4E0D;&#x7BA1;&#x662F;&#x6DFB;&#x52A0;&#xFF0C;&#x6539;&#x53D8;&#x6216;&#x662F;&#x5220;&#x9664;
        type: &apos;changed&apos;, 
        // &#x89E6;&#x53D1;&#x4E8B;&#x4EF6;&#x7684;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;
        path: &apos;/Users/nimojs/Documents/code/gulp-book/demo/chapter7/src/js/log.js&apos;
    }
    */</span>
})
</code></pre>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5229;&#x7528; <code>event</code> &#x7ED9;&#x5230;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x68C0;&#x6D4B;&#x5230;&#x67D0;&#x4E2A; js &#x6587;&#x4EF6;&#x88AB;&#x4FEE;&#x6539;&#x65F6;&#xFF0C;&#x53EA;&#x7F16;&#x5199;&#x5F53;&#x524D;&#x4FEE;&#x6539;&#x7684; js &#x6587;&#x4EF6;&#x3002;</p>
<p>&#x53EF;&#x4EE5;&#x5229;&#x7528; <code>gulp-watch-path</code> &#x914D;&#x5408; <code>event</code> &#x83B7;&#x53D6;&#x7F16;&#x8BD1;&#x8DEF;&#x5F84;&#x548C;&#x8F93;&#x51FA;&#x8DEF;&#x5F84;&#x3002;</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> watchPath = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;gulp-watch-path&apos;</span>)

gulp.task(<span class="hljs-string">&apos;watchjs&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    gulp.watch(<span class="hljs-string">&apos;src/js/**/*.js&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
        <span class="hljs-keyword">var</span> paths = watchPath(event, <span class="hljs-string">&apos;src/&apos;</span>, <span class="hljs-string">&apos;dist/&apos;</span>)
        <span class="hljs-comment">/*
        paths
            { srcPath: &apos;src/js/log.js&apos;,
              srcDir: &apos;src/js/&apos;,
              distPath: &apos;dist/js/log.js&apos;,
              distDir: &apos;dist/js/&apos;,
              srcFilename: &apos;log.js&apos;,
              distFilename: &apos;log.js&apos; }
        */</span>
        gutil.log(gutil.colors.green(event.type) + <span class="hljs-string">&apos; &apos;</span> + paths.srcPath)
        gutil.log(<span class="hljs-string">&apos;Dist &apos;</span> + paths.distPath)

        gulp.src(paths.srcPath)
            .pipe(uglify())
            .pipe(gulp.dest(paths.distDir))
    })
})

gulp.task(<span class="hljs-string">&apos;default&apos;</span>, [<span class="hljs-string">&apos;watchjs&apos;</span>])
</code></pre>
<p><a href="https://github.com/nimojs/gulp-book/tree/master/demo/chapter7/use-gulp-watch-path.js">use-gulp-watch-path &#x5B8C;&#x6574;&#x4EE3;&#x7801;</a></p>
<p><strong><code>watchPath(event, search, replace, distExt)</code></strong></p>
<table>
<thead>
<tr>
<th>&#x53C2;&#x6570;</th>
<th>&#x8BF4;&#x660E;</th>
</tr>
</thead>
<tbody>
<tr>
<td>event</td>
<td><code>gulp.watch</code> &#x56DE;&#x8C03;&#x51FD;&#x6570;&#x7684; <code>event</code></td>
</tr>
<tr>
<td>search</td>
<td>&#x9700;&#x8981;&#x88AB;&#x66FF;&#x6362;&#x7684;&#x8D77;&#x59CB;&#x5B57;&#x7B26;&#x4E32;</td>
</tr>
<tr>
<td>replace</td>
<td>&#x7B2C;&#x4E09;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x65B0;&#x7684;&#x7684;&#x5B57;&#x7B26;&#x4E32;</td>
</tr>
<tr>
<td>distExt</td>
<td>&#x6269;&#x5C55;&#x540D;(&#x975E;&#x5FC5;&#x586B;)</td>
</tr>
</tbody>
</table>
<p>&#x6B64;&#x65F6;&#x7F16;&#x8F91; <a href="https://github.com/nimojs/gulp-demo/blob/master/src/js/log.js">src/js/log.js</a> &#x6587;&#x4EF6;&#x5E76;&#x4FDD;&#x5B58;&#xFF0C;&#x547D;&#x4EE4;&#x884C;&#x4F1A;&#x51FA;&#x73B0;&#x6D88;&#x606F;&#xFF0C;&#x8868;&#x793A;&#x68C0;&#x6D4B;&#x5230; <code>src/js/log.js</code> &#x6587;&#x4EF6;&#x4FEE;&#x6539;&#x540E;&#x53EA;&#x91CD;&#x65B0;&#x7F16;&#x8BD1; <code>log.js</code>&#x3002;</p>
<pre><code class="lang-ruby">[<span class="hljs-number">21</span><span class="hljs-symbol">:</span><span class="hljs-number">47</span><span class="hljs-symbol">:</span><span class="hljs-number">25</span>] changed src/js/log.js
[<span class="hljs-number">21</span><span class="hljs-symbol">:</span><span class="hljs-number">47</span><span class="hljs-symbol">:</span><span class="hljs-number">25</span>] <span class="hljs-constant">Dist</span> dist/js/log.js
</code></pre>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE; <a href="https://github.com/nimojs/gulp-watch-path">gulp-watch-path</a> &#x4E86;&#x89E3;&#x66F4;&#x591A;&#x3002;</p>
<h3 id="t47stream-combiner2">stream-combiner2 <a href="#t47stream-combiner2"> # </a></h3>
<p>&#x7F16;&#x8F91; <code>log.js</code> &#x6587;&#x4EF6;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x6587;&#x4EF6;&#x4E2D;&#x6709; js &#x8BED;&#x6CD5;&#x9519;&#x8BEF;&#x65F6;&#xFF0C;gulp &#x4F1A;&#x7EC8;&#x6B62;&#x8FD0;&#x884C;&#x5E76;&#x62A5;&#x9519;&#x3002;</p>
<p>&#x5F53; log.js &#x7F3A;&#x5C11; <code>)</code></p>
<pre><code class="lang-js">log(<span class="hljs-string">&apos;gulp-book&apos;</span>
</code></pre>
<p>&#x5E76;&#x4FDD;&#x5B58;&#x6587;&#x4EF6;&#x65F6;&#x51FA;&#x73B0;&#x5982;&#x4E0B;&#x9519;&#x8BEF;&#xFF0C;&#x4F46;&#x662F;&#x9519;&#x8BEF;&#x4FE1;&#x606F;&#x4E0D;&#x5168;&#x9762;&#x3002;&#x800C;&#x4E14;&#x8FD8;&#x4F1A;&#x8BA9; gulp &#x505C;&#x6B62;&#x8FD0;&#x884C;&#x3002;</p>
<pre><code>events.js:85
      throw er; // Unhandled &apos;error&apos; event
            ^
Error
    at new JS_Parse_Error (/Users/nimojs/Documents/code/gulp-book/demo/chapter7/node_modules/gulp-uglify/node_modules/uglify-js/lib/parse.js:189:18)
...
...
js_error (/Users/nimojs/Documents/code/gulp-book/demo/chapter7/node_modules/gulp-
-book/demo/chapter7/node_modules/gulp-uglify/node_modules/uglify-js/lib/parse.js:1165:20)
    at maybe_unary (/Users/nimojs/Documents/code/gulp-book/demo/chapter7/node_modules/gulp-uglify/node_modules/uglify-js/lib/parse.js:1328:19)
</code></pre><p>&#x5E94;&#x5BF9;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <a href="https://github.com/gulpjs/gulp/blob/master/docs/recipes/combining-streams-to-handle-errors.md">Combining streams to handle errors</a> &#x6587;&#x6863;&#x4E2D;&#x63A8;&#x8350;&#x7684; <a href="https://github.com/substack/stream-combiner2">stream-combiner2</a>  &#x6355;&#x83B7;&#x9519;&#x8BEF;&#x4FE1;&#x606F;&#x3002;</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> handleError = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{
    <span class="hljs-keyword">var</span> colors = gutil.colors;
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;\n&apos;</span>)
    gutil.log(colors.red(<span class="hljs-string">&apos;Error!&apos;</span>))
    gutil.log(<span class="hljs-string">&apos;fileName: &apos;</span> + colors.red(err.fileName))
    gutil.log(<span class="hljs-string">&apos;lineNumber: &apos;</span> + colors.red(err.lineNumber))
    gutil.log(<span class="hljs-string">&apos;message: &apos;</span> + err.message)
    gutil.log(<span class="hljs-string">&apos;plugin: &apos;</span> + colors.yellow(err.plugin))
}
<span class="hljs-keyword">var</span> combiner = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;stream-combiner2&apos;</span>)

gulp.task(<span class="hljs-string">&apos;watchjs&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    gulp.watch(<span class="hljs-string">&apos;src/js/**/*.js&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
        <span class="hljs-keyword">var</span> paths = watchPath(event, <span class="hljs-string">&apos;src/&apos;</span>, <span class="hljs-string">&apos;dist/&apos;</span>)
        <span class="hljs-comment">/*
        paths
            { srcPath: &apos;src/js/log.js&apos;,
              srcDir: &apos;src/js/&apos;,
              distPath: &apos;dist/js/log.js&apos;,
              distDir: &apos;dist/js/&apos;,
              srcFilename: &apos;log.js&apos;,
              distFilename: &apos;log.js&apos; }
        */</span>
        gutil.log(gutil.colors.green(event.type) + <span class="hljs-string">&apos; &apos;</span> + paths.srcPath)
        gutil.log(<span class="hljs-string">&apos;Dist &apos;</span> + paths.distPath)

        <span class="hljs-keyword">var</span> combined = combiner.obj([
            gulp.src(paths.srcPath),
            uglify(),
            gulp.dest(paths.distDir)
        ])

        combined.on(<span class="hljs-string">&apos;error&apos;</span>, handleError)
    })
})
</code></pre>
<p><a href="https://github.com/nimojs/gulp-book/tree/master/demo/chapter7/watchjs-1.js">watchjs-1 &#x5B8C;&#x6574;&#x4EE3;&#x7801;</a></p>
<p>&#x6B64;&#x65F6;&#x5F53;&#x7F16;&#x8BD1;&#x9519;&#x8BEF;&#x7684;&#x8BED;&#x6CD5;&#x65F6;&#xFF0C;&#x547D;&#x4EE4;&#x884C;&#x4F1A;&#x51FA;&#x73B0;&#x9519;&#x8BEF;&#x63D0;&#x793A;&#x3002;&#x800C;&#x4E14;&#x4E0D;&#x4F1A;&#x8BA9; gulp &#x505C;&#x6B62;&#x8FD0;&#x884C;&#x3002;</p>
<pre><code>changed:src/js/log.js
dist:dist/js/log.js
--------------
Error!
fileName: /Users/nimojs/Documents/code/gulp-book/demo/chapter7/src/js/log.js
lineNumber: 7
message: /Users/nimojs/Documents/code/gulp-book/demo/chapter7/src/js/log.js: Unexpected token eof &#xAB;undefined&#xBB;, expected punc &#xAB;,&#xBB;
plugin: gulp-uglify
</code></pre><h3 id="t48gulp-sourcemaps">gulp-sourcemaps <a href="#t48gulp-sourcemaps"> # </a></h3>
<p>JS &#x538B;&#x7F29;&#x524D;&#x548C;&#x538B;&#x7F29;&#x540E;&#x6BD4;&#x8F83;</p>
<pre><code class="lang-js"><span class="hljs-comment">// &#x538B;&#x7F29;&#x524D;</span>
<span class="hljs-keyword">var</span> log = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">msg</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;--------&apos;</span>);
    <span class="hljs-built_in">console</span>.log(msg)
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;--------&apos;</span>);
}
log({a:<span class="hljs-number">1</span>})
log(<span class="hljs-string">&apos;gulp-book&apos;</span>)

<span class="hljs-comment">// &#x538B;&#x7F29;&#x540E;</span>
<span class="hljs-keyword">var</span> log=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">o</span>)</span>{<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;--------&quot;</span>),<span class="hljs-built_in">console</span>.log(o),<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;--------&quot;</span>)};log({a:<span class="hljs-number">1</span>}),log(<span class="hljs-string">&quot;gulp-book&quot;</span>);
</code></pre>
<p>&#x538B;&#x7F29;&#x540E;&#x7684;&#x4EE3;&#x7801;&#x4E0D;&#x5B58;&#x5728;&#x6362;&#x884C;&#x7B26;&#x548C;&#x7A7A;&#x767D;&#x7B26;&#xFF0C;&#x5BFC;&#x81F4;&#x51FA;&#x9519;&#x540E;&#x5F88;&#x96BE;&#x8C03;&#x8BD5;&#xFF0C;&#x597D;&#x5728;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <a href="http://www.ruanyifeng.com/blog/2013/01/javascript_source_map.html">sourcemap</a> &#x5E2E;&#x52A9;&#x8C03;&#x8BD5;</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> sourcemaps = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;gulp-sourcemaps&apos;</span>)
<span class="hljs-comment">// ...</span>
<span class="hljs-keyword">var</span> combined = combiner.obj([
    gulp.src(paths.srcPath),
    sourcemaps.init(),
    uglify(),
    sourcemaps.write(<span class="hljs-string">&apos;./&apos;</span>),
    gulp.dest(paths.distDir)
])
<span class="hljs-comment">// ...</span>
</code></pre>
<p><a href="https://github.com/nimojs/gulp-book/tree/master/demo/chapter7/watchjs-1.js">watchjs-2 &#x5B8C;&#x6574;&#x4EE3;&#x7801;</a></p>
<p>&#x6B64;&#x65F6; <code>dist/js/</code> &#x4E2D;&#x4E5F;&#x4F1A;&#x751F;&#x6210;&#x5BF9;&#x5E94;&#x7684; <code>.map</code> &#x6587;&#x4EF6;&#xFF0C;&#x4EE5;&#x4FBF;&#x4F7F;&#x7528; Chrome &#x63A7;&#x5236;&#x53F0;&#x8C03;&#x8BD5;&#x4EE3;&#x7801; <a href="https://github.com/nimojs/gulp-demo/blob/master/src/js/">&#x5728;&#x7EBF;&#x6587;&#x4EF6;&#x793A;&#x4F8B;&#xFF1A;src/js/</a></p>
<hr>
<p>&#x81F3;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x5B8C;&#x6210;&#x4E86;&#x68C0;&#x6D4B;&#x6587;&#x4EF6;&#x4FEE;&#x6539;&#x540E;&#x538B;&#x7F29; JS &#x7684; gulp &#x4EFB;&#x52A1;&#x914D;&#x7F6E;&#x3002;</p>
<p>&#x6709;&#x65F6;&#x6211;&#x4EEC;&#x4E5F;&#x9700;&#x8981;&#x4E00;&#x6B21;&#x7F16;&#x8BD1;&#x6240;&#x6709; js &#x6587;&#x4EF6;&#x3002;&#x53EF;&#x4EE5;&#x914D;&#x7F6E; <code>uglifyjs</code> &#x4EFB;&#x52A1;&#x3002;</p>
<pre><code class="lang-js">gulp.task(<span class="hljs-string">&apos;uglifyjs&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> combined = combiner.obj([
        gulp.src(<span class="hljs-string">&apos;src/js/**/*.js&apos;</span>),
        sourcemaps.init(),
        uglify(),
        sourcemaps.write(<span class="hljs-string">&apos;./&apos;</span>),
        gulp.dest(<span class="hljs-string">&apos;dist/js/&apos;</span>)
    ])
    combined.on(<span class="hljs-string">&apos;error&apos;</span>, handleError)
})
</code></pre>
<p>&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x5165; <code>gulp uglifyjs</code> &#x4EE5;&#x538B;&#x7F29; <code>src/js/</code> &#x4E0B;&#x7684;&#x6240;&#x6709; js &#x6587;&#x4EF6;&#x3002;</p>
<h2 id="t49&#x914D;&#x7F6E; CSS &#x4EFB;&#x52A1;">&#x914D;&#x7F6E; CSS &#x4EFB;&#x52A1; <a href="#t49&#x914D;&#x7F6E; CSS &#x4EFB;&#x52A1;"> # </a></h2>
<p>&#x6709;&#x65F6;&#x6211;&#x4EEC;&#x4E0D;&#x60F3;&#x4F7F;&#x7528; LESS &#x6216; SASS&#x800C;&#x662F;&#x76F4;&#x63A5;&#x7F16;&#x5199; CSS&#xFF0C;&#x4F46;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x538B;&#x7F29; CSS &#x4EE5;&#x63D0;&#x9AD8;&#x9875;&#x9762;&#x52A0;&#x8F7D;&#x901F;&#x5EA6;&#x3002;</p>
<h3 id="t50gulp-minify-css">gulp-minify-css <a href="#t50gulp-minify-css"> # </a></h3>
<p>&#x6309;&#x7167;&#x672C;&#x7AE0;&#x4E2D;&#x538B;&#x7F29; JS &#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x5148;&#x7F16;&#x5199; <code>watchcss</code> &#x4EFB;&#x52A1;</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> minifycss = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;gulp-minify-css&apos;</span>)

gulp.task(<span class="hljs-string">&apos;watchcss&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    gulp.watch(<span class="hljs-string">&apos;src/css/**/*.css&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
        <span class="hljs-keyword">var</span> paths = watchPath(event, <span class="hljs-string">&apos;src/&apos;</span>, <span class="hljs-string">&apos;dist/&apos;</span>)

        gutil.log(gutil.colors.green(event.type) + <span class="hljs-string">&apos; &apos;</span> + paths.srcPath)
        gutil.log(<span class="hljs-string">&apos;Dist &apos;</span> + paths.distPath)

        gulp.src(paths.srcPath)
            .pipe(sourcemaps.init())
            .pipe(minifycss())
            .pipe(sourcemaps.write(<span class="hljs-string">&apos;./&apos;</span>))
            .pipe(gulp.dest(paths.distDir))
    })
})

gulp.task(<span class="hljs-string">&apos;default&apos;</span>, [<span class="hljs-string">&apos;watchjs&apos;</span>,<span class="hljs-string">&apos;watchcss&apos;</span>])
</code></pre>
<h3 id="t51gulp-autoprefixer">gulp-autoprefixer <a href="#t51gulp-autoprefixer"> # </a></h3>
<p>autoprefixer &#x89E3;&#x6790; CSS &#x6587;&#x4EF6;&#x5E76;&#x4E14;&#x6DFB;&#x52A0;&#x6D4F;&#x89C8;&#x5668;&#x524D;&#x7F00;&#x5230;CSS&#x89C4;&#x5219;&#x91CC;&#x3002;
&#x901A;&#x8FC7;&#x793A;&#x4F8B;&#x5E2E;&#x52A9;&#x7406;&#x89E3; </p>
<p>autoprefixer &#x5904;&#x7406;&#x524D;&#xFF1A;</p>
<pre><code class="lang-css"><span class="hljs-class">.demo</span> <span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value">flex</span></span>;
}</span>
</code></pre>
<p>autoprefixer &#x5904;&#x7406;&#x540E;&#xFF1A;</p>
<pre><code class="lang-css"><span class="hljs-class">.demo</span> <span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value">-webkit-flex</span></span>;
    <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value">-ms-flexbox</span></span>;
    <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value">flex</span></span>;
}</span>
</code></pre>
<p>&#x4F60;&#x53EA;&#x9700;&#x8981;&#x5173;&#x5FC3;&#x7F16;&#x5199;&#x6807;&#x51C6;&#x8BED;&#x6CD5;&#x7684; css&#xFF0C;autoprefixer &#x4F1A;&#x81EA;&#x52A8;&#x8865;&#x5168;&#x3002;</p>
<p>&#x5728; watchcss &#x4EFB;&#x52A1;&#x4E2D;&#x52A0;&#x5165; autoprefixer:</p>
<pre><code class="lang-js">gulp.task(<span class="hljs-string">&apos;watchcss&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    gulp.watch(<span class="hljs-string">&apos;src/css/**/*.css&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
        <span class="hljs-keyword">var</span> paths = watchPath(event, <span class="hljs-string">&apos;src/&apos;</span>, <span class="hljs-string">&apos;dist/&apos;</span>)

        gutil.log(gutil.colors.green(event.type) + <span class="hljs-string">&apos; &apos;</span> + paths.srcPath)
        gutil.log(<span class="hljs-string">&apos;Dist &apos;</span> + paths.distPath)

        gulp.src(paths.srcPath)
            .pipe(sourcemaps.init())
            .pipe(autoprefixer({
              browsers: <span class="hljs-string">&apos;last 2 versions&apos;</span>
            }))
            .pipe(minifycss())
            .pipe(sourcemaps.write(<span class="hljs-string">&apos;./&apos;</span>))
            .pipe(gulp.dest(paths.distDir))
    })
})
</code></pre>
<p>&#x66F4;&#x591A; autoprefixer &#x53C2;&#x6570;&#x8BF7;&#x67E5;&#x770B; <a href="https://github.com/sindresorhus/gulp-autoprefixer">gulp-autoprefixer</a></p>
<p>&#x6709;&#x65F6;&#x6211;&#x4EEC;&#x4E5F;&#x9700;&#x8981;&#x4E00;&#x6B21;&#x7F16;&#x8BD1;&#x6240;&#x6709; css &#x6587;&#x4EF6;&#x3002;&#x53EF;&#x4EE5;&#x914D;&#x7F6E; <code>minifyss</code> &#x4EFB;&#x52A1;&#x3002;</p>
<pre><code class="lang-js">gulp.task(<span class="hljs-string">&apos;minifycss&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    gulp.src(<span class="hljs-string">&apos;src/css/**/*.css&apos;</span>)
        .pipe(sourcemaps.init())
        .pipe(autoprefixer({
          browsers: <span class="hljs-string">&apos;last 2 versions&apos;</span>
        }))
        .pipe(minifycss())
        .pipe(sourcemaps.write(<span class="hljs-string">&apos;./&apos;</span>))
        .pipe(gulp.dest(<span class="hljs-string">&apos;dist/css/&apos;</span>))
})
</code></pre>
<p>&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x5165; <code>gulp minifyss</code> &#x4EE5;&#x538B;&#x7F29; <code>src/css/</code> &#x4E0B;&#x7684;&#x6240;&#x6709; .css &#x6587;&#x4EF6;&#x5E76;&#x590D;&#x5236;&#x5230; <code>dist/css</code> &#x76EE;&#x5F55;&#x4E0B;</p>
<h2 id="t52&#x914D;&#x7F6E; Less &#x4EFB;&#x52A1;">&#x914D;&#x7F6E; Less &#x4EFB;&#x52A1; <a href="#t52&#x914D;&#x7F6E; Less &#x4EFB;&#x52A1;"> # </a></h2>
<p>&#x53C2;&#x8003;&#x914D;&#x7F6E; JavaScript &#x4EFB;&#x52A1;&#x7684;&#x65B9;&#x5F0F;&#x914D;&#x7F6E; less &#x4EFB;&#x52A1;</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> less = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;gulp-less&apos;</span>)

gulp.task(<span class="hljs-string">&apos;watchless&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    gulp.watch(<span class="hljs-string">&apos;src/less/**/*.less&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
        <span class="hljs-keyword">var</span> paths = watchPath(event, <span class="hljs-string">&apos;src/less/&apos;</span>, <span class="hljs-string">&apos;dist/css/&apos;</span>)

        gutil.log(gutil.colors.green(event.type) + <span class="hljs-string">&apos; &apos;</span> + paths.srcPath)
        gutil.log(<span class="hljs-string">&apos;Dist &apos;</span> + paths.distPath)
        <span class="hljs-keyword">var</span> combined = combiner.obj([
            gulp.src(paths.srcPath),
            sourcemaps.init(),
            autoprefixer({
              browsers: <span class="hljs-string">&apos;last 2 versions&apos;</span>
            }),
            less(),
            minifycss(),
            sourcemaps.write(<span class="hljs-string">&apos;./&apos;</span>),
            gulp.dest(paths.distDir)
        ])
        combined.on(<span class="hljs-string">&apos;error&apos;</span>, handleError)
    })
})

gulp.task(<span class="hljs-string">&apos;lesscss&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> combined = combiner.obj([
            gulp.src(<span class="hljs-string">&apos;src/less/**/*.less&apos;</span>),
            sourcemaps.init(),
            autoprefixer({
              browsers: <span class="hljs-string">&apos;last 2 versions&apos;</span>
            }),
            less(),
            minifycss(),
            sourcemaps.write(<span class="hljs-string">&apos;./&apos;</span>),
            gulp.dest(<span class="hljs-string">&apos;dist/css/&apos;</span>)
        ])
    combined.on(<span class="hljs-string">&apos;error&apos;</span>, handleError)
})

gulp.task(<span class="hljs-string">&apos;default&apos;</span>, [<span class="hljs-string">&apos;watchjs&apos;</span>, <span class="hljs-string">&apos;watchcss&apos;</span>, <span class="hljs-string">&apos;watchless&apos;</span>])
</code></pre>
<h2 id="t53&#x914D;&#x7F6E; Sass &#x4EFB;&#x52A1;">&#x914D;&#x7F6E; Sass &#x4EFB;&#x52A1; <a href="#t53&#x914D;&#x7F6E; Sass &#x4EFB;&#x52A1;"> # </a></h2>
<p>&#x53C2;&#x8003;&#x914D;&#x7F6E; JavaScript &#x4EFB;&#x52A1;&#x7684;&#x65B9;&#x5F0F;&#x914D;&#x7F6E; Sass &#x4EFB;&#x52A1;</p>
<pre><code class="lang-js">gulp.task(<span class="hljs-string">&apos;watchsass&apos;</span>,<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    gulp.watch(<span class="hljs-string">&apos;src/sass/**/*&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
        <span class="hljs-keyword">var</span> paths = watchPath(event, <span class="hljs-string">&apos;src/sass/&apos;</span>, <span class="hljs-string">&apos;dist/css/&apos;</span>)

        gutil.log(gutil.colors.green(event.type) + <span class="hljs-string">&apos; &apos;</span> + paths.srcPath)
        gutil.log(<span class="hljs-string">&apos;Dist &apos;</span> + paths.distPath)
        sass(paths.srcPath)
            .on(<span class="hljs-string">&apos;error&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{
                <span class="hljs-built_in">console</span>.error(<span class="hljs-string">&apos;Error!&apos;</span>, err.message);
            })
            .pipe(sourcemaps.init())
            .pipe(minifycss())
            .pipe(autoprefixer({
              browsers: <span class="hljs-string">&apos;last 2 versions&apos;</span>
            }))
            .pipe(sourcemaps.write(<span class="hljs-string">&apos;./&apos;</span>))
            .pipe(gulp.dest(paths.distDir))
    })
})

gulp.task(<span class="hljs-string">&apos;sasscss&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        sass(<span class="hljs-string">&apos;src/sass/&apos;</span>)
        .on(<span class="hljs-string">&apos;error&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{
            <span class="hljs-built_in">console</span>.error(<span class="hljs-string">&apos;Error!&apos;</span>, err.message);
        })
        .pipe(sourcemaps.init())
        .pipe(minifycss())
        .pipe(autoprefixer({
          browsers: <span class="hljs-string">&apos;last 2 versions&apos;</span>
        }))
        .pipe(sourcemaps.write(<span class="hljs-string">&apos;./&apos;</span>))
        .pipe(gulp.dest(<span class="hljs-string">&apos;dist/css&apos;</span>))
})

gulp.task(<span class="hljs-string">&apos;default&apos;</span>, [<span class="hljs-string">&apos;watchjs&apos;</span>, <span class="hljs-string">&apos;watchcss&apos;</span>, <span class="hljs-string">&apos;watchless&apos;</span>, <span class="hljs-string">&apos;watchsass&apos;</span>, <span class="hljs-string">&apos;watchsass&apos;</span>])
</code></pre>
<h2 id="t54&#x914D;&#x7F6E; image &#x4EFB;&#x52A1;">&#x914D;&#x7F6E; image &#x4EFB;&#x52A1; <a href="#t54&#x914D;&#x7F6E; image &#x4EFB;&#x52A1;"> # </a></h2>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> imagemin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;gulp-imagemin&apos;</span>)

gulp.task(<span class="hljs-string">&apos;watchimage&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    gulp.watch(<span class="hljs-string">&apos;src/images/**/*&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
        <span class="hljs-keyword">var</span> paths = watchPath(event,<span class="hljs-string">&apos;src/&apos;</span>,<span class="hljs-string">&apos;dist/&apos;</span>)

        gutil.log(gutil.colors.green(event.type) + <span class="hljs-string">&apos; &apos;</span> + paths.srcPath)
        gutil.log(<span class="hljs-string">&apos;Dist &apos;</span> + paths.distPath)

        gulp.src(paths.srcPath)
            .pipe(imagemin({
                progressive: <span class="hljs-literal">true</span>
            }))
            .pipe(gulp.dest(paths.distDir))
    })
})

gulp.task(<span class="hljs-string">&apos;image&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    gulp.src(<span class="hljs-string">&apos;src/images/**/*&apos;</span>)
        .pipe(imagemin({
            progressive: <span class="hljs-literal">true</span>
        }))
        .pipe(gulp.dest(<span class="hljs-string">&apos;dist/images&apos;</span>))
})
</code></pre>
<h2 id="t55&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x590D;&#x5236;&#x4EFB;&#x52A1;">&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x590D;&#x5236;&#x4EFB;&#x52A1; <a href="#t55&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x590D;&#x5236;&#x4EFB;&#x52A1;"> # </a></h2>
<p>&#x590D;&#x5236; <code>src/fonts/</code> &#x6587;&#x4EF6;&#x5230; <code>dist/</code> &#x4E2D;</p>
<pre><code class="lang-js">gulp.task(<span class="hljs-string">&apos;watchcopy&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    gulp.watch(<span class="hljs-string">&apos;src/fonts/**/*&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
        <span class="hljs-keyword">var</span> paths = watchPath(event)

        gutil.log(gutil.colors.green(event.type) + <span class="hljs-string">&apos; &apos;</span> + paths.srcPath)
        gutil.log(<span class="hljs-string">&apos;Dist &apos;</span> + paths.distPath)

        gulp.src(paths.srcPath)
            .pipe(gulp.dest(paths.distDir))
    })
})

gulp.task(<span class="hljs-string">&apos;copy&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    gulp.src(<span class="hljs-string">&apos;src/fonts/**/*&apos;</span>)
        .pipe(gulp.dest(<span class="hljs-string">&apos;dist/fonts/&apos;</span>))
})

gulp.task(<span class="hljs-string">&apos;default&apos;</span>, [<span class="hljs-string">&apos;watchjs&apos;</span>, <span class="hljs-string">&apos;watchcss&apos;</span>, <span class="hljs-string">&apos;watchless&apos;</span>, <span class="hljs-string">&apos;watchsass&apos;</span>, <span class="hljs-string">&apos;watchimage&apos;</span>, <span class="hljs-string">&apos;watchcopy&apos;</span>])
</code></pre>
<h2 id="t56&#x7ED3;&#x8BED;">&#x7ED3;&#x8BED; <a href="#t56&#x7ED3;&#x8BED;"> # </a></h2>
<p><a href="https://github.com/nimojs/gulp-demo/tree/master/gulpfile.js">&#x5B8C;&#x6574;&#x4EE3;&#x7801;</a></p>

        <div class="copyright">Powered by <a href="https://github.com/jaywcjlove/idoc" target="_blank">idoc</a>. Dependence <a href="https://nodejs.org">Node.js</a> run.</div>
    </div>

</div>


</body>
</html>
