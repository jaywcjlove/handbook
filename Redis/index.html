<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>10 分钟快速入门 Redis handbook</title>
    <meta name="description" content="测试make test报错">
    <meta name="keywords" content="handbook,笔记,搜集,摘录,实践,tutorial">
    <link rel="stylesheet" type="text/css" href="../css/main.css?v=1.34.1">
    <link rel="stylesheet" type="text/css" href="../css/tocbot.css?v=1.34.1">
    <link rel="stylesheet" type="text/css" href="../css/media.css?v=1.34.1">
    <link rel="stylesheet" type="text/css" href="../css/sidebar.css?v=1.34.1">
    <link rel="stylesheet" type="text/css" href="../css/copy.css?v=1.34.1">
    <link rel="stylesheet" type="text/css" href="../css/demo-preview.css?v=1.34.1">
    <link rel="icon" href="data:image/png;base64,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" type="image/x-icon">
    <script src="../js/copy.js?v=1.34.1"></script>
    <script src="../js/dark-mode.js?v=1.34.1"></script>
    <script src="../js/markdown-style.js?v=1.34.1"></script>
  </head>
  <body id="idoctotop"><a href="#idoctotop" class="gototop">top</a>
    <header class="header">
      <article class="inner warpper"><a class="logo" href="../index.html"><img alt="handbook logo" src="data:image/png;base64,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">
<span class="title">handbook</span></a>
        <div class="content">
          <ul class="menu">
            <li><a href="../index.html" target="" class="">Home</a></li>
            <li><a href="../awesome.html" target="" class="">Awesome</a></li>
            <li><a href="https://wangchujiang.com/#/app" target="__blank" class="">Apps</a></li>
            <li><a href="https://wangchujiang.com/#/sponsor" target="__blank" class="">Sponsor</a></li>
          </ul><a href="https://github.com/jaywcjlove/handbook" target="_blank" rel="noopener noreferrer" title="Github" name="Github" class="github"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
            </svg></a>
          <dark-mode permanent=""></dark-mode>
        </div>
      </article>
    </header>
    <div class="warpper-content warpper sidebar">
      <div class="sidebar-border">
        <aside class="sidebar" role="navigation">
          <div>
            <label>JavaScript</label>
            <a href="../JavaScript/RegExp.html" class="">一些正则表达式随记</a>
            <a href="../JavaScript/SDK.html" class="">开源 JS 插件和库</a>
            <a href="../JavaScript/nodejs.html" class="">NodeJS 包搜集</a>
            <a href="../JavaScript/思维导图来学习 Javascript 基础知识.html" class="">基础知识(思维导图)</a>
            <label>Redis</label>
            <a href="index.html" class="active">快速入门 Redis</a>
            <label>Android</label>
            <a href="../Android/react-native.html" class="">React Native Android 环境搭建</a>
            <label>CentOS</label>
            <a href="../CentOS/CentOS.html" class="">CentOS 常用命令</a>
            <a href="../CentOS/CentOS7网络配置.html" class="">CentOS7 网络配置</a>
            <a href="../CentOS/常用基础命令.html" class="">常用基础命令</a>
            <a href="../CentOS/CentOS7安装KVM虚拟机详解.html" class="">安装 KVM 虚拟机详解</a>
            <a href="../CentOS/CentOS7更换yum软件镜像源.html" class="">更换 yum 软件镜像源</a>
            <a href="../CentOS/CentOS7安装维护Gitlab.html" class="">安装维护 GitLab</a>
            <a href="../CentOS/CentOS7安装配置vsftp搭建FTP.html" class="">安装搭建 FTP</a>
            <a href="../CentOS/Centos7安装编译Node.html" class="">Centos7安装编译Node</a>
            <a href="../CentOS/Elasticsearch安装维护.html" class="">Elasticsearch安装维护</a>
            <a href="../CentOS/Frp内网穿透搭建.html" class="">Frp内网穿透搭建</a>
            <a href="../CentOS/Linux添加、删除用户和用户组.html" class="">Linux添加、删除用户和用户组</a>
            <a href="../CentOS/Mac使用NFS连接CentOS上的共享文件夹.html" class="">Mac使用NFS连接CentOS上的共享文件夹</a>
            <a href="../CentOS/Mac下制作CentOS7启动盘.html" class="">Mac下制作CentOS7启动盘</a>
            <a href="../CentOS/Python2升级到Python3.html" class="">Python2 升级到 Python3</a>
            <a href="../CentOS/Rocket.Chat.html" class="">Rocket.Chat</a>
            <a href="../CentOS/Ruby安装.html" class="">Ruby 安装</a>
            <a href="../CentOS/samba.html" class="">Samba 安装</a>
            <a href="../CentOS/在5分钟内搭建企业内部私有npm仓库.html" class="">搭建私有 npm 仓库</a>
            <a href="../CentOS/Java.html" class="">安装 Java</a>
            <a href="../CentOS/部署Seafile搭建自己的网盘.html" class="">部署 Seafile 搭建自己的网盘</a>
            <a href="../CentOS/搭建Shadowsocks服务器.html" class="">搭建 Shadowsocks 服务器</a>
            <a href="../CentOS/部署YApi平台.html" class="">部署 YApi 平台</a>
            <a href="../CentOS/openstack.html" class="">搭建 OpenStack</a>
            <a href="../CentOS/pip.html" class="">安装 pip 工具</a>
            <a href="../CentOS/修改ssh端口号的方法.html" class="">修改 ssh 端口号的方法</a>
            <a href="../CentOS/尝试在CentOS7.2上编译安装Swift.html" class="">在CentOS 上编译安装 Swift</a>
            <a href="../CentOS/使用免费SSL证书让网站支持HTTPS访问.html" class="">使用免费 SSL 证书支持 HTTPS 访问</a>
            <a href="../CentOS/svn.html" class="">安装使用 svn</a>
            <a href="../CentOS/管理远程会话screen工具.html" class="">管理远程会话screen工具</a>
            <label>macOS</label>
            <a href="../macOS/创建 macOS 操作系统的 App 图标文件 icons.html" class="">创建 macOS 操作系统的 App 图标文件 icons</a>
            <label>其它</label>
            <a href="../other/weixin-public-account.html" class="">公众账号推荐</a>
            <a href="../other/google.html" class="">谷歌(Google)镜像</a>
            <a href="../other/离线预览各种前端文档网站.html" class="">离线预览前端文档</a>
            <a href="../other/通过代理工具提高Github Clone速度.html" class="">提高 Github Clone 速度</a>
            <a href="../other/github-oraganizations.html" class="">国内互联网公司的开源项目汇总</a>
            <a href="../other/HTTP-status-codes.html" class="">常见HTTP/FTP错误代码大全</a>
            <a href="../other/Lua5.3.html" class="">Lua 5.3 文档</a>
            <a href="../Shortcuts/Sketch.html" class="">Sketch 设计软件快捷键</a>
            <a href="../Shortcuts/bash.html" class="">命令行工具bash快捷键</a>
          </div>
        </aside>
      </div>
      <markdown-style theme-auto-switch-disabled="">
        <h1 id="10-分钟快速入门-redis"><a aria-hidden="true" tabindex="-1" href="#10-分钟快速入门-redis" class="anchor"><span class="icon icon-link"></span></a>10 分钟快速入门 Redis</h1>
        <h2 id="redis安装"><a aria-hidden="true" tabindex="-1" href="#redis安装" class="anchor"><span class="icon icon-link"></span></a>Redis安装</h2>
        <h3 id="官方编译安装"><a aria-hidden="true" tabindex="-1" href="#官方编译安装" class="anchor"><span class="icon icon-link"></span></a>官方编译安装</h3>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">wget</span> http://download.redis.io/releases/redis-4.0.0.tar.gz
</span><span class="code-line line-number" line="2">$ <span class="token function">tar</span> xzvf redis-4.0.0.tar.gz <span class="token parameter variable">-C</span> /usr/local/
</span><span class="code-line line-number" line="3">$ <span class="token builtin class-name">cd</span> /usr/local/redis-4.0.0
</span><span class="code-line line-number" line="4">$ <span class="token function">make</span>
</span><span class="code-line line-number" line="5">$ <span class="token function">make</span> <span class="token builtin class-name">test</span>
</span><span class="code-line line-number" line="6">$ <span class="token function">make</span> <span class="token function">install</span> 
</span><span class="code-line line-number" line="7"><span class="token comment"># 程序会自动执行:</span>
</span><span class="code-line line-number" line="8"><span class="token comment"># mkdir -p /usr/local/bin</span>
</span><span class="code-line line-number" line="9"><span class="token comment"># cp -pf redis-server /usr/local/bin</span>
</span><span class="code-line line-number" line="10"><span class="token comment"># cp -pf redis-benchmark /usr/local/bin</span>
</span><span class="code-line line-number" line="11"><span class="token comment"># cp -pf redis-cli /usr/local/bin</span>
</span><span class="code-line line-number" line="12"><span class="token comment"># cp -pf redis-check-dump /usr/local/bin</span>
</span><span class="code-line line-number" line="13"><span class="token comment"># cp -pf redis-check-aof /usr/local/bin</span>
</span></code><input type="hidden" value="$ wget http://download.redis.io/releases/redis-4.0.0.tar.gz
$ tar xzvf redis-4.0.0.tar.gz -C /usr/local/
$ cd /usr/local/redis-4.0.0
$ make
$ make test
$ make install 
# 程序会自动执行:
# mkdir -p /usr/local/bin
# cp -pf redis-server /usr/local/bin
# cp -pf redis-benchmark /usr/local/bin
# cp -pf redis-cli /usr/local/bin
# cp -pf redis-check-dump /usr/local/bin
# cp -pf redis-check-aof /usr/local/bin
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>测试<code>make test</code>报错</p>
        <pre><code class="code-highlight"><span class="code-line line-number" line="1">$ make test
</span><span class="code-line line-number" line="2">You need tcl 8.5 or newer in order to run the Redis test
</span><span class="code-line line-number" line="3">make: *** [test] Error 1
</span></code><input type="hidden" value="$ make test
You need tcl 8.5 or newer in order to run the Redis test
make: *** [test] Error 1
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>这个是需要安装<code>tcl</code></p>
        <pre><code class="code-highlight"><span class="code-line line-number" line="1">wget http://downloads.sourceforge.net/tcl/tcl8.6.1-src.tar.gz  
</span><span class="code-line line-number" line="2">sudo tar xzvf tcl8.6.1-src.tar.gz  -C /usr/local/  
</span><span class="code-line line-number" line="3">cd  /usr/local/tcl8.6.1/unix/  
</span><span class="code-line line-number" line="4">sudo ./configure  
</span><span class="code-line line-number" line="5">sudo make  
</span><span class="code-line line-number" line="6">sudo make install   
</span></code><input type="hidden" value="wget http://downloads.sourceforge.net/tcl/tcl8.6.1-src.tar.gz  
sudo tar xzvf tcl8.6.1-src.tar.gz  -C /usr/local/  
cd  /usr/local/tcl8.6.1/unix/  
sudo ./configure  
sudo make  
sudo make install   
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h3 id="通过epel源安装"><a aria-hidden="true" tabindex="-1" href="#通过epel源安装" class="anchor"><span class="icon icon-link"></span></a>通过EPEL源安装</h3>
        <p>源安装问题在于不能安装最新，或者指定Redis版本。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">yum <span class="token parameter variable">--enablerepo</span><span class="token operator">=</span>epel <span class="token parameter variable">-y</span> <span class="token function">install</span> redis
</span></code><input type="hidden" value="yum --enablerepo=epel -y install redis
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>如果没有安装源，通过下面方式安装源。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token builtin class-name">cd</span> /etc/yum.repos.d/
</span><span class="code-line line-number" line="2"><span class="token function">rpm</span> <span class="token parameter variable">-Uvh</span> http://download.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm
</span></code><input type="hidden" value="cd /etc/yum.repos.d/
rpm -Uvh http://download.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h3 id="redis升级"><a aria-hidden="true" tabindex="-1" href="#redis升级" class="anchor"><span class="icon icon-link"></span></a>Redis升级</h3>
        <p>首先，确保安装了以下repos，EPEL和REMI：</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">sudo</span> <span class="token function">rpm</span> <span class="token parameter variable">-Uvh</span> http://download.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm
</span><span class="code-line line-number" line="2"><span class="token function">sudo</span> <span class="token function">rpm</span> <span class="token parameter variable">-Uvh</span> http://rpms.remirepo.net/enterprise/remi-release-6.rpm
</span></code><input type="hidden" value="sudo rpm -Uvh http://download.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm
sudo rpm -Uvh http://rpms.remirepo.net/enterprise/remi-release-6.rpm
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>通过<code>--enablerepo=epel</code>参数查看指定源Redis版本，检查REMI repo中的Redis版本：</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">yum <span class="token parameter variable">--enablerepo</span><span class="token operator">=</span>epel info redis
</span><span class="code-line line-number" line="2"><span class="token comment"># Loaded plugins: fastestmirror</span>
</span><span class="code-line line-number" line="3"><span class="token comment"># Loading mirror speeds from cached hostfile</span>
</span><span class="code-line line-number" line="4"><span class="token comment">#  * base: centos.ustc.edu.cn</span>
</span><span class="code-line line-number" line="5"><span class="token comment">#  * epel: mirrors.tuna.tsinghua.edu.cn</span>
</span><span class="code-line line-number" line="6"><span class="token comment">#  * extras: centos.ustc.edu.cn</span>
</span><span class="code-line line-number" line="7"><span class="token comment">#  * updates: mirrors.zju.edu.cn</span>
</span><span class="code-line line-number" line="8"><span class="token comment"># Available Packages</span>
</span><span class="code-line line-number" line="9"><span class="token comment"># Name        : redis</span>
</span><span class="code-line line-number" line="10"><span class="token comment"># Arch        : x86_64</span>
</span><span class="code-line line-number" line="11"><span class="token comment"># Version     : 2.4.10</span>
</span><span class="code-line line-number" line="12"><span class="token comment"># Release     : 1.el6</span>
</span><span class="code-line line-number" line="13"><span class="token comment"># Size        : 213 k</span>
</span><span class="code-line line-number" line="14"><span class="token comment"># Repo        : epel/x86_64</span>
</span><span class="code-line line-number" line="15"><span class="token comment"># Summary     : A persistent key-value database</span>
</span><span class="code-line line-number" line="16"><span class="token comment"># URL         : http://redis.io</span>
</span><span class="code-line line-number" line="17"><span class="token comment"># License     : BSD</span>
</span><span class="code-line line-number" line="18"><span class="token comment"># Description : Redis is an advanced key-value store. It is similar to memcached but the data</span>
</span><span class="code-line line-number" line="19"><span class="token comment">#             : set is not volatile, and values can be strings, exactly like in memcached, but</span>
</span><span class="code-line line-number" line="20"><span class="token comment">#             : also lists, sets, and ordered sets. All this data types can be manipulated with</span>
</span><span class="code-line line-number" line="21"><span class="token comment">#             : atomic operations to push/pop elements, add/remove elements, perform server</span>
</span><span class="code-line line-number" line="22"><span class="token comment">#             : side union, intersection, difference between sets, and so forth. Redis supports</span>
</span><span class="code-line line-number" line="23"><span class="token comment">#             : different kind of sorting abilities.</span>
</span></code><input type="hidden" value="yum --enablerepo=epel info redis
# Loaded plugins: fastestmirror
# Loading mirror speeds from cached hostfile
#  * base: centos.ustc.edu.cn
#  * epel: mirrors.tuna.tsinghua.edu.cn
#  * extras: centos.ustc.edu.cn
#  * updates: mirrors.zju.edu.cn
# Available Packages
# Name        : redis
# Arch        : x86_64
# Version     : 2.4.10
# Release     : 1.el6
# Size        : 213 k
# Repo        : epel/x86_64
# Summary     : A persistent key-value database
# URL         : http://redis.io
# License     : BSD
# Description : Redis is an advanced key-value store. It is similar to memcached but the data
#             : set is not volatile, and values can be strings, exactly like in memcached, but
#             : also lists, sets, and ordered sets. All this data types can be manipulated with
#             : atomic operations to push/pop elements, add/remove elements, perform server
#             : side union, intersection, difference between sets, and so forth. Redis supports
#             : different kind of sorting abilities.
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>然后从EPEL repo安装相关的依赖关系（jemalloc）：</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">yum <span class="token parameter variable">--enablerepo</span><span class="token operator">=</span>epel <span class="token function">install</span> jemalloc
</span></code><input type="hidden" value="yum --enablerepo=epel install jemalloc
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>在安装之前，您应该停止旧的Redis守护进程：</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">service</span> redis stop
</span></code><input type="hidden" value="service redis stop
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>然后安装更新版本的Redis：</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">sudo</span> yum <span class="token parameter variable">--enablerepo</span><span class="token operator">=</span>remi <span class="token function">install</span> redis
</span></code><input type="hidden" value="sudo yum --enablerepo=remi install redis
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="服务管理"><a aria-hidden="true" tabindex="-1" href="#服务管理" class="anchor"><span class="icon icon-link"></span></a>服务管理</h2>
        <p>重新启动Redis守护程序，并使其重新启动时自动启动：</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">sudo</span> <span class="token function">service</span> redis start
</span><span class="code-line line-number" line="2"><span class="token function">sudo</span> <span class="token function">chkconfig</span> redis on
</span></code><input type="hidden" value="sudo service redis start
sudo chkconfig redis on
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h3 id="基本服务操作"><a aria-hidden="true" tabindex="-1" href="#基本服务操作" class="anchor"><span class="icon icon-link"></span></a>基本服务操作</h3>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment">## 启动并后台运行</span>
</span><span class="code-line line-number" line="2">$ redis-server <span class="token operator">&#x26;</span> <span class="token function">nohup</span>
</span><span class="code-line line-number" line="3"><span class="token comment">## 查是否启动</span>
</span><span class="code-line line-number" line="4">$ redis-cli <span class="token function">ping</span>
</span><span class="code-line line-number" line="5"><span class="token comment">## 关闭命令</span>
</span><span class="code-line line-number" line="6">$ redis-cli <span class="token function">shutdown</span>
</span><span class="code-line line-number" line="7">
</span><span class="code-line line-number" line="8"><span class="token comment"># 命令行客户端启动</span>
</span><span class="code-line line-number" line="9">$ redis-cli start
</span><span class="code-line line-number" line="10"><span class="token comment"># 启动</span>
</span><span class="code-line line-number" line="11">$ <span class="token function">service</span> redis start
</span><span class="code-line line-number" line="12"><span class="token comment"># 停止</span>
</span><span class="code-line line-number" line="13">$ <span class="token function">service</span> redis stop
</span><span class="code-line line-number" line="14">
</span><span class="code-line line-number" line="15"><span class="token comment"># 命令行客户端启动</span>
</span><span class="code-line line-number" line="16">$ redis-cli <span class="token parameter variable">-p</span> <span class="token number">6380</span>
</span><span class="code-line line-number" line="17">
</span><span class="code-line line-number" line="18"><span class="token comment"># 指定端口后台启动</span>
</span><span class="code-line line-number" line="19">$ redis-server <span class="token parameter variable">--port</span> <span class="token number">6380</span> <span class="token operator">&#x26;</span>
</span></code><input type="hidden" value="## 启动并后台运行
$ redis-server &#x26; nohup
## 查是否启动
$ redis-cli ping
## 关闭命令
$ redis-cli shutdown

# 命令行客户端启动
$ redis-cli start
# 启动
$ service redis start
# 停止
$ service redis stop

# 命令行客户端启动
$ redis-cli -p 6380

# 指定端口后台启动
$ redis-server --port 6380 &#x26;
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h3 id="查看版本"><a aria-hidden="true" tabindex="-1" href="#查看版本" class="anchor"><span class="icon icon-link"></span></a>查看版本</h3>
        <p>检查当前安装的Redis版本：</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># 查看 Redis 版本</span>
</span><span class="code-line line-number" line="2">$ redis-cli info <span class="token operator">|</span> <span class="token function">grep</span> redis_version
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4"><span class="token comment"># 查看端口号</span>
</span><span class="code-line line-number" line="5">$ redis-cli info <span class="token operator">|</span> <span class="token function">grep</span> tcp_port
</span></code><input type="hidden" value="# 查看 Redis 版本
$ redis-cli info | grep redis_version

# 查看端口号
$ redis-cli info | grep tcp_port
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h3 id="服务管理-1"><a aria-hidden="true" tabindex="-1" href="#服务管理-1" class="anchor"><span class="icon icon-link"></span></a>服务管理</h3>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">systemctl status redis <span class="token comment"># 查看服务状态</span>
</span><span class="code-line line-number" line="2">systemctl start redis <span class="token comment"># 启动 Redis</span>
</span><span class="code-line line-number" line="3">systemctl stop redis <span class="token comment"># 启动 Redis</span>
</span></code><input type="hidden" value="systemctl status redis # 查看服务状态
systemctl start redis # 启动 Redis
systemctl stop redis # 启动 Redis
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h3 id="开机启动"><a aria-hidden="true" tabindex="-1" href="#开机启动" class="anchor"><span class="icon icon-link"></span></a>开机启动</h3>
        <p>如果你是通过yum安装，可以使用下面方式开机启动。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">systemctl <span class="token builtin class-name">enable</span> redis.service
</span><span class="code-line line-number" line="2"><span class="token function">chkconfig</span> redis on
</span></code><input type="hidden" value="systemctl enable redis.service
chkconfig redis on
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>如果你是编译安装可通过下面方式设置开机启动</p>
        <p>我们将在 Redis 安装目录找到<code>/usr/local/redis-4.0.0/utils</code>这个目录，在这个目录中有个有个脚本 <code>redis_init_script</code>，将此脚本拷贝到<code>/etc/init.d</code>目录下，命名为<code>redis</code>:</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">cp</span> /usr/local/redis-4.0.0/utils/redis_init_script /etc/init.d/redis
</span></code><input type="hidden" value="cp /usr/local/redis-4.0.0/utils/redis_init_script /etc/init.d/redis
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>拷贝一下<code>redis.conf</code> 文件到<code>/etc/redis</code>目录下</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">cp</span> /usr/local/redis-4.0.0/redis.conf /etc/redis/6380.conf
</span></code><input type="hidden" value="cp /usr/local/redis-4.0.0/redis.conf /etc/redis/6380.conf
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>配置文件<code>6380.conf</code>需要更改几个地方</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># 是否在后台执行，yes：后台运行；no：不是后台运行（老版本默认）</span>
</span><span class="code-line line-number" line="2">daemonize <span class="token function">yes</span>
</span></code><input type="hidden" value="# 是否在后台执行，yes：后台运行；no：不是后台运行（老版本默认）
daemonize yes
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>更改权限，通过 <a href="https://jaywcjlove.github.io/linux-command/c/chkconfig.html">chkconfig</a> 命令检查、设置系统redis服务开启</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">chmod</span> +x /etc/init.d/redis
</span><span class="code-line line-number" line="2"><span class="token function">chkconfig</span> redis on
</span></code><input type="hidden" value="chmod +x /etc/init.d/redis
chkconfig redis on
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>必须把下面两行注释放在 <code>/etc/init.d/redis</code> 文件头部，不设置会报不支持的提示 <code>service redis does not support chkconfig</code></p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># chkconfig:   2345 90 10</span>
</span><span class="code-line line-number" line="2"><span class="token comment"># description:  redis is a persistent key-value database</span>
</span></code><input type="hidden" value="# chkconfig:   2345 90 10
# description:  redis is a persistent key-value database
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>上面的注释的意思是，redis服务必须在运行级2，3，4，5下被启动或关闭，启动的优先级是90，关闭的优先级是10。</p>
        <p><strong>Redis 启动警告错误解决</strong></p>
        <ol>
          <li>WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.</li>
        </ol>
        <pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1"><span class="token builtin class-name">echo</span> <span class="token string">"vm.overcommit_memory=1"</span> <span class="token operator">></span> /etc/sysctl.conf  <span class="token comment"># 或 vi /etcsysctl.conf , 然后reboot重启机器</span>
</span><span class="code-line line-number" line="2"><span class="token builtin class-name">echo</span> <span class="token number">1</span> <span class="token operator">></span> /proc/sys/vm/overcommit_memory  <span class="token comment"># 不需要启机器就生效</span>
</span></code><input type="hidden" value="echo &#x22;vm.overcommit_memory=1&#x22; > /etc/sysctl.conf  # 或 vi /etcsysctl.conf , 然后reboot重启机器
echo 1 > /proc/sys/vm/overcommit_memory  # 不需要启机器就生效
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <ol start="2">
          <li>WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.</li>
        </ol>
        <pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1"><span class="token builtin class-name">echo</span> <span class="token number">511</span> <span class="token operator">></span> /proc/sys/net/core/somaxconn
</span></code><input type="hidden" value="echo 511 > /proc/sys/net/core/somaxconn
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="更改配置"><a aria-hidden="true" tabindex="-1" href="#更改配置" class="anchor"><span class="icon icon-link"></span></a>更改配置</h2>
        <p>Redis 的配置文件位于 Redis 安装目录下，文件名为 <code>redis.conf</code>。上面已经将它拷贝到<code>/etc/redis</code>目录下了，配置文件在 <code>sudo vi /etc/redis/6380.conf</code> 这里可以编辑</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">sudo</span> <span class="token function">vi</span> /etc/redis/6380.conf
</span></code><input type="hidden" value="sudo vi /etc/redis/6380.conf
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>你可以通过 CONFIG 命令查看或设置配置项。配置设置命令</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment">## 进入redis获取</span>
</span><span class="code-line line-number" line="2"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> CONFIG GET CONFIG_SETTING_NAME
</span><span class="code-line line-number" line="3"><span class="token comment">## 进入redis设置</span>
</span><span class="code-line line-number" line="4"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> CONFIG SET CONFIG_SETTING_NAME NEW_CONFIG_VALUE
</span><span class="code-line line-number" line="5">
</span><span class="code-line line-number" line="6"><span class="token comment">## 获取所有配置</span>
</span><span class="code-line line-number" line="7"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> CONFIG GET *
</span><span class="code-line line-number" line="8">
</span><span class="code-line line-number" line="9"><span class="token comment">## 设置配置开启通知功能</span>
</span><span class="code-line line-number" line="10">$ redis-cli config <span class="token builtin class-name">set</span> notify-keyspace-events KEA
</span></code><input type="hidden" value="## 进入redis获取
127.0.0.1:6379> CONFIG GET CONFIG_SETTING_NAME
## 进入redis设置
127.0.0.1:6379> CONFIG SET CONFIG_SETTING_NAME NEW_CONFIG_VALUE

## 获取所有配置
127.0.0.1:6379> CONFIG GET *

## 设置配置开启通知功能
$ redis-cli config set notify-keyspace-events KEA
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="设置请求密码"><a aria-hidden="true" tabindex="-1" href="#设置请求密码" class="anchor"><span class="icon icon-link"></span></a>设置请求密码</h2>
        <p>打开 <code>vim /etc/redis/6380.conf</code> 配置文件编辑它，更改下面两项内容：</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># ...</span>
</span><span class="code-line line-number" line="2"><span class="token comment"># requirepass foobared</span>
</span><span class="code-line line-number" line="3"><span class="token comment"># 更改成下面内容，把 foobared 改为你想要设置的密码</span>
</span><span class="code-line line-number" line="4">requirepass <span class="token number">111111</span>
</span><span class="code-line line-number" line="5">
</span><span class="code-line line-number" line="6"><span class="token comment"># bind 127.0.0.1 去掉 # 注释并改为</span>
</span><span class="code-line line-number" line="7"><span class="token builtin class-name">bind</span> <span class="token number">0.0</span>.0.0
</span></code><input type="hidden" value="# ...
# requirepass foobared
# 更改成下面内容，把 foobared 改为你想要设置的密码
requirepass 111111

# bind 127.0.0.1 去掉 # 注释并改为
bind 0.0.0.0
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>更改为之后你就可以带密码访问redis了。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">redis-cli <span class="token parameter variable">-h</span> <span class="token number">127.0</span>.0.1 <span class="token parameter variable">-p</span> <span class="token number">6379</span> <span class="token parameter variable">-a</span> <span class="token number">111111</span>
</span></code><input type="hidden" value="redis-cli -h 127.0.0.1 -p 6379 -a 111111
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="主从架构配置"><a aria-hidden="true" tabindex="-1" href="#主从架构配置" class="anchor"><span class="icon icon-link"></span></a>主从架构配置</h2>
        <p>假设有两台服务器，一台做主，一台做从</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">Redis 主信息：
</span><span class="code-line line-number" line="2">  IP：12.168.1.114
</span><span class="code-line line-number" line="3">  端口：6379
</span><span class="code-line line-number" line="4">Redis 从信息：
</span><span class="code-line line-number" line="5">  IP：12.168.1.115
</span><span class="code-line line-number" line="6">  端口：6379
</span></code><input type="hidden" value="Redis 主信息：
  IP：12.168.1.114
  端口：6379
Redis 从信息：
  IP：12.168.1.115
  端口：6379
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>编辑从机的 Redis 配置文件，找到 <code># slaveof</code>开头的这一行应该是注释的：<code># slaveof &#x3C;masterip> &#x3C;masterport></code>我们需要去掉该注释，并且填写我们自己的主机的 IP 和 端口，比如：<code>slaveof 192.168.1.114 6379</code>。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># slaveof &#x3C;自己的主机的 IP> &#x3C;自己的主机的 端口></span>
</span><span class="code-line line-number" line="2"><span class="token comment"># 这行更改成下面内容</span>
</span><span class="code-line line-number" line="3">slaveof <span class="token number">192.168</span>.1.114 <span class="token number">6379</span>
</span></code><input type="hidden" value="# slaveof <自己的主机的 IP> <自己的主机的 端口>
# 这行更改成下面内容
slaveof 192.168.1.114 6379
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>配置完成后重启从机 Redis 服务重启完之后，进入主机的 redis-cli 状态下，输入：<code>INFO replication</code> 可以查询到当前主机的 redis 处于什么角色，有哪些从机已经连上主机。</p>
        <p>此时已经完成了主从配置，我们可以测试下：</p>
        <ol>
          <li>我们进入主机的 redis-cli 状态，然后 set 某个值，比如：set mygithub jaywcjlove</li>
          <li>我们切换进入从机的 redis-cli 的状态下，获取刚刚设置的值看是否存在：get mygithub，此时，我们可以发现是可以获取到值的。</li>
          <li>但是有一个需要注意的：从库不具备写入数据能力，不然会报错。 从库只有只读能力。</li>
        </ol>
        <h2 id="基本操作"><a aria-hidden="true" tabindex="-1" href="#基本操作" class="anchor"><span class="icon icon-link"></span></a>基本操作</h2>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment">## 命令行客户端启动</span>
</span><span class="code-line line-number" line="2">$ redis-cli
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4"><span class="token comment"># 测试心跳</span>
</span><span class="code-line line-number" line="5"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token function">ping</span>
</span><span class="code-line line-number" line="6">PONG
</span><span class="code-line line-number" line="7">
</span><span class="code-line line-number" line="8"><span class="token comment"># 设置 mykey 键的值</span>
</span><span class="code-line line-number" line="9"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">set</span> mykey hello
</span><span class="code-line line-number" line="10">OK
</span><span class="code-line line-number" line="11">
</span><span class="code-line line-number" line="12"><span class="token comment"># 获取 mykey 键的值</span>
</span><span class="code-line line-number" line="13"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> get mykey
</span><span class="code-line line-number" line="14"><span class="token string">"hello"</span>
</span><span class="code-line line-number" line="15">
</span><span class="code-line line-number" line="16"><span class="token comment">## 设置 mykey 失效事件</span>
</span><span class="code-line line-number" line="17"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> expire mykey <span class="token number">2</span>
</span><span class="code-line line-number" line="18">
</span><span class="code-line line-number" line="19">
</span><span class="code-line line-number" line="20"><span class="token comment"># 查看当前redis的配置信息</span>
</span><span class="code-line line-number" line="21"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> config get *
</span><span class="code-line line-number" line="22">
</span><span class="code-line line-number" line="23"><span class="token comment"># 获取所有的key</span>
</span><span class="code-line line-number" line="24"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> keys *
</span><span class="code-line line-number" line="25">
</span><span class="code-line line-number" line="26"><span class="token comment"># 删除redis当前数据库中的所有Key</span>
</span><span class="code-line line-number" line="27"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> flushdb
</span><span class="code-line line-number" line="28">
</span><span class="code-line line-number" line="29"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> config get <span class="token function">dir</span>
</span><span class="code-line line-number" line="30">
</span><span class="code-line line-number" line="31"><span class="token comment"># 馋哭当前库 key 的数量</span>
</span><span class="code-line line-number" line="32"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> dbsize
</span><span class="code-line line-number" line="33">
</span><span class="code-line line-number" line="34"><span class="token comment"># 删除所有数据库中的key</span>
</span><span class="code-line line-number" line="35"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> flushall
</span><span class="code-line line-number" line="36">
</span><span class="code-line line-number" line="37"><span class="token comment"># 退出</span>
</span><span class="code-line line-number" line="38"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">exit</span>
</span><span class="code-line line-number" line="39">
</span><span class="code-line line-number" line="40">
</span><span class="code-line line-number" line="41"><span class="token comment"># 找出拖慢 Redis 的罪魁祸首</span>
</span><span class="code-line line-number" line="42"><span class="token comment"># 通过这个工具可以查看所有命令统计的快照，</span>
</span><span class="code-line line-number" line="43"><span class="token comment"># 比如命令执行了多少次，</span>
</span><span class="code-line line-number" line="44"><span class="token comment"># 执行命令所耗费的毫秒数(每个命令的总时间和平均时间)</span>
</span><span class="code-line line-number" line="45"><span class="token comment"># 只需要简单地执行 CONFIG RESETSTAT 命令就可以重置，这样你就可以得到一个全新的统计结果。</span>
</span><span class="code-line line-number" line="46">
</span><span class="code-line line-number" line="47"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> commandstats
</span><span class="code-line line-number" line="48">cmdstat_get:calls<span class="token operator">=</span><span class="token number">78</span>,usec<span class="token operator">=</span><span class="token number">608</span>,usec_per_call<span class="token operator">=</span><span class="token number">7.79</span>
</span><span class="code-line line-number" line="49">cmdstat_setex:calls<span class="token operator">=</span><span class="token number">5</span>,usec<span class="token operator">=</span><span class="token number">71</span>,usec_per_call<span class="token operator">=</span><span class="token number">14.20</span>
</span><span class="code-line line-number" line="50">cmdstat_keys:calls<span class="token operator">=</span><span class="token number">2</span>,usec<span class="token operator">=</span><span class="token number">42</span>,usec_per_call<span class="token operator">=</span><span class="token number">21.00</span>
</span><span class="code-line line-number" line="51">cmdstat_info:calls<span class="token operator">=</span><span class="token number">10</span>,usec<span class="token operator">=</span><span class="token number">1931</span>,usec_per_call<span class="token operator">=</span><span class="token number">193.10</span>
</span></code><input type="hidden" value="## 命令行客户端启动
$ redis-cli

# 测试心跳
127.0.0.1:6379> ping
PONG

# 设置 mykey 键的值
127.0.0.1:6379> set mykey hello
OK

# 获取 mykey 键的值
127.0.0.1:6379> get mykey
&#x22;hello&#x22;

## 设置 mykey 失效事件
127.0.0.1:6379> expire mykey 2


# 查看当前redis的配置信息
127.0.0.1:6379> config get *

# 获取所有的key
127.0.0.1:6379> keys *

# 删除redis当前数据库中的所有Key
127.0.0.1:6379> flushdb

127.0.0.1:6379> config get dir

# 馋哭当前库 key 的数量
127.0.0.1:6379> dbsize

# 删除所有数据库中的key
127.0.0.1:6379> flushall

# 退出
127.0.0.1:6379> exit


# 找出拖慢 Redis 的罪魁祸首
# 通过这个工具可以查看所有命令统计的快照，
# 比如命令执行了多少次，
# 执行命令所耗费的毫秒数(每个命令的总时间和平均时间)
# 只需要简单地执行 CONFIG RESETSTAT 命令就可以重置，这样你就可以得到一个全新的统计结果。

127.0.0.1:6379> commandstats
cmdstat_get:calls=78,usec=608,usec_per_call=7.79
cmdstat_setex:calls=5,usec=71,usec_per_call=14.20
cmdstat_keys:calls=2,usec=42,usec_per_call=21.00
cmdstat_info:calls=10,usec=1931,usec_per_call=193.10
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="支持的数据类型"><a aria-hidden="true" tabindex="-1" href="#支持的数据类型" class="anchor"><span class="icon icon-link"></span></a>支持的数据类型</h2>
        <h3 id="字符串"><a aria-hidden="true" tabindex="-1" href="#字符串" class="anchor"><span class="icon icon-link"></span></a>字符串</h3>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># 启动客户端 ,存储字符串到redis.</span>
</span><span class="code-line line-number" line="2">redis<span class="token operator">></span> SET name forezp
</span><span class="code-line line-number" line="3">OK
</span><span class="code-line line-number" line="4"><span class="token comment"># 取字符串:</span>
</span><span class="code-line line-number" line="5">redis<span class="token operator">></span> get name 
</span><span class="code-line line-number" line="6"><span class="token string">"forezp"</span>
</span></code><input type="hidden" value="# 启动客户端 ,存储字符串到redis.
redis> SET name forezp
OK
# 取字符串:
redis> get name 
&#x22;forezp&#x22;
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h3 id="hashes---哈希值"><a aria-hidden="true" tabindex="-1" href="#hashes---哈希值" class="anchor"><span class="icon icon-link"></span></a>Hashes - 哈希值</h3>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">redis <span class="token operator">></span> HMSET king username forezp password xxdxx age <span class="token number">22</span>
</span><span class="code-line line-number" line="2">redis <span class="token operator">></span> HGETALL king
</span><span class="code-line line-number" line="3"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"username"</span>
</span><span class="code-line line-number" line="4"><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"forezp "</span>
</span><span class="code-line line-number" line="5"><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"password "</span>
</span><span class="code-line line-number" line="6"><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"xxdxx "</span>
</span><span class="code-line line-number" line="7"><span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"age "</span>
</span><span class="code-line line-number" line="8"><span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">"22"</span>
</span></code><input type="hidden" value="redis > HMSET king username forezp password xxdxx age 22
redis > HGETALL king
1) &#x22;username&#x22;
2) &#x22;forezp &#x22;
3) &#x22;password &#x22;
4) &#x22;xxdxx &#x22;
5) &#x22;age &#x22;
6) &#x22;22&#x22;
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h3 id="lists---列表"><a aria-hidden="true" tabindex="-1" href="#lists---列表" class="anchor"><span class="icon icon-link"></span></a>Lists - 列表</h3>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">redis<span class="token operator">></span> lpush pricess kenny
</span><span class="code-line line-number" line="2"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
</span><span class="code-line line-number" line="3">redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lpush pricess jolin
</span><span class="code-line line-number" line="4"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span>
</span><span class="code-line line-number" line="5">redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lpush pricess mayun
</span><span class="code-line line-number" line="6"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
</span><span class="code-line line-number" line="7">redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lrange pricess <span class="token number">0</span> <span class="token number">10</span>
</span><span class="code-line line-number" line="8"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"kenny"</span>
</span><span class="code-line line-number" line="9"><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"jolin"</span>
</span><span class="code-line line-number" line="10"><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"mayun"</span>
</span></code><input type="hidden" value="redis> lpush pricess kenny
(integer) 1
redis 127.0.0.1:6379> lpush pricess jolin
(integer) 2
redis 127.0.0.1:6379> lpush pricess mayun
(integer) 3
redis 127.0.0.1:6379> lrange pricess 0 10
1) &#x22;kenny&#x22;
2) &#x22;jolin&#x22;
3) &#x22;mayun&#x22;
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h3 id="有序集合"><a aria-hidden="true" tabindex="-1" href="#有序集合" class="anchor"><span class="icon icon-link"></span></a>有序集合</h3>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">redis <span class="token operator">></span> ZADD kindom <span class="token number">1</span> redis
</span><span class="code-line line-number" line="2"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
</span><span class="code-line line-number" line="3">redis<span class="token operator">></span> ZADD kindom <span class="token number">2</span> mongodb
</span><span class="code-line line-number" line="4"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
</span><span class="code-line line-number" line="5">redis <span class="token operator">></span> ZADD kindom <span class="token number">3</span> mysql
</span><span class="code-line line-number" line="6"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
</span><span class="code-line line-number" line="7">redis <span class="token operator">></span> ZADD kindom <span class="token number">3</span> mysql
</span><span class="code-line line-number" line="8"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
</span><span class="code-line line-number" line="9">redis <span class="token operator">></span> ZADD kindom <span class="token number">4</span> mysql
</span><span class="code-line line-number" line="10"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
</span><span class="code-line line-number" line="11">redis <span class="token operator">></span> ZRANGE kindom <span class="token number">0</span> <span class="token number">10</span> WITHSCORES
</span><span class="code-line line-number" line="12"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"redis"</span>
</span><span class="code-line line-number" line="13"><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"1"</span>
</span><span class="code-line line-number" line="14"><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"mongodb"</span>
</span><span class="code-line line-number" line="15"><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"2"</span>
</span><span class="code-line line-number" line="16"><span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"mysql"</span>
</span><span class="code-line line-number" line="17"><span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">"4"</span>
</span></code><input type="hidden" value="redis > ZADD kindom 1 redis
(integer) 1
redis> ZADD kindom 2 mongodb
(integer) 1
redis > ZADD kindom 3 mysql
(integer) 1
redis > ZADD kindom 3 mysql
(integer) 0
redis > ZADD kindom 4 mysql
(integer) 0
redis > ZRANGE kindom 0 10 WITHSCORES
1) &#x22;redis&#x22;
2) &#x22;1&#x22;
3) &#x22;mongodb&#x22;
4) &#x22;2&#x22;
5) &#x22;mysql&#x22;
6) &#x22;4&#x22;
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="开启通知"><a aria-hidden="true" tabindex="-1" href="#开启通知" class="anchor"><span class="icon icon-link"></span></a>开启通知</h2>
        <p>键空间事件通知默认被禁用，因为这个特性消耗CPU电量不是很明智。使用<code>redis.conf</code>的<code>notify-keyspace-events</code>，或者通过<code>CONFIG SET</code>来开启通知。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment">## 设置配置开启通知功能</span>
</span><span class="code-line line-number" line="2">$ redis-cli config <span class="token builtin class-name">set</span> notify-keyspace-events KEA
</span><span class="code-line line-number" line="3"><span class="token comment">## 命令行监控所有通知</span>
</span><span class="code-line line-number" line="4">$ redis-cli <span class="token parameter variable">--csv</span> psubscribe <span class="token string">'__key*__:*'</span>
</span><span class="code-line line-number" line="5">Reading messages<span class="token punctuation">..</span>. <span class="token punctuation">(</span>press Ctrl-C to quit<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="6"><span class="token string">"psubscribe"</span>,<span class="token string">"__key*__:*"</span>,1
</span></code><input type="hidden" value="## 设置配置开启通知功能
$ redis-cli config set notify-keyspace-events KEA
## 命令行监控所有通知
$ redis-cli --csv psubscribe &#x27;__key*__:*&#x27;
Reading messages... (press Ctrl-C to quit)
&#x22;psubscribe&#x22;,&#x22;__key*__:*&#x22;,1
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>键值说明</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">K     Keyspace events, published with __keyspace@<span class="token operator">&#x3C;</span>db<span class="token operator">></span>__ prefix.  
</span><span class="code-line line-number" line="2">E     Keyevent events, published with __keyevent@<span class="token operator">&#x3C;</span>db<span class="token operator">></span>__ prefix.  
</span><span class="code-line line-number" line="3">g     Generic commands <span class="token punctuation">(</span>non-type specific<span class="token punctuation">)</span> like DEL, EXPIRE, RENAME, <span class="token punctuation">..</span>.  
</span><span class="code-line line-number" line="4">$     String commands  
</span><span class="code-line line-number" line="5">l     List commands  
</span><span class="code-line line-number" line="6">s     Set commands  
</span><span class="code-line line-number" line="7">h     Hash commands  
</span><span class="code-line line-number" line="8">z     Sorted <span class="token builtin class-name">set</span> commands  
</span><span class="code-line line-number" line="9">x     Expired events <span class="token punctuation">(</span>events generated every <span class="token function">time</span> a key expires<span class="token punctuation">)</span>  
</span><span class="code-line line-number" line="10">e     Evicted events <span class="token punctuation">(</span>events generated when a key is evicted <span class="token keyword">for</span> maxmemory<span class="token punctuation">)</span>  
</span><span class="code-line line-number" line="11">A     Alias <span class="token keyword">for</span> g<span class="token variable">$lshzxe</span>, so that the <span class="token string">"AKE"</span> string means all the events. 
</span></code><input type="hidden" value="K     Keyspace events, published with __keyspace@<db>__ prefix.  
E     Keyevent events, published with __keyevent@<db>__ prefix.  
g     Generic commands (non-type specific) like DEL, EXPIRE, RENAME, ...  
$     String commands  
l     List commands  
s     Set commands  
h     Hash commands  
z     Sorted set commands  
x     Expired events (events generated every time a key expires)  
e     Evicted events (events generated when a key is evicted for maxmemory)  
A     Alias for g$lshzxe, so that the &#x22;AKE&#x22; string means all the events. 
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>不同命令产生的事件(Events generated by different commands)</p>
        <p>按照下面的清单，不同的命令产生不同类型的事件。 <a href="http://redis.io/topics/notifications">Redis Keyspace Notifications</a></p>
        <ul>
          <li>DEL 为每一个被删除的键产生一个del事件。</li>
          <li>RENAME 产生两个事件，为源键产生一个rename_from事件，为目标键产生一个rename_to事件。</li>
          <li>EXPIRE 当为键设置过期时产生一个expire事件，或者每当设置了过期的键被删除时产生一个expired事件(查看EXPIRE文档获取更多信息)。</li>
          <li>SORT 当STORE用于设置一个新键时产生一个sortstore事件。当结果列表为空，并且使用了STORE选项，并且已经有一个该名字的键存在，那么这个件键被删除，所以这种条件下或产生一个del事件。</li>
          <li>SET及其所有变种(SETEX, SETNX,GETSET) 产生set事件。但是SETEX还会产生一个expire事件。</li>
          <li>MSET 为每个键产生一个单独的set事件。</li>
          <li>SETRANGE 产生一个setrange事件。</li>
          <li>INCR, DECR, INCRBY, DECRBY 都产生incrby事件。</li>
          <li>INCRBYFLOAT 产生一个incrbyfloat事件。</li>
          <li>APPEND 产生一个append事件。</li>
          <li>LPUSH和LPUSHX 产生单个lpush事件，即使在可变情况下(even in the variadic case)。</li>
          <li>RPUSH和RPUSHX 产生单个rpush事件，即使在可变情况下(even in the variadic case)。</li>
          <li>RPOP 产生一个rpop事件。如果键由于最后一个元素被从列表中弹出而导致删除，会又产生一个del事件。</li>
          <li>LPOP 产生一个lpop事件。如果键由于最后一个元素被从列表中弹出而导致删除，会又产生一个del事件。</li>
          <li>LINSERT 产生一个linsert事件。</li>
          <li>LSET 产生一个lset事件。</li>
          <li>LREM 产生一个lrem事件。如果结果列表为空并且键被删除，会又产生一个del事件。</li>
          <li>LTRIM 产生一个ltrim事件。如果结果列表为空并且键被删除，会又产生一个del事件。</li>
          <li>RPOPLPUSH和BRPOPLPUSH 产生一个rpop事件和一个lpush事件。两种情况下顺序都能保证 (lpush事件总是在rpop事件之后被传递) 如果结果列表长度为零并且键被删除，会又产生一个del事件。</li>
          <li>HSET, HSETNX和HMSET 都产生单个hset事件。</li>
          <li>HINCRBY 产生一个hincrby事件。</li>
          <li>HINCRBYFLOAT 产生一个hincrbyfloat事件。</li>
          <li>HDEL 产生单个hdel事件。如果结果哈希为空并且键被删除，会又产生一个del事件。</li>
          <li>SADD 产生单个sadd事件，即使在可变情况下(even in the variadic case)。</li>
          <li>SREM 产生单个srem事件。如果结果集合为空并且键被删除，会又产生一个del事件。</li>
          <li>SMOVE 为源键产生一个srem事件为目标键产生一个sadd事件。</li>
          <li>SPOP 产生一个spop事件。如果结果集合为空并且键被删除，会又产生一个del事件。</li>
          <li>SINTERSTORE, SUNIONSTORE, SDIFFSTORE 分别产生sinterstore，sunionostore，sdiffstore事件。在特殊情况下，集合为空，且存储结果的键已经存在，由于键被删除，会产生一个del事件。</li>
          <li>ZINCR 产生一个zincr事件。</li>
          <li>ZADD产生单个zadd事件，即使添加了多个元素。.</li>
          <li>ZREM 产生单个zrem事件，即使删除了多个元素。当结果有序集合为空，并且键被生成时，会产生一个额外的del事件。</li>
          <li>ZREMBYSCORE 产生单个zrembyscore事件。当结果有序集合为空，并且键被生成时，会产生一个额外的del事件。</li>
          <li>ZREMBYRANK 产生单个zrembyrank事件。当结果有序集合为空，并且键被生成时，会产生一个额外的del事件。</li>
          <li>ZINTERSTORE和ZUNIONSTORE 分别产生zinterstore和zunionstore事件。在特殊情况下，集合为空，且存储结果的键已经存在，由于键被删除，会产生一个del事件。</li>
          <li>每当一个关联有生存事件的键由于过期而被从数据集中删除时会产生一个expired事件。</li>
          <li>每当一个键由于maxmemory策略而从数据集中被淘汰以节省内存时会产生一个evicted事件。</li>
        </ul>
        <h2 id="开启远程登录连接"><a aria-hidden="true" tabindex="-1" href="#开启远程登录连接" class="anchor"><span class="icon icon-link"></span></a>开启远程登录连接</h2>
        <p>使用 netstat 来查看端口占用情况，6379为默认Redis端口。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">netstat</span> -nlt<span class="token operator">|</span><span class="token function">grep</span> <span class="token number">6379</span>
</span></code><input type="hidden" value="netstat -nlt|grep 6379
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <ul>
          <li>-t：指明显示 TCP 端口</li>
          <li>-u：指明显示 UDP 端口</li>
          <li>-l：仅显示监听套接字</li>
          <li>-p：显示进程标识符和程序名称，每一个套接字/端口都属于一个程序。</li>
          <li>-n：不进行 DNS 轮询，显示 IP （可以加速操作）</li>
        </ul>
        <h3 id="修改防火墙配置"><a aria-hidden="true" tabindex="-1" href="#修改防火墙配置" class="anchor"><span class="icon icon-link"></span></a>修改防火墙配置</h3>
        <p>修改防火墙配置 sudo vi /etc/sysconfig/iptables</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-m</span> state <span class="token parameter variable">--state</span> NEW <span class="token parameter variable">-m</span> tcp <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">6379</span> <span class="token parameter variable">-j</span> ACCEPT
</span></code><input type="hidden" value="-A INPUT -m state --state NEW -m tcp -p tcp --dport 6379 -j ACCEPT
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h3 id="修改配置文件"><a aria-hidden="true" tabindex="-1" href="#修改配置文件" class="anchor"><span class="icon icon-link"></span></a>修改配置文件</h3>
        <p>Redis protected-mode 是3.2 之后加入的新特性，在Redis.conf的注释中，我们可以了解到，他的具体作用和启用条件。可以在 sudo vi /etc/redis.conf 中编辑，修改配置文件。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># Protected mode is a layer of security protection, in order to avoid that</span>
</span><span class="code-line line-number" line="2"><span class="token comment"># Redis instances left open on the internet are accessed and exploited.</span>
</span><span class="code-line line-number" line="3"><span class="token comment">#</span>
</span><span class="code-line line-number" line="4"><span class="token comment"># When protected mode is on and if:</span>
</span><span class="code-line line-number" line="5"><span class="token comment">#</span>
</span><span class="code-line line-number" line="6"><span class="token comment"># 1) The server is not binding explicitly to a set of addresses using the</span>
</span><span class="code-line line-number" line="7"><span class="token comment">#    "bind" directive.</span>
</span><span class="code-line line-number" line="8"><span class="token comment"># 2) No password is configured.</span>
</span><span class="code-line line-number" line="9"><span class="token comment">#</span>
</span><span class="code-line line-number" line="10"><span class="token comment"># The server only accepts connections from clients connecting from the</span>
</span><span class="code-line line-number" line="11"><span class="token comment"># IPv4 and IPv6 loopback addresses 127.0.0.1 and ::1, and from Unix domain</span>
</span><span class="code-line line-number" line="12"><span class="token comment"># sockets.</span>
</span><span class="code-line line-number" line="13"><span class="token comment">#</span>
</span><span class="code-line line-number" line="14"><span class="token comment"># By default protected mode is enabled. You should disable it only if</span>
</span><span class="code-line line-number" line="15"><span class="token comment"># you are sure you want clients from other hosts to connect to Redis</span>
</span><span class="code-line line-number" line="16"><span class="token comment"># even if no authentication is configured, nor a specific set of interfaces</span>
</span><span class="code-line line-number" line="17"><span class="token comment"># are explicitly listed using the "bind" directive.</span>
</span><span class="code-line line-number" line="18">protected-mode <span class="token function">yes</span>
</span><span class="code-line line-number" line="19">
</span></code><input type="hidden" value="# Protected mode is a layer of security protection, in order to avoid that
# Redis instances left open on the internet are accessed and exploited.
#
# When protected mode is on and if:
#
# 1) The server is not binding explicitly to a set of addresses using the
#    &#x22;bind&#x22; directive.
# 2) No password is configured.
#
# The server only accepts connections from clients connecting from the
# IPv4 and IPv6 loopback addresses 127.0.0.1 and ::1, and from Unix domain
# sockets.
#
# By default protected mode is enabled. You should disable it only if
# you are sure you want clients from other hosts to connect to Redis
# even if no authentication is configured, nor a specific set of interfaces
# are explicitly listed using the &#x22;bind&#x22; directive.
protected-mode yes

"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>它启用的条件，有两个：</p>
        <ol>
          <li>没有bind IP</li>
          <li>没有设置访问密码</li>
        </ol>
        <p>如果启用了，则只能够通过lookback ip（127.0.0.1）访问Redis cache，如果从外网访问，则会返回相应的错误信息：</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token punctuation">(</span>error<span class="token punctuation">)</span> DENIED Redis is running <span class="token keyword">in</span> protected mode because protected mode is enabled, no <span class="token builtin class-name">bind</span> address was specified, no authentication password is requested to clients. In this mode connections are only accepted from the lookback interface. If you want to connect from external computers to Redis you may adopt one of the following solutions: <span class="token number">1</span><span class="token punctuation">)</span> Just disable protected mode sending the <span class="token builtin class-name">command</span> <span class="token string">'CONFIG SET protected-mode no'</span> from the loopback interface by connecting to Redis from the same <span class="token function">host</span> the server is running, however MAKE SURE Redis is not publicly accessible from internet <span class="token keyword">if</span> you <span class="token keyword">do</span> so. Use CONFIG REWRITE to <span class="token function">make</span> this change permanent. <span class="token number">2</span><span class="token punctuation">)</span> Alternatively you can just disable the protected mode by editing the Redis configuration file, and setting the protected mode option to <span class="token string">'no'</span>, and <span class="token keyword">then</span> restarting the server. <span class="token number">3</span><span class="token punctuation">)</span> If you started the server manually just <span class="token keyword">for</span> testing, restart it with the --portected-mode no option. <span class="token number">4</span><span class="token punctuation">)</span> Setup a <span class="token builtin class-name">bind</span> address or an authentication password. NOTE: You only need to <span class="token keyword">do</span> one of the above things <span class="token keyword">in</span> order <span class="token keyword">for</span> the server to start accepting connections from the outside.
</span></code><input type="hidden" value="(error) DENIED Redis is running in protected mode because protected mode is enabled, no bind address was specified, no authentication password is requested to clients. In this mode connections are only accepted from the lookback interface. If you want to connect from external computers to Redis you may adopt one of the following solutions: 1) Just disable protected mode sending the command &#x27;CONFIG SET protected-mode no&#x27; from the loopback interface by connecting to Redis from the same host the server is running, however MAKE SURE Redis is not publicly accessible from internet if you do so. Use CONFIG REWRITE to make this change permanent. 2) Alternatively you can just disable the protected mode by editing the Redis configuration file, and setting the protected mode option to &#x27;no&#x27;, and then restarting the server. 3) If you started the server manually just for testing, restart it with the --portected-mode no option. 4) Setup a bind address or an authentication password. NOTE: You only need to do one of the above things in order for the server to start accepting connections from the outside.
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="提供的原生监控"><a aria-hidden="true" tabindex="-1" href="#提供的原生监控" class="anchor"><span class="icon icon-link"></span></a>提供的原生监控</h2>
        <h3 id="当前链接的客户端数和连接数"><a aria-hidden="true" tabindex="-1" href="#当前链接的客户端数和连接数" class="anchor"><span class="icon icon-link"></span></a>当前链接的客户端数和连接数</h3>
        <p><code>redis-cli --stat</code>查看当前连接的客户端数，连接数等</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">------- data ------ --------------------- load -------------------- - child -
</span><span class="code-line line-number" line="2">keys       mem      clients blocked requests            connections
</span><span class="code-line line-number" line="3"><span class="token number">4</span>          <span class="token number">1</span>.27M    <span class="token number">6</span>       <span class="token number">0</span>       <span class="token number">17340</span> <span class="token punctuation">(</span>+0<span class="token punctuation">)</span>          <span class="token number">111</span>
</span><span class="code-line line-number" line="4"><span class="token number">4</span>          <span class="token number">1</span>.27M    <span class="token number">6</span>       <span class="token number">0</span>       <span class="token number">17341</span> <span class="token punctuation">(</span>+1<span class="token punctuation">)</span>          <span class="token number">111</span>
</span><span class="code-line line-number" line="5"><span class="token number">4</span>          <span class="token number">1</span>.27M    <span class="token number">6</span>       <span class="token number">0</span>       <span class="token number">17342</span> <span class="token punctuation">(</span>+1<span class="token punctuation">)</span>          <span class="token number">111</span>
</span><span class="code-line line-number" line="6"><span class="token number">4</span>          <span class="token number">1</span>.27M    <span class="token number">6</span>       <span class="token number">0</span>       <span class="token number">17343</span> <span class="token punctuation">(</span>+1<span class="token punctuation">)</span>          <span class="token number">111</span>
</span></code><input type="hidden" value="------- data ------ --------------------- load -------------------- - child -
keys       mem      clients blocked requests            connections
4          1.27M    6       0       17340 (+0)          111
4          1.27M    6       0       17341 (+1)          111
4          1.27M    6       0       17342 (+1)          111
4          1.27M    6       0       17343 (+1)          111
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h3 id="内存最大的键值和平均的键值数据"><a aria-hidden="true" tabindex="-1" href="#内存最大的键值和平均的键值数据" class="anchor"><span class="icon icon-link"></span></a>内存最大的键值和平均的键值数据</h3>
        <p><code>redis-cli --bigkeys</code> 对当前占用内存最大的键值和平均的键值数据，也可以通过指定<code>-i</code>参数定时查看当前的视图情况。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># Scanning the entire keyspace to find biggest keys as well as</span>
</span><span class="code-line line-number" line="2"><span class="token comment"># average sizes per key type.  You can use -i 0.1 to sleep 0.1 sec</span>
</span><span class="code-line line-number" line="3"><span class="token comment"># per 100 SCAN commands (not usually needed).</span>
</span><span class="code-line line-number" line="4">
</span><span class="code-line line-number" line="5"><span class="token punctuation">[</span>00.00%<span class="token punctuation">]</span> Biggest string found so far <span class="token string">'asdf.js'</span> with <span class="token number">3</span> bytes
</span><span class="code-line line-number" line="6"><span class="token punctuation">[</span>00.00%<span class="token punctuation">]</span> Biggest string found so far <span class="token string">'wabg-tokeneyJhbGciOiJIUzI1NiJ9.NA.UGGRiB2I42rP-33cIMrcoPub7AzHgDlqHacAKFw1pfE'</span> with <span class="token number">328</span> bytes
</span><span class="code-line line-number" line="7"><span class="token punctuation">[</span>00.00%<span class="token punctuation">]</span> Biggest string found so far <span class="token string">'wabg-token-province'</span> with <span class="token number">231042</span> bytes
</span><span class="code-line line-number" line="8">
</span><span class="code-line line-number" line="9">-------- summary -------
</span><span class="code-line line-number" line="10">
</span><span class="code-line line-number" line="11">Sampled <span class="token number">4</span> keys <span class="token keyword">in</span> the keyspace<span class="token operator">!</span>
</span><span class="code-line line-number" line="12">Total key length <span class="token keyword">in</span> bytes is <span class="token number">180</span> <span class="token punctuation">(</span>avg len <span class="token number">45.00</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="13">
</span><span class="code-line line-number" line="14">Biggest string found <span class="token string">'wabg-token-province'</span> has <span class="token number">231042</span> bytes
</span><span class="code-line line-number" line="15">
</span><span class="code-line line-number" line="16"><span class="token number">4</span> strings with <span class="token number">231819</span> bytes <span class="token punctuation">(</span><span class="token number">100.00</span>% of keys, avg size <span class="token number">57954.75</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="17"><span class="token number">0</span> lists with <span class="token number">0</span> items <span class="token punctuation">(</span>00.00% of keys, avg size <span class="token number">0.00</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="18"><span class="token number">0</span> sets with <span class="token number">0</span> members <span class="token punctuation">(</span>00.00% of keys, avg size <span class="token number">0.00</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="19"><span class="token number">0</span> hashs with <span class="token number">0</span> fields <span class="token punctuation">(</span>00.00% of keys, avg size <span class="token number">0.00</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="20"><span class="token number">0</span> zsets with <span class="token number">0</span> members <span class="token punctuation">(</span>00.00% of keys, avg size <span class="token number">0.00</span><span class="token punctuation">)</span>
</span></code><input type="hidden" value="# Scanning the entire keyspace to find biggest keys as well as
# average sizes per key type.  You can use -i 0.1 to sleep 0.1 sec
# per 100 SCAN commands (not usually needed).

[00.00%] Biggest string found so far &#x27;asdf.js&#x27; with 3 bytes
[00.00%] Biggest string found so far &#x27;wabg-tokeneyJhbGciOiJIUzI1NiJ9.NA.UGGRiB2I42rP-33cIMrcoPub7AzHgDlqHacAKFw1pfE&#x27; with 328 bytes
[00.00%] Biggest string found so far &#x27;wabg-token-province&#x27; with 231042 bytes

-------- summary -------

Sampled 4 keys in the keyspace!
Total key length in bytes is 180 (avg len 45.00)

Biggest string found &#x27;wabg-token-province&#x27; has 231042 bytes

4 strings with 231819 bytes (100.00% of keys, avg size 57954.75)
0 lists with 0 items (00.00% of keys, avg size 0.00)
0 sets with 0 members (00.00% of keys, avg size 0.00)
0 hashs with 0 fields (00.00% of keys, avg size 0.00)
0 zsets with 0 members (00.00% of keys, avg size 0.00)
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h3 id="查看当前的键值情况"><a aria-hidden="true" tabindex="-1" href="#查看当前的键值情况" class="anchor"><span class="icon icon-link"></span></a>查看当前的键值情况</h3>
        <p><code>redis-cli --scan</code>提供和<code>keys *</code>相似的功能，查看当前的键值情况，可以通过正则表达</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">$ redis-cli <span class="token parameter variable">--scan</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3">sess:K4xh-bxOBrcXpy9kEW87oiy-u7I2sAA5
</span><span class="code-line line-number" line="4">asdf.js
</span><span class="code-line line-number" line="5">sess:1tGNZSXW8GyoEQsbtpqkA5tMmSFp_ZIn
</span><span class="code-line line-number" line="6">wabg-tokeneyJhbGciOiJIUzI1NiJ9.NA.UGGRiB2I42rP-33cIMrcoPub7AzHgDlqHacAKFw1pfE
</span><span class="code-line line-number" line="7">sess:3e4NGIJd0wf1-RONeTt-FsXQj4EaVNjk
</span><span class="code-line line-number" line="8">wabg-token-province
</span><span class="code-line line-number" line="9">sess:UuCLAX2sWZ50fiIO1qvDgulf0XIZRd98
</span><span class="code-line line-number" line="10">wabg-tokeneyJhbGciOiJIUzI1NiJ9.MQ.6z44GClzAsUED1M_UyxqdREdDKcYFnL9tSqd5ZhLhsY
</span><span class="code-line line-number" line="11">sess:2HEchaRLYUoaa44IF1bB6mpik7lZjBb4
</span></code><input type="hidden" value="$ redis-cli --scan

sess:K4xh-bxOBrcXpy9kEW87oiy-u7I2sAA5
asdf.js
sess:1tGNZSXW8GyoEQsbtpqkA5tMmSFp_ZIn
wabg-tokeneyJhbGciOiJIUzI1NiJ9.NA.UGGRiB2I42rP-33cIMrcoPub7AzHgDlqHacAKFw1pfE
sess:3e4NGIJd0wf1-RONeTt-FsXQj4EaVNjk
wabg-token-province
sess:UuCLAX2sWZ50fiIO1qvDgulf0XIZRd98
wabg-tokeneyJhbGciOiJIUzI1NiJ9.MQ.6z44GClzAsUED1M_UyxqdREdDKcYFnL9tSqd5ZhLhsY
sess:2HEchaRLYUoaa44IF1bB6mpik7lZjBb4
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h3 id="原生的monitor监控"><a aria-hidden="true" tabindex="-1" href="#原生的monitor监控" class="anchor"><span class="icon icon-link"></span></a>原生的Monitor监控</h3>
        <p>redis-cli monitor打印出所有sever接收到的命令以及其对应的客户端地址</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">$ redis-cli monitor
</span><span class="code-line line-number" line="2">OK
</span><span class="code-line line-number" line="3"><span class="token number">1472626566.218175</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">127.0</span>.0.1:62862<span class="token punctuation">]</span> <span class="token string">"info"</span>
</span><span class="code-line line-number" line="4"><span class="token number">1472626571.220948</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">127.0</span>.0.1:62862<span class="token punctuation">]</span> <span class="token string">"exists"</span> <span class="token string">"aaa"</span>
</span><span class="code-line line-number" line="5"><span class="token number">1472626571.223174</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">127.0</span>.0.1:62862<span class="token punctuation">]</span> <span class="token string">"set"</span> <span class="token string">"aaa"</span> <span class="token string">""</span>
</span><span class="code-line line-number" line="6"><span class="token number">1472626571.232126</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">127.0</span>.0.1:62862<span class="token punctuation">]</span> <span class="token string">"type"</span> <span class="token string">"aaa"</span>
</span><span class="code-line line-number" line="7"><span class="token number">1472626571.243697</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">127.0</span>.0.1:62862<span class="token punctuation">]</span> <span class="token string">"pttl"</span> <span class="token string">"aaa"</span>
</span><span class="code-line line-number" line="8"><span class="token number">1472626571.243717</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">127.0</span>.0.1:62862<span class="token punctuation">]</span> <span class="token string">"object"</span> <span class="token string">"ENCODING"</span> <span class="token string">"aaa"</span>
</span><span class="code-line line-number" line="9"><span class="token number">1472626571.243726</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">127.0</span>.0.1:62862<span class="token punctuation">]</span> <span class="token string">"strlen"</span> <span class="token string">"aaa"</span>
</span></code><input type="hidden" value="$ redis-cli monitor
OK
1472626566.218175 [0 127.0.0.1:62862] &#x22;info&#x22;
1472626571.220948 [0 127.0.0.1:62862] &#x22;exists&#x22; &#x22;aaa&#x22;
1472626571.223174 [0 127.0.0.1:62862] &#x22;set&#x22; &#x22;aaa&#x22; &#x22;&#x22;
1472626571.232126 [0 127.0.0.1:62862] &#x22;type&#x22; &#x22;aaa&#x22;
1472626571.243697 [0 127.0.0.1:62862] &#x22;pttl&#x22; &#x22;aaa&#x22;
1472626571.243717 [0 127.0.0.1:62862] &#x22;object&#x22; &#x22;ENCODING&#x22; &#x22;aaa&#x22;
1472626571.243726 [0 127.0.0.1:62862] &#x22;strlen&#x22; &#x22;aaa&#x22;
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="配置说明"><a aria-hidden="true" tabindex="-1" href="#配置说明" class="anchor"><span class="icon icon-link"></span></a>配置说明</h2>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment">#redis.conf</span>
</span><span class="code-line line-number" line="2"><span class="token comment"># Redis configuration file example.</span>
</span><span class="code-line line-number" line="3"><span class="token comment"># ./redis-server /path/to/redis.conf</span>
</span><span class="code-line line-number" line="4">
</span><span class="code-line line-number" line="5"><span class="token comment">################################## INCLUDES ###################################</span>
</span><span class="code-line line-number" line="6"><span class="token comment">#这在你有标准配置模板但是每个redis服务器又需要个性设置的时候很有用。</span>
</span><span class="code-line line-number" line="7"><span class="token comment"># include /path/to/local.conf</span>
</span><span class="code-line line-number" line="8"><span class="token comment"># include /path/to/other.conf</span>
</span><span class="code-line line-number" line="9">
</span><span class="code-line line-number" line="10"><span class="token comment">################################ GENERAL #####################################</span>
</span><span class="code-line line-number" line="11">
</span><span class="code-line line-number" line="12"><span class="token comment"># 是否在后台执行，yes：后台运行；no：不是后台运行（老版本默认）</span>
</span><span class="code-line line-number" line="13">daemonize <span class="token function">yes</span>
</span><span class="code-line line-number" line="14">
</span><span class="code-line line-number" line="15"><span class="token comment"># 3.2里的参数，是否开启保护模式，默认开启。要是配置里没有指定bind和密码。</span>
</span><span class="code-line line-number" line="16"><span class="token comment"># 开启该参数后，redis只会本地进行访问，拒绝外部访问。</span>
</span><span class="code-line line-number" line="17"><span class="token comment"># 要是开启了密码   和bind，可以开启。否   则最好关闭，设置为no。</span>
</span><span class="code-line line-number" line="18">
</span><span class="code-line line-number" line="19">protected-mode <span class="token function">yes</span>
</span><span class="code-line line-number" line="20"><span class="token comment"># redis的进程文件</span>
</span><span class="code-line line-number" line="21">pidfile /var/run/redis/redis-server.pid
</span><span class="code-line line-number" line="22">
</span><span class="code-line line-number" line="23"><span class="token comment"># redis监听的端口号。</span>
</span><span class="code-line line-number" line="24">port <span class="token number">6379</span>
</span><span class="code-line line-number" line="25">
</span><span class="code-line line-number" line="26"><span class="token comment"># 此参数确定了TCP连接中已完成队列(完成三次握手之后)的长度， </span>
</span><span class="code-line line-number" line="27"><span class="token comment"># 当然此值必须不大于Linux系统定义的/proc/sys/net/core/somaxconn值，默认是511，</span>
</span><span class="code-line line-number" line="28"><span class="token comment"># 而Linux的默认参数值是128。当系统并发量大并且客户端速度缓慢的时候，</span>
</span><span class="code-line line-number" line="29"><span class="token comment"># 可以将这二个参数一起参考设定。该内核参数默认值一般是128，对于负载很大的服务程序来说大大的不够。</span>
</span><span class="code-line line-number" line="30"><span class="token comment"># 一般会将它修改为2048或者更大。在/etc/sysctl.conf中添加:net.core.somaxconn = 2048，然后在终端中执行sysctl -p。</span>
</span><span class="code-line line-number" line="31">tcp-backlog <span class="token number">511</span>
</span><span class="code-line line-number" line="32">
</span><span class="code-line line-number" line="33"><span class="token comment">#指定 redis 只接收来自于该 IP 地址的请求，如果不进行设置，那么将处理所有请求</span>
</span><span class="code-line line-number" line="34"><span class="token builtin class-name">bind</span> <span class="token number">127.0</span>.0.1
</span><span class="code-line line-number" line="35">
</span><span class="code-line line-number" line="36"><span class="token comment"># 配置unix socket来让redis支持监听本地连接。</span>
</span><span class="code-line line-number" line="37"><span class="token comment"># unixsocket /var/run/redis/redis.sock</span>
</span><span class="code-line line-number" line="38"><span class="token comment"># 配置unix socket使用文件的权限</span>
</span><span class="code-line line-number" line="39"><span class="token comment"># unixsocketperm 700</span>
</span><span class="code-line line-number" line="40">
</span><span class="code-line line-number" line="41"><span class="token comment"># 此参数为设置客户端空闲超过timeout，服务端会断开连接，为0则服务端不会主动断开连接，不能小于0。</span>
</span><span class="code-line line-number" line="42"><span class="token function">timeout</span> <span class="token number">0</span>
</span><span class="code-line line-number" line="43">
</span><span class="code-line line-number" line="44"><span class="token comment"># tcp keepalive参数。如果设置不为0，就使用配置tcp的SO_KEEPALIVE值，</span>
</span><span class="code-line line-number" line="45"><span class="token comment"># 使用keepalive有两个好处:检测挂掉的对端。降低中间设备出问题而导致网络看似连接却已经与对端端口的问题。</span>
</span><span class="code-line line-number" line="46"><span class="token comment"># 在Linux内核中，设置了keepalive，redis会定时给对端发送ack。检测到对端关闭需要两倍的设置值。</span>
</span><span class="code-line line-number" line="47">tcp-keepalive <span class="token number">0</span>
</span><span class="code-line line-number" line="48">
</span><span class="code-line line-number" line="49"><span class="token comment"># 指定了服务端日志的级别。级别包括：debug（很多信息，方便开发、测试），</span>
</span><span class="code-line line-number" line="50"><span class="token comment"># verbose（许多有用的信息，但是没有debug级别信息多），notice（适当的日志级别，适合生产环境），warn（只有非常重要的信息）</span>
</span><span class="code-line line-number" line="51">loglevel notice
</span><span class="code-line line-number" line="52">
</span><span class="code-line line-number" line="53"><span class="token comment">#指定了记录日志的文件。空字符串的话，日志会打印到标准输出设备。后台运行的redis标准输出是/dev/null。</span>
</span><span class="code-line line-number" line="54">logfile /var/log/redis/redis-server.log
</span><span class="code-line line-number" line="55">
</span><span class="code-line line-number" line="56"><span class="token comment"># 是否打开记录syslog功能</span>
</span><span class="code-line line-number" line="57"><span class="token comment"># syslog-enabled no</span>
</span><span class="code-line line-number" line="58">
</span><span class="code-line line-number" line="59"><span class="token comment"># syslog的标识符。</span>
</span><span class="code-line line-number" line="60"><span class="token comment"># syslog-ident redis</span>
</span><span class="code-line line-number" line="61">
</span><span class="code-line line-number" line="62"><span class="token comment"># 日志的来源、设备</span>
</span><span class="code-line line-number" line="63"><span class="token comment"># syslog-facility local0</span>
</span><span class="code-line line-number" line="64">
</span><span class="code-line line-number" line="65"><span class="token comment"># 数据库的数量，默认使用的数据库是DB 0。可以通过”SELECT “命令选择一个db</span>
</span><span class="code-line line-number" line="66">databases <span class="token number">16</span>
</span><span class="code-line line-number" line="67">
</span><span class="code-line line-number" line="68"><span class="token comment">################################ SNAPSHOTTING ################################</span>
</span><span class="code-line line-number" line="69"><span class="token comment"># 快照配置</span>
</span><span class="code-line line-number" line="70"><span class="token comment"># 注释掉“save”这一行配置项就可以让保存数据库功能失效</span>
</span><span class="code-line line-number" line="71"><span class="token comment"># 设置sedis进行数据库镜像的频率。</span>
</span><span class="code-line line-number" line="72"><span class="token comment"># 900秒（15分钟）内至少1个key值改变（则进行数据库保存--持久化） </span>
</span><span class="code-line line-number" line="73"><span class="token comment"># 300秒（5分钟）内至少10个key值改变（则进行数据库保存--持久化） </span>
</span><span class="code-line line-number" line="74"><span class="token comment"># 60秒（1分钟）内至少10000个key值改变（则进行数据库保存--持久化）</span>
</span><span class="code-line line-number" line="75">save <span class="token number">900</span> <span class="token number">1</span>
</span><span class="code-line line-number" line="76">save <span class="token number">300</span> <span class="token number">10</span>
</span><span class="code-line line-number" line="77">save <span class="token number">60</span> <span class="token number">10000</span>
</span><span class="code-line line-number" line="78">
</span><span class="code-line line-number" line="79"><span class="token comment"># 当RDB持久化出现错误后，是否依然进行继续进行工作，yes：不能进行工作，no：可以继续进行工作，</span>
</span><span class="code-line line-number" line="80"><span class="token comment"># 可以通过info中的rdb_last_bgsave_status了解RDB持久化是否有错误</span>
</span><span class="code-line line-number" line="81">stop-writes-on-bgsave-error <span class="token function">yes</span>
</span><span class="code-line line-number" line="82">
</span><span class="code-line line-number" line="83"><span class="token comment"># 使用压缩rdb文件，rdb文件压缩使用LZF压缩算法，yes：压缩，但是需要一些cpu的消耗。no：不压缩，需要更多的磁盘空间</span>
</span><span class="code-line line-number" line="84">rdbcompression <span class="token function">yes</span>
</span><span class="code-line line-number" line="85">
</span><span class="code-line line-number" line="86"><span class="token comment"># 是否校验rdb文件。从rdb格式的第五个版本开始，在rdb文件的末尾会带上CRC64的校验和。</span>
</span><span class="code-line line-number" line="87"><span class="token comment"># 这跟有利于文件的容错性，但是在保存rdb文件的时候，会有大概10%的性能损耗，所以如果你追求高性能，可以关闭该配置。</span>
</span><span class="code-line line-number" line="88">rdbchecksum <span class="token function">yes</span>
</span><span class="code-line line-number" line="89">
</span><span class="code-line line-number" line="90"><span class="token comment"># rdb文件的名称</span>
</span><span class="code-line line-number" line="91">dbfilename dump.rdb
</span><span class="code-line line-number" line="92">
</span><span class="code-line line-number" line="93"><span class="token comment"># 数据目录，数据库的写入会在这个目录。rdb、aof文件也会写在这个目录</span>
</span><span class="code-line line-number" line="94"><span class="token function">dir</span> /var/lib/redis
</span><span class="code-line line-number" line="95">
</span><span class="code-line line-number" line="96"><span class="token comment">################################# REPLICATION #################################</span>
</span><span class="code-line line-number" line="97"><span class="token comment"># 复制选项，slave复制对应的master。</span>
</span><span class="code-line line-number" line="98"><span class="token comment"># slaveof &#x3C;masterip> &#x3C;masterport></span>
</span><span class="code-line line-number" line="99">
</span><span class="code-line line-number" line="100"><span class="token comment">#如果master设置了requirepass，那么slave要连上master，需要有master的密码才行。masterauth就是用来配置master的密码，这样可以在连上master后进行认证。</span>
</span><span class="code-line line-number" line="101"><span class="token comment"># masterauth &#x3C;master-password></span>
</span><span class="code-line line-number" line="102">
</span><span class="code-line line-number" line="103"><span class="token comment">#当从库同主机失去连接或者复制正在进行，从机库有两种运行方式：1) 如果slave-serve-stale-data设置为yes(默认设置)，从库会继续响应客户端的请求。2) 如果slave-serve-stale-data设置为no，除去INFO和SLAVOF命令之外的任何请求都会返回一个错误”SYNC with master in progress”。</span>
</span><span class="code-line line-number" line="104">slave-serve-stale-data <span class="token function">yes</span>
</span><span class="code-line line-number" line="105">
</span><span class="code-line line-number" line="106"><span class="token comment">#作为从服务器，默认情况下是只读的（yes），可以修改成NO，用于写（不建议）。</span>
</span><span class="code-line line-number" line="107">slave-read-only <span class="token function">yes</span>
</span><span class="code-line line-number" line="108">
</span><span class="code-line line-number" line="109"><span class="token comment">#是否使用socket方式复制数据。目前redis复制提供两种方式，disk和socket。如果新的slave连上来或者重连的slave无法部分同步，就会执行全量同步，master会生成rdb文件。有2种方式：disk方式是master创建一个新的进程把rdb文件保存到磁盘，再把磁盘上的rdb文件传递给slave。socket是master创建一个新的进程，直接把rdb文件以socket的方式发给slave。disk方式的时候，当一个rdb保存的过程中，多个slave都能共享这个rdb文件。socket的方式就的一个个slave顺序复制。在磁盘速度缓慢，网速快的情况下推荐用socket方式。</span>
</span><span class="code-line line-number" line="110">repl-diskless-sync no
</span><span class="code-line line-number" line="111">
</span><span class="code-line line-number" line="112"><span class="token comment">#diskless复制的延迟时间，防止设置为0。一旦复制开始，节点不会再接收新slave的复制请求直到下一个rdb传输。所以最好等待一段时间，等更多的slave连上来。</span>
</span><span class="code-line line-number" line="113">repl-diskless-sync-delay <span class="token number">5</span>
</span><span class="code-line line-number" line="114">
</span><span class="code-line line-number" line="115"><span class="token comment">#slave根据指定的时间间隔向服务器发送ping请求。时间间隔可以通过 repl_ping_slave_period 来设置，默认10秒。</span>
</span><span class="code-line line-number" line="116"><span class="token comment"># repl-ping-slave-period 10</span>
</span><span class="code-line line-number" line="117">
</span><span class="code-line line-number" line="118"><span class="token comment">#复制连接超时时间。master和slave都有超时时间的设置。master检测到slave上次发送的时间超过repl-timeout，即认为slave离线，清除该slave信息。slave检测到上次和master交互的时间超过repl-timeout，则认为master离线。需要注意的是repl-timeout需要设置一个比repl-ping-slave-period更大的值，不然会经常检测到超时。</span>
</span><span class="code-line line-number" line="119"><span class="token comment"># repl-timeout 60</span>
</span><span class="code-line line-number" line="120">
</span><span class="code-line line-number" line="121"><span class="token comment">#是否禁止复制tcp链接的tcp nodelay参数，可传递yes或者no。默认是no，即使用tcp nodelay。如果master设置了yes来禁止tcp nodelay设置，在把数据复制给slave的时候，会减少包的数量和更小的网络带宽。但是这也可能带来数据的延迟。默认我们推荐更小的延迟，但是在数据量传输很大的场景下，建议选择yes。</span>
</span><span class="code-line line-number" line="122">repl-disable-tcp-nodelay no
</span><span class="code-line line-number" line="123">
</span><span class="code-line line-number" line="124"><span class="token comment">#复制缓冲区大小，这是一个环形复制缓冲区，用来保存最新复制的命令。这样在slave离线的时候，不需要完全复制master的数据，如果可以执行部分同步，只需要把缓冲区的部分数据复制给slave，就能恢复正常复制状态。缓冲区的大小越大，slave离线的时间可以更长，复制缓冲区只有在有slave连接的时候才分配内存。没有slave的一段时间，内存会被释放出来，默认1m。</span>
</span><span class="code-line line-number" line="125"><span class="token comment"># repl-backlog-size 5mb</span>
</span><span class="code-line line-number" line="126">
</span><span class="code-line line-number" line="127"><span class="token comment">#master没有slave一段时间会释放复制缓冲区的内存，repl-backlog-ttl用来设置该时间长度。单位为秒。</span>
</span><span class="code-line line-number" line="128"><span class="token comment"># repl-backlog-ttl 3600</span>
</span><span class="code-line line-number" line="129">
</span><span class="code-line line-number" line="130"><span class="token comment">#当master不可用，Sentinel会根据slave的优先级选举一个master。最低的优先级的slave，当选master。而配置成0，永远不会被选举。</span>
</span><span class="code-line line-number" line="131">slave-priority <span class="token number">100</span>
</span><span class="code-line line-number" line="132">
</span><span class="code-line line-number" line="133"><span class="token comment">#redis提供了可以让master停止写入的方式，如果配置了min-slaves-to-write，健康的slave的个数小于N，mater就禁止写入。master最少得有多少个健康的slave存活才能执行写命令。这个配置虽然不能保证N个slave都一定能接收到master的写操作，但是能避免没有足够健康的slave的时候，master不能写入来避免数据丢失。设置为0是关闭该功能。</span>
</span><span class="code-line line-number" line="134"><span class="token comment"># min-slaves-to-write 3</span>
</span><span class="code-line line-number" line="135">
</span><span class="code-line line-number" line="136"><span class="token comment">#延迟小于min-slaves-max-lag秒的slave才认为是健康的slave。</span>
</span><span class="code-line line-number" line="137"><span class="token comment"># min-slaves-max-lag 10</span>
</span><span class="code-line line-number" line="138">
</span><span class="code-line line-number" line="139"><span class="token comment"># 设置1或另一个设置为0禁用这个特性。</span>
</span><span class="code-line line-number" line="140"><span class="token comment"># Setting one or the other to 0 disables the feature.</span>
</span><span class="code-line line-number" line="141"><span class="token comment"># By default min-slaves-to-write is set to 0 (feature disabled) and</span>
</span><span class="code-line line-number" line="142"><span class="token comment"># min-slaves-max-lag is set to 10.</span>
</span><span class="code-line line-number" line="143">
</span><span class="code-line line-number" line="144"><span class="token comment">################################## SECURITY ###################################</span>
</span><span class="code-line line-number" line="145"><span class="token comment">#requirepass配置可以让用户使用AUTH命令来认证密码，才能使用其他命令。这让redis可以使用在不受信任的网络中。为了保持向后的兼容性，可以注释该命令，因为大部分用户也不需要认证。使用requirepass的时候需要注意，因为redis太快了，每秒可以认证15w次密码，简单的密码很容易被攻破，所以最好使用一个更复杂的密码。</span>
</span><span class="code-line line-number" line="146"><span class="token comment"># requirepass foobared</span>
</span><span class="code-line line-number" line="147">
</span><span class="code-line line-number" line="148"><span class="token comment">#把危险的命令给修改成其他名称。比如CONFIG命令可以重命名为一个很难被猜到的命令，这样用户不能使用，而内部工具还能接着使用。</span>
</span><span class="code-line line-number" line="149"><span class="token comment"># rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52</span>
</span><span class="code-line line-number" line="150">
</span><span class="code-line line-number" line="151"><span class="token comment">#设置成一个空的值，可以禁止一个命令</span>
</span><span class="code-line line-number" line="152"><span class="token comment"># rename-command CONFIG ""</span>
</span><span class="code-line line-number" line="153"><span class="token comment">################################### LIMITS ####################################</span>
</span><span class="code-line line-number" line="154">
</span><span class="code-line line-number" line="155"><span class="token comment"># 设置能连上redis的最大客户端连接数量。默认是10000个客户端连接。</span>
</span><span class="code-line line-number" line="156"><span class="token comment"># 由于redis不区分连接是客户端连接还是内部打开文件或者和slave连接等，所以maxclients最小建议设置到32。</span>
</span><span class="code-line line-number" line="157"><span class="token comment"># 如果超过了maxclients，redis会给新的连接发送’max number of clients reached’，并关闭连接。</span>
</span><span class="code-line line-number" line="158"><span class="token comment"># maxclients 10000</span>
</span><span class="code-line line-number" line="159">
</span><span class="code-line line-number" line="160"><span class="token comment"># redis配置的最大内存容量。当内存满了，需要配合maxmemory-policy策略进行处理。</span>
</span><span class="code-line line-number" line="161"><span class="token comment"># 注意slave的输出缓冲区是不计算在maxmemory内的。所以为了防止主机内存使用完，建议设置的maxmemory需要更小一些。</span>
</span><span class="code-line line-number" line="162"><span class="token comment"># maxmemory &#x3C;bytes></span>
</span><span class="code-line line-number" line="163">
</span><span class="code-line line-number" line="164"><span class="token comment"># 内存容量超过maxmemory后的处理策略。</span>
</span><span class="code-line line-number" line="165"><span class="token comment"># volatile-lru：利用LRU算法移除设置过过期时间的key。</span>
</span><span class="code-line line-number" line="166"><span class="token comment"># volatile-random：随机移除设置过过期时间的key。</span>
</span><span class="code-line line-number" line="167"><span class="token comment"># volatile-ttl：移除即将过期的key，根据最近过期时间来删除（辅以TTL）</span>
</span><span class="code-line line-number" line="168"><span class="token comment"># allkeys-lru：利用LRU算法移除任何key。</span>
</span><span class="code-line line-number" line="169"><span class="token comment"># allkeys-random：随机移除任何key。</span>
</span><span class="code-line line-number" line="170"><span class="token comment"># noeviction：不移除任何key，只是返回一个写错误。</span>
</span><span class="code-line line-number" line="171"><span class="token comment"># 上面的这些驱逐策略，如果redis没有合适的key驱逐，对于写命令，还是会返回错误。</span>
</span><span class="code-line line-number" line="172"><span class="token comment"># redis将不再接收写请求，只接收get请求。</span>
</span><span class="code-line line-number" line="173"><span class="token comment"># 写命令包括：set setnx setex append incr decr rpush lpush rpushx lpushx linsert lset rpoplpush sadd sinter sinterstore sunion sunionstore sdiff sdiffstore zadd zincrby zunionstore zinterstore hset hsetnx hmset hincrby incrby decrby getset mset msetnx exec sort。</span>
</span><span class="code-line line-number" line="174"><span class="token comment"># maxmemory-policy noeviction</span>
</span><span class="code-line line-number" line="175">
</span><span class="code-line line-number" line="176"><span class="token comment">#lru检测的样本数。使用lru或者ttl淘汰算法，从需要淘汰的列表中随机选择sample个key，选出闲置时间最长的key移除。</span>
</span><span class="code-line line-number" line="177"><span class="token comment"># maxmemory-samples 5</span>
</span><span class="code-line line-number" line="178">
</span><span class="code-line line-number" line="179"><span class="token comment">############################## APPEND ONLY MODE ###############################</span>
</span><span class="code-line line-number" line="180"><span class="token comment">#默认redis使用的是rdb方式持久化，这种方式在许多应用中已经足够用了。但是redis如果中途宕机，会导致可能有几分钟的数据丢失，根据save来策略进行持久化，Append Only File是另一种持久化方式，可以提供更好的持久化特性。Redis会把每次写入的数据在接收后都写入 appendonly.aof 文件，每次启动时Redis都会先把这个文件的数据读入内存里，先忽略RDB文件。</span>
</span><span class="code-line line-number" line="181">appendonly no
</span><span class="code-line line-number" line="182">
</span><span class="code-line line-number" line="183"><span class="token comment">#aof文件名</span>
</span><span class="code-line line-number" line="184">appendfilename <span class="token string">"appendonly.aof"</span>
</span><span class="code-line line-number" line="185">
</span><span class="code-line line-number" line="186"><span class="token comment"># aof持久化策略的配置</span>
</span><span class="code-line line-number" line="187"><span class="token comment"># no表示不执行fsync，由操作系统保证数据同步到磁盘，速度最快。</span>
</span><span class="code-line line-number" line="188"><span class="token comment"># always表示每次写入都执行fsync，以保证数据同步到磁盘。</span>
</span><span class="code-line line-number" line="189"><span class="token comment"># everysec表示每秒执行一次fsync，可能会导致丢失这1s数据。</span>
</span><span class="code-line line-number" line="190">appendfsync everysec
</span><span class="code-line line-number" line="191">
</span><span class="code-line line-number" line="192"><span class="token comment"># 在aof重写或者写入rdb文件的时候，会执行大量IO，</span>
</span><span class="code-line line-number" line="193"><span class="token comment"># 此时对于everysec和always的aof模式来说，执行fsync会造成阻塞过长时间，</span>
</span><span class="code-line line-number" line="194"><span class="token comment"># no-appendfsync-on-rewrite字段设置为默认设置为no。</span>
</span><span class="code-line line-number" line="195"><span class="token comment"># 如果对延迟要求很高的应用，这个字段可以设置为yes，否则还是设置为no，</span>
</span><span class="code-line line-number" line="196"><span class="token comment"># 这样对持久化特性来说这是更安全的选择。设置为yes表示rewrite期间对新写操作不fsync,</span>
</span><span class="code-line line-number" line="197"><span class="token comment"># 暂时存在内存中,等rewrite完成后再写入，默认为no，建议yes。Linux的默认fsync策略是30秒。可能丢失30秒数据。</span>
</span><span class="code-line line-number" line="198">no-appendfsync-on-rewrite no
</span><span class="code-line line-number" line="199">
</span><span class="code-line line-number" line="200"><span class="token comment"># aof自动重写配置。当目前aof文件大小超过上一次重写的aof文件大小的百分之多少进行重写，</span>
</span><span class="code-line line-number" line="201"><span class="token comment"># 即当aof文件增长到一定大小的时候Redis能够调用bgrewriteaof对日志文件进行重写。</span>
</span><span class="code-line line-number" line="202"><span class="token comment"># 当前AOF文件大小是上次日志重写得到AOF文件大小的二倍（设置为100）时，自动启动新的日志重写过程。</span>
</span><span class="code-line line-number" line="203">auto-aof-rewrite-percentage <span class="token number">100</span>
</span><span class="code-line line-number" line="204"><span class="token comment">#设置允许重写的最小aof文件大小，避免了达到约定百分比但尺寸仍然很小的情况还要重写</span>
</span><span class="code-line line-number" line="205">auto-aof-rewrite-min-size 64mb
</span><span class="code-line line-number" line="206">
</span><span class="code-line line-number" line="207"><span class="token comment"># aof文件可能在尾部是不完整的，当redis启动的时候，aof文件的数据被载入内存。</span>
</span><span class="code-line line-number" line="208"><span class="token comment"># 重启可能发生在redis所在的主机操作系统宕机后，</span>
</span><span class="code-line line-number" line="209"><span class="token comment"># 尤其在ext4文件系统没有加上data=ordered选项（redis宕机或者异常终止不会造成尾部不完整现象。）</span>
</span><span class="code-line line-number" line="210"><span class="token comment"># 出现这种现象，可以选择让redis退出，或者导入尽可能多的数据。如果选择的是yes，</span>
</span><span class="code-line line-number" line="211"><span class="token comment"># 当截断的aof文件被导入的时候，会自动发布一个log给客户端然后load。如果是no，用户必须手动redis-check-aof修复AOF文件才可以。</span>
</span><span class="code-line line-number" line="212">aof-load-truncated <span class="token function">yes</span>
</span><span class="code-line line-number" line="213">
</span><span class="code-line line-number" line="214"><span class="token comment">################################ LUA SCRIPTING ###############################</span>
</span><span class="code-line line-number" line="215"><span class="token comment"># 如果达到最大时间限制（毫秒），redis会记个log，然后返回error。</span>
</span><span class="code-line line-number" line="216"><span class="token comment"># 当一个脚本超过了最大时限。</span>
</span><span class="code-line line-number" line="217"><span class="token comment"># 只有SCRIPT KILL和SHUTDOWN NOSAVE可以用。</span>
</span><span class="code-line line-number" line="218"><span class="token comment"># 第一个可以杀没有调write命令的东西。要是已经调用了write，只能用第二个命令杀。</span>
</span><span class="code-line line-number" line="219">lua-time-limit <span class="token number">5000</span>
</span><span class="code-line line-number" line="220">
</span><span class="code-line line-number" line="221"><span class="token comment">################################ REDIS CLUSTER ###############################</span>
</span><span class="code-line line-number" line="222"><span class="token comment"># 集群开关，默认是不开启集群模式。</span>
</span><span class="code-line line-number" line="223"><span class="token comment"># cluster-enabled yes</span>
</span><span class="code-line line-number" line="224">
</span><span class="code-line line-number" line="225"><span class="token comment"># 集群配置文件的名称，每个节点都有一个集群相关的配置文件，持久化保存集群的信息。</span>
</span><span class="code-line line-number" line="226"><span class="token comment"># 这个文件并不需要手动配置，这个配置文件有Redis生成并更新，每个Redis集群节点需要一个单独的配置文件，</span>
</span><span class="code-line line-number" line="227"><span class="token comment"># 请确保与实例运行的系统中配置文件名称不冲突</span>
</span><span class="code-line line-number" line="228"><span class="token comment"># cluster-config-file nodes-6379.conf</span>
</span><span class="code-line line-number" line="229">
</span><span class="code-line line-number" line="230"><span class="token comment"># 节点互连超时的阀值。集群节点超时毫秒数</span>
</span><span class="code-line line-number" line="231"><span class="token comment"># cluster-node-timeout 15000</span>
</span><span class="code-line line-number" line="232">
</span><span class="code-line line-number" line="233"><span class="token comment"># 在进行故障转移的时候，全部slave都会请求申请为master，但是有些slave可能与master断开连接一段时间了，</span>
</span><span class="code-line line-number" line="234"><span class="token comment"># 导致数据过于陈旧，这样的slave不应该被提升为master。该参数就是用来判断slave节点与master断线的时间是否过长。判断方法是：</span>
</span><span class="code-line line-number" line="235"><span class="token comment"># 比较slave断开连接的时间和(node-timeout * slave-validity-factor) + repl-ping-slave-period</span>
</span><span class="code-line line-number" line="236"><span class="token comment"># 如果节点超时时间为三十秒, 并且slave-validity-factor为10,假设默认的repl-ping-slave-period是10秒，</span>
</span><span class="code-line line-number" line="237"><span class="token comment"># 即如果超过310秒slave将不会尝试进行故障转移 </span>
</span><span class="code-line line-number" line="238"><span class="token comment"># cluster-slave-validity-factor 10</span>
</span><span class="code-line line-number" line="239">
</span><span class="code-line line-number" line="240"><span class="token comment"># master的slave数量大于该值，slave才能迁移到其他孤立master上，</span>
</span><span class="code-line line-number" line="241"><span class="token comment"># 如这个参数若被设为2，那么只有当一个主节点拥有2 个可工作的从节点时，它的一个从节点会尝试迁移。</span>
</span><span class="code-line line-number" line="242"><span class="token comment"># cluster-migration-barrier 1</span>
</span><span class="code-line line-number" line="243">
</span><span class="code-line line-number" line="244"><span class="token comment"># 默认情况下，集群全部的slot有节点负责，集群状态才为ok，才能提供服务。</span>
</span><span class="code-line line-number" line="245"><span class="token comment"># 设置为no，可以在slot没有全部分配的时候提供服务。</span>
</span><span class="code-line line-number" line="246"><span class="token comment"># 不建议打开该配置，这样会造成分区的时候，小分区的master一直在接受写请求，而造成很长时间数据不一致。</span>
</span><span class="code-line line-number" line="247"><span class="token comment"># cluster-require-full-coverage yes</span>
</span><span class="code-line line-number" line="248">
</span><span class="code-line line-number" line="249"><span class="token comment">################################## SLOW LOG ###################################</span>
</span><span class="code-line line-number" line="250"><span class="token comment">###slog log是用来记录redis运行中执行比较慢的命令耗时。当命令的执行超过了指定时间，就记录在slow log中，slog log保存在内存中，所以没有IO操作。</span>
</span><span class="code-line line-number" line="251"><span class="token comment">#执行时间比slowlog-log-slower-than大的请求记录到slowlog里面，单位是微秒，所以1000000就是1秒。注意，负数时间会禁用慢查询日志，而0则会强制记录所有命令。</span>
</span><span class="code-line line-number" line="252">slowlog-log-slower-than <span class="token number">10000</span>
</span><span class="code-line line-number" line="253">
</span><span class="code-line line-number" line="254"><span class="token comment">#慢查询日志长度。当一个新的命令被写进日志的时候，最老的那个记录会被删掉。这个长度没有限制。只要有足够的内存就行。你可以通过 SLOWLOG RESET 来释放内存。</span>
</span><span class="code-line line-number" line="255">slowlog-max-len <span class="token number">128</span>
</span><span class="code-line line-number" line="256">
</span><span class="code-line line-number" line="257"><span class="token comment">################################ LATENCY MONITOR ##############################</span>
</span><span class="code-line line-number" line="258"><span class="token comment">#延迟监控功能是用来监控redis中执行比较缓慢的一些操作，用LATENCY打印redis实例在跑命令时的耗时图表。只记录大于等于下边设置的值的操作。0的话，就是关闭监视。默认延迟监控功能是关闭的，如果你需要打开，也可以通过CONFIG SET命令动态设置。</span>
</span><span class="code-line line-number" line="259">latency-monitor-threshold <span class="token number">0</span>
</span><span class="code-line line-number" line="260">
</span><span class="code-line line-number" line="261"><span class="token comment">############################# EVENT NOTIFICATION ##############################</span>
</span><span class="code-line line-number" line="262"><span class="token comment">#键空间通知使得客户端可以通过订阅频道或模式，来接收那些以某种方式改动了 Redis 数据集的事件。因为开启键空间通知功能需要消耗一些 CPU ，所以在默认配置下，该功能处于关闭状态。</span>
</span><span class="code-line line-number" line="263"><span class="token comment">#notify-keyspace-events 的参数可以是以下字符的任意组合，它指定了服务器该发送哪些类型的通知：</span>
</span><span class="code-line line-number" line="264"><span class="token comment">##K 键空间通知，所有通知以 __keyspace@__ 为前缀</span>
</span><span class="code-line line-number" line="265"><span class="token comment">##E 键事件通知，所有通知以 __keyevent@__ 为前缀</span>
</span><span class="code-line line-number" line="266"><span class="token comment">##g DEL 、 EXPIRE 、 RENAME 等类型无关的通用命令的通知</span>
</span><span class="code-line line-number" line="267"><span class="token comment">##$ 字符串命令的通知</span>
</span><span class="code-line line-number" line="268"><span class="token comment">##l 列表命令的通知</span>
</span><span class="code-line line-number" line="269"><span class="token comment">##s 集合命令的通知</span>
</span><span class="code-line line-number" line="270"><span class="token comment">##h 哈希命令的通知</span>
</span><span class="code-line line-number" line="271"><span class="token comment">##z 有序集合命令的通知</span>
</span><span class="code-line line-number" line="272"><span class="token comment">##x 过期事件：每当有过期键被删除时发送</span>
</span><span class="code-line line-number" line="273"><span class="token comment">##e 驱逐(evict)事件：每当有键因为 maxmemory 政策而被删除时发送</span>
</span><span class="code-line line-number" line="274"><span class="token comment">##A 参数 g$lshzxe 的别名</span>
</span><span class="code-line line-number" line="275"><span class="token comment">#输入的参数中至少要有一个 K 或者 E，否则的话，不管其余的参数是什么，都不会有任何 通知被分发。详细使用可以参考http://redis.io/topics/notifications</span>
</span><span class="code-line line-number" line="276">
</span><span class="code-line line-number" line="277">notify-keyspace-events <span class="token string">"KEA"</span>
</span><span class="code-line line-number" line="278">
</span><span class="code-line line-number" line="279"><span class="token comment">############################### ADVANCED CONFIG ###############################</span>
</span><span class="code-line line-number" line="280"><span class="token comment"># 数据量小于等于hash-max-ziplist-entries的用ziplist，大于hash-max-ziplist-entries用hash</span>
</span><span class="code-line line-number" line="281">hash-max-ziplist-entries <span class="token number">512</span>
</span><span class="code-line line-number" line="282"><span class="token comment"># value大小小于等于hash-max-ziplist-value的用ziplist，大于hash-max-ziplist-value用hash。</span>
</span><span class="code-line line-number" line="283">hash-max-ziplist-value <span class="token number">64</span>
</span><span class="code-line line-number" line="284">
</span><span class="code-line line-number" line="285"><span class="token comment"># 数据量小于等于list-max-ziplist-entries用ziplist，大于list-max-ziplist-entries用list。</span>
</span><span class="code-line line-number" line="286">list-max-ziplist-entries <span class="token number">512</span>
</span><span class="code-line line-number" line="287"><span class="token comment"># value大小小于等于list-max-ziplist-value的用ziplist，大于list-max-ziplist-value用list。</span>
</span><span class="code-line line-number" line="288">list-max-ziplist-value <span class="token number">64</span>
</span><span class="code-line line-number" line="289">
</span><span class="code-line line-number" line="290"><span class="token comment"># 数据量小于等于set-max-intset-entries用iniset，大于set-max-intset-entries用set。</span>
</span><span class="code-line line-number" line="291">set-max-intset-entries <span class="token number">512</span>
</span><span class="code-line line-number" line="292">
</span><span class="code-line line-number" line="293"><span class="token comment"># 数据量小于等于zset-max-ziplist-entries用ziplist，大于zset-max-ziplist-entries用zset。</span>
</span><span class="code-line line-number" line="294">zset-max-ziplist-entries <span class="token number">128</span>
</span><span class="code-line line-number" line="295"><span class="token comment"># value大小小于等于zset-max-ziplist-value用ziplist，大于zset-max-ziplist-value用zset。</span>
</span><span class="code-line line-number" line="296">zset-max-ziplist-value <span class="token number">64</span>
</span><span class="code-line line-number" line="297">
</span><span class="code-line line-number" line="298"><span class="token comment"># value大小小于等于hll-sparse-max-bytes使用稀疏数据结构（sparse），</span>
</span><span class="code-line line-number" line="299"><span class="token comment"># 大于hll-sparse-max-bytes使用稠密的数据结构（dense）。</span>
</span><span class="code-line line-number" line="300"><span class="token comment"># 一个比16000大的value是几乎没用的，建议的value大概为3000。</span>
</span><span class="code-line line-number" line="301"><span class="token comment"># 如果对CPU要求不高，对空间要求较高的，建议设置到10000左右。</span>
</span><span class="code-line line-number" line="302">hll-sparse-max-bytes <span class="token number">3000</span>
</span><span class="code-line line-number" line="303">
</span><span class="code-line line-number" line="304"><span class="token comment"># Redis将在每100毫秒时使用1毫秒的CPU时间来对redis的hash表进行重新hash，可以降低内存的使用。</span>
</span><span class="code-line line-number" line="305"><span class="token comment"># 当你的使用场景中，有非常严格的实时性需要，不能够接受Redis时不时的对请求有2毫秒的延迟的话，把这项配置为no。</span>
</span><span class="code-line line-number" line="306"><span class="token comment"># 如果没有这么严格的实时性要求，可以设置为yes，以便能够尽可能快的释放内存。</span>
</span><span class="code-line line-number" line="307">activerehashing <span class="token function">yes</span>
</span><span class="code-line line-number" line="308">
</span><span class="code-line line-number" line="309"><span class="token comment"># 对客户端输出缓冲进行限制可以强迫那些不从服务器读取数据的客户端断开连接，用来强制关闭传输缓慢的客户端。</span>
</span><span class="code-line line-number" line="310"><span class="token comment"># 对于normal client，第一个0表示取消hard limit，第二个0和第三个0表示取消soft limit，normal client默认取消限制，因为如果没有寻问，他们是不会接收数据的。</span>
</span><span class="code-line line-number" line="311">client-output-buffer-limit normal <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>
</span><span class="code-line line-number" line="312"><span class="token comment"># 对于slave client和MONITER client，如果client-output-buffer一旦超过256mb，又或者超过64mb持续60秒，那么服务器就会立即断开客户端连接。</span>
</span><span class="code-line line-number" line="313">client-output-buffer-limit slave 256mb 64mb <span class="token number">60</span>
</span><span class="code-line line-number" line="314"><span class="token comment"># 对于pubsub client，如果client-output-buffer一旦超过32mb，又或者超过8mb持续60秒，那么服务器就会立即断开客户端连接。</span>
</span><span class="code-line line-number" line="315">client-output-buffer-limit pubsub 32mb 8mb <span class="token number">60</span>
</span><span class="code-line line-number" line="316">
</span><span class="code-line line-number" line="317"><span class="token comment"># redis执行任务的频率为1s除以hz。</span>
</span><span class="code-line line-number" line="318">hz <span class="token number">10</span>
</span><span class="code-line line-number" line="319">
</span><span class="code-line line-number" line="320"><span class="token comment"># 在aof重写的时候，如果打开了aof-rewrite-incremental-fsync开关，系统会每32MB执行一次fsync。这对于把文件写入磁盘是有帮助的，可以避免过大的延迟峰值。</span>
</span><span class="code-line line-number" line="321">aof-rewrite-incremental-fsync <span class="token function">yes</span>
</span></code><input type="hidden" value="#redis.conf
# Redis configuration file example.
# ./redis-server /path/to/redis.conf

################################## INCLUDES ###################################
#这在你有标准配置模板但是每个redis服务器又需要个性设置的时候很有用。
# include /path/to/local.conf
# include /path/to/other.conf

################################ GENERAL #####################################

# 是否在后台执行，yes：后台运行；no：不是后台运行（老版本默认）
daemonize yes

# 3.2里的参数，是否开启保护模式，默认开启。要是配置里没有指定bind和密码。
# 开启该参数后，redis只会本地进行访问，拒绝外部访问。
# 要是开启了密码   和bind，可以开启。否   则最好关闭，设置为no。

protected-mode yes
# redis的进程文件
pidfile /var/run/redis/redis-server.pid

# redis监听的端口号。
port 6379

# 此参数确定了TCP连接中已完成队列(完成三次握手之后)的长度， 
# 当然此值必须不大于Linux系统定义的/proc/sys/net/core/somaxconn值，默认是511，
# 而Linux的默认参数值是128。当系统并发量大并且客户端速度缓慢的时候，
# 可以将这二个参数一起参考设定。该内核参数默认值一般是128，对于负载很大的服务程序来说大大的不够。
# 一般会将它修改为2048或者更大。在/etc/sysctl.conf中添加:net.core.somaxconn = 2048，然后在终端中执行sysctl -p。
tcp-backlog 511

#指定 redis 只接收来自于该 IP 地址的请求，如果不进行设置，那么将处理所有请求
bind 127.0.0.1

# 配置unix socket来让redis支持监听本地连接。
# unixsocket /var/run/redis/redis.sock
# 配置unix socket使用文件的权限
# unixsocketperm 700

# 此参数为设置客户端空闲超过timeout，服务端会断开连接，为0则服务端不会主动断开连接，不能小于0。
timeout 0

# tcp keepalive参数。如果设置不为0，就使用配置tcp的SO_KEEPALIVE值，
# 使用keepalive有两个好处:检测挂掉的对端。降低中间设备出问题而导致网络看似连接却已经与对端端口的问题。
# 在Linux内核中，设置了keepalive，redis会定时给对端发送ack。检测到对端关闭需要两倍的设置值。
tcp-keepalive 0

# 指定了服务端日志的级别。级别包括：debug（很多信息，方便开发、测试），
# verbose（许多有用的信息，但是没有debug级别信息多），notice（适当的日志级别，适合生产环境），warn（只有非常重要的信息）
loglevel notice

#指定了记录日志的文件。空字符串的话，日志会打印到标准输出设备。后台运行的redis标准输出是/dev/null。
logfile /var/log/redis/redis-server.log

# 是否打开记录syslog功能
# syslog-enabled no

# syslog的标识符。
# syslog-ident redis

# 日志的来源、设备
# syslog-facility local0

# 数据库的数量，默认使用的数据库是DB 0。可以通过”SELECT “命令选择一个db
databases 16

################################ SNAPSHOTTING ################################
# 快照配置
# 注释掉“save”这一行配置项就可以让保存数据库功能失效
# 设置sedis进行数据库镜像的频率。
# 900秒（15分钟）内至少1个key值改变（则进行数据库保存--持久化） 
# 300秒（5分钟）内至少10个key值改变（则进行数据库保存--持久化） 
# 60秒（1分钟）内至少10000个key值改变（则进行数据库保存--持久化）
save 900 1
save 300 10
save 60 10000

# 当RDB持久化出现错误后，是否依然进行继续进行工作，yes：不能进行工作，no：可以继续进行工作，
# 可以通过info中的rdb_last_bgsave_status了解RDB持久化是否有错误
stop-writes-on-bgsave-error yes

# 使用压缩rdb文件，rdb文件压缩使用LZF压缩算法，yes：压缩，但是需要一些cpu的消耗。no：不压缩，需要更多的磁盘空间
rdbcompression yes

# 是否校验rdb文件。从rdb格式的第五个版本开始，在rdb文件的末尾会带上CRC64的校验和。
# 这跟有利于文件的容错性，但是在保存rdb文件的时候，会有大概10%的性能损耗，所以如果你追求高性能，可以关闭该配置。
rdbchecksum yes

# rdb文件的名称
dbfilename dump.rdb

# 数据目录，数据库的写入会在这个目录。rdb、aof文件也会写在这个目录
dir /var/lib/redis

################################# REPLICATION #################################
# 复制选项，slave复制对应的master。
# slaveof <masterip> <masterport>

#如果master设置了requirepass，那么slave要连上master，需要有master的密码才行。masterauth就是用来配置master的密码，这样可以在连上master后进行认证。
# masterauth <master-password>

#当从库同主机失去连接或者复制正在进行，从机库有两种运行方式：1) 如果slave-serve-stale-data设置为yes(默认设置)，从库会继续响应客户端的请求。2) 如果slave-serve-stale-data设置为no，除去INFO和SLAVOF命令之外的任何请求都会返回一个错误”SYNC with master in progress”。
slave-serve-stale-data yes

#作为从服务器，默认情况下是只读的（yes），可以修改成NO，用于写（不建议）。
slave-read-only yes

#是否使用socket方式复制数据。目前redis复制提供两种方式，disk和socket。如果新的slave连上来或者重连的slave无法部分同步，就会执行全量同步，master会生成rdb文件。有2种方式：disk方式是master创建一个新的进程把rdb文件保存到磁盘，再把磁盘上的rdb文件传递给slave。socket是master创建一个新的进程，直接把rdb文件以socket的方式发给slave。disk方式的时候，当一个rdb保存的过程中，多个slave都能共享这个rdb文件。socket的方式就的一个个slave顺序复制。在磁盘速度缓慢，网速快的情况下推荐用socket方式。
repl-diskless-sync no

#diskless复制的延迟时间，防止设置为0。一旦复制开始，节点不会再接收新slave的复制请求直到下一个rdb传输。所以最好等待一段时间，等更多的slave连上来。
repl-diskless-sync-delay 5

#slave根据指定的时间间隔向服务器发送ping请求。时间间隔可以通过 repl_ping_slave_period 来设置，默认10秒。
# repl-ping-slave-period 10

#复制连接超时时间。master和slave都有超时时间的设置。master检测到slave上次发送的时间超过repl-timeout，即认为slave离线，清除该slave信息。slave检测到上次和master交互的时间超过repl-timeout，则认为master离线。需要注意的是repl-timeout需要设置一个比repl-ping-slave-period更大的值，不然会经常检测到超时。
# repl-timeout 60

#是否禁止复制tcp链接的tcp nodelay参数，可传递yes或者no。默认是no，即使用tcp nodelay。如果master设置了yes来禁止tcp nodelay设置，在把数据复制给slave的时候，会减少包的数量和更小的网络带宽。但是这也可能带来数据的延迟。默认我们推荐更小的延迟，但是在数据量传输很大的场景下，建议选择yes。
repl-disable-tcp-nodelay no

#复制缓冲区大小，这是一个环形复制缓冲区，用来保存最新复制的命令。这样在slave离线的时候，不需要完全复制master的数据，如果可以执行部分同步，只需要把缓冲区的部分数据复制给slave，就能恢复正常复制状态。缓冲区的大小越大，slave离线的时间可以更长，复制缓冲区只有在有slave连接的时候才分配内存。没有slave的一段时间，内存会被释放出来，默认1m。
# repl-backlog-size 5mb

#master没有slave一段时间会释放复制缓冲区的内存，repl-backlog-ttl用来设置该时间长度。单位为秒。
# repl-backlog-ttl 3600

#当master不可用，Sentinel会根据slave的优先级选举一个master。最低的优先级的slave，当选master。而配置成0，永远不会被选举。
slave-priority 100

#redis提供了可以让master停止写入的方式，如果配置了min-slaves-to-write，健康的slave的个数小于N，mater就禁止写入。master最少得有多少个健康的slave存活才能执行写命令。这个配置虽然不能保证N个slave都一定能接收到master的写操作，但是能避免没有足够健康的slave的时候，master不能写入来避免数据丢失。设置为0是关闭该功能。
# min-slaves-to-write 3

#延迟小于min-slaves-max-lag秒的slave才认为是健康的slave。
# min-slaves-max-lag 10

# 设置1或另一个设置为0禁用这个特性。
# Setting one or the other to 0 disables the feature.
# By default min-slaves-to-write is set to 0 (feature disabled) and
# min-slaves-max-lag is set to 10.

################################## SECURITY ###################################
#requirepass配置可以让用户使用AUTH命令来认证密码，才能使用其他命令。这让redis可以使用在不受信任的网络中。为了保持向后的兼容性，可以注释该命令，因为大部分用户也不需要认证。使用requirepass的时候需要注意，因为redis太快了，每秒可以认证15w次密码，简单的密码很容易被攻破，所以最好使用一个更复杂的密码。
# requirepass foobared

#把危险的命令给修改成其他名称。比如CONFIG命令可以重命名为一个很难被猜到的命令，这样用户不能使用，而内部工具还能接着使用。
# rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52

#设置成一个空的值，可以禁止一个命令
# rename-command CONFIG &#x22;&#x22;
################################### LIMITS ####################################

# 设置能连上redis的最大客户端连接数量。默认是10000个客户端连接。
# 由于redis不区分连接是客户端连接还是内部打开文件或者和slave连接等，所以maxclients最小建议设置到32。
# 如果超过了maxclients，redis会给新的连接发送’max number of clients reached’，并关闭连接。
# maxclients 10000

# redis配置的最大内存容量。当内存满了，需要配合maxmemory-policy策略进行处理。
# 注意slave的输出缓冲区是不计算在maxmemory内的。所以为了防止主机内存使用完，建议设置的maxmemory需要更小一些。
# maxmemory <bytes>

# 内存容量超过maxmemory后的处理策略。
# volatile-lru：利用LRU算法移除设置过过期时间的key。
# volatile-random：随机移除设置过过期时间的key。
# volatile-ttl：移除即将过期的key，根据最近过期时间来删除（辅以TTL）
# allkeys-lru：利用LRU算法移除任何key。
# allkeys-random：随机移除任何key。
# noeviction：不移除任何key，只是返回一个写错误。
# 上面的这些驱逐策略，如果redis没有合适的key驱逐，对于写命令，还是会返回错误。
# redis将不再接收写请求，只接收get请求。
# 写命令包括：set setnx setex append incr decr rpush lpush rpushx lpushx linsert lset rpoplpush sadd sinter sinterstore sunion sunionstore sdiff sdiffstore zadd zincrby zunionstore zinterstore hset hsetnx hmset hincrby incrby decrby getset mset msetnx exec sort。
# maxmemory-policy noeviction

#lru检测的样本数。使用lru或者ttl淘汰算法，从需要淘汰的列表中随机选择sample个key，选出闲置时间最长的key移除。
# maxmemory-samples 5

############################## APPEND ONLY MODE ###############################
#默认redis使用的是rdb方式持久化，这种方式在许多应用中已经足够用了。但是redis如果中途宕机，会导致可能有几分钟的数据丢失，根据save来策略进行持久化，Append Only File是另一种持久化方式，可以提供更好的持久化特性。Redis会把每次写入的数据在接收后都写入 appendonly.aof 文件，每次启动时Redis都会先把这个文件的数据读入内存里，先忽略RDB文件。
appendonly no

#aof文件名
appendfilename &#x22;appendonly.aof&#x22;

# aof持久化策略的配置
# no表示不执行fsync，由操作系统保证数据同步到磁盘，速度最快。
# always表示每次写入都执行fsync，以保证数据同步到磁盘。
# everysec表示每秒执行一次fsync，可能会导致丢失这1s数据。
appendfsync everysec

# 在aof重写或者写入rdb文件的时候，会执行大量IO，
# 此时对于everysec和always的aof模式来说，执行fsync会造成阻塞过长时间，
# no-appendfsync-on-rewrite字段设置为默认设置为no。
# 如果对延迟要求很高的应用，这个字段可以设置为yes，否则还是设置为no，
# 这样对持久化特性来说这是更安全的选择。设置为yes表示rewrite期间对新写操作不fsync,
# 暂时存在内存中,等rewrite完成后再写入，默认为no，建议yes。Linux的默认fsync策略是30秒。可能丢失30秒数据。
no-appendfsync-on-rewrite no

# aof自动重写配置。当目前aof文件大小超过上一次重写的aof文件大小的百分之多少进行重写，
# 即当aof文件增长到一定大小的时候Redis能够调用bgrewriteaof对日志文件进行重写。
# 当前AOF文件大小是上次日志重写得到AOF文件大小的二倍（设置为100）时，自动启动新的日志重写过程。
auto-aof-rewrite-percentage 100
#设置允许重写的最小aof文件大小，避免了达到约定百分比但尺寸仍然很小的情况还要重写
auto-aof-rewrite-min-size 64mb

# aof文件可能在尾部是不完整的，当redis启动的时候，aof文件的数据被载入内存。
# 重启可能发生在redis所在的主机操作系统宕机后，
# 尤其在ext4文件系统没有加上data=ordered选项（redis宕机或者异常终止不会造成尾部不完整现象。）
# 出现这种现象，可以选择让redis退出，或者导入尽可能多的数据。如果选择的是yes，
# 当截断的aof文件被导入的时候，会自动发布一个log给客户端然后load。如果是no，用户必须手动redis-check-aof修复AOF文件才可以。
aof-load-truncated yes

################################ LUA SCRIPTING ###############################
# 如果达到最大时间限制（毫秒），redis会记个log，然后返回error。
# 当一个脚本超过了最大时限。
# 只有SCRIPT KILL和SHUTDOWN NOSAVE可以用。
# 第一个可以杀没有调write命令的东西。要是已经调用了write，只能用第二个命令杀。
lua-time-limit 5000

################################ REDIS CLUSTER ###############################
# 集群开关，默认是不开启集群模式。
# cluster-enabled yes

# 集群配置文件的名称，每个节点都有一个集群相关的配置文件，持久化保存集群的信息。
# 这个文件并不需要手动配置，这个配置文件有Redis生成并更新，每个Redis集群节点需要一个单独的配置文件，
# 请确保与实例运行的系统中配置文件名称不冲突
# cluster-config-file nodes-6379.conf

# 节点互连超时的阀值。集群节点超时毫秒数
# cluster-node-timeout 15000

# 在进行故障转移的时候，全部slave都会请求申请为master，但是有些slave可能与master断开连接一段时间了，
# 导致数据过于陈旧，这样的slave不应该被提升为master。该参数就是用来判断slave节点与master断线的时间是否过长。判断方法是：
# 比较slave断开连接的时间和(node-timeout * slave-validity-factor) + repl-ping-slave-period
# 如果节点超时时间为三十秒, 并且slave-validity-factor为10,假设默认的repl-ping-slave-period是10秒，
# 即如果超过310秒slave将不会尝试进行故障转移 
# cluster-slave-validity-factor 10

# master的slave数量大于该值，slave才能迁移到其他孤立master上，
# 如这个参数若被设为2，那么只有当一个主节点拥有2 个可工作的从节点时，它的一个从节点会尝试迁移。
# cluster-migration-barrier 1

# 默认情况下，集群全部的slot有节点负责，集群状态才为ok，才能提供服务。
# 设置为no，可以在slot没有全部分配的时候提供服务。
# 不建议打开该配置，这样会造成分区的时候，小分区的master一直在接受写请求，而造成很长时间数据不一致。
# cluster-require-full-coverage yes

################################## SLOW LOG ###################################
###slog log是用来记录redis运行中执行比较慢的命令耗时。当命令的执行超过了指定时间，就记录在slow log中，slog log保存在内存中，所以没有IO操作。
#执行时间比slowlog-log-slower-than大的请求记录到slowlog里面，单位是微秒，所以1000000就是1秒。注意，负数时间会禁用慢查询日志，而0则会强制记录所有命令。
slowlog-log-slower-than 10000

#慢查询日志长度。当一个新的命令被写进日志的时候，最老的那个记录会被删掉。这个长度没有限制。只要有足够的内存就行。你可以通过 SLOWLOG RESET 来释放内存。
slowlog-max-len 128

################################ LATENCY MONITOR ##############################
#延迟监控功能是用来监控redis中执行比较缓慢的一些操作，用LATENCY打印redis实例在跑命令时的耗时图表。只记录大于等于下边设置的值的操作。0的话，就是关闭监视。默认延迟监控功能是关闭的，如果你需要打开，也可以通过CONFIG SET命令动态设置。
latency-monitor-threshold 0

############################# EVENT NOTIFICATION ##############################
#键空间通知使得客户端可以通过订阅频道或模式，来接收那些以某种方式改动了 Redis 数据集的事件。因为开启键空间通知功能需要消耗一些 CPU ，所以在默认配置下，该功能处于关闭状态。
#notify-keyspace-events 的参数可以是以下字符的任意组合，它指定了服务器该发送哪些类型的通知：
##K 键空间通知，所有通知以 __keyspace@__ 为前缀
##E 键事件通知，所有通知以 __keyevent@__ 为前缀
##g DEL 、 EXPIRE 、 RENAME 等类型无关的通用命令的通知
##$ 字符串命令的通知
##l 列表命令的通知
##s 集合命令的通知
##h 哈希命令的通知
##z 有序集合命令的通知
##x 过期事件：每当有过期键被删除时发送
##e 驱逐(evict)事件：每当有键因为 maxmemory 政策而被删除时发送
##A 参数 g$lshzxe 的别名
#输入的参数中至少要有一个 K 或者 E，否则的话，不管其余的参数是什么，都不会有任何 通知被分发。详细使用可以参考http://redis.io/topics/notifications

notify-keyspace-events &#x22;KEA&#x22;

############################### ADVANCED CONFIG ###############################
# 数据量小于等于hash-max-ziplist-entries的用ziplist，大于hash-max-ziplist-entries用hash
hash-max-ziplist-entries 512
# value大小小于等于hash-max-ziplist-value的用ziplist，大于hash-max-ziplist-value用hash。
hash-max-ziplist-value 64

# 数据量小于等于list-max-ziplist-entries用ziplist，大于list-max-ziplist-entries用list。
list-max-ziplist-entries 512
# value大小小于等于list-max-ziplist-value的用ziplist，大于list-max-ziplist-value用list。
list-max-ziplist-value 64

# 数据量小于等于set-max-intset-entries用iniset，大于set-max-intset-entries用set。
set-max-intset-entries 512

# 数据量小于等于zset-max-ziplist-entries用ziplist，大于zset-max-ziplist-entries用zset。
zset-max-ziplist-entries 128
# value大小小于等于zset-max-ziplist-value用ziplist，大于zset-max-ziplist-value用zset。
zset-max-ziplist-value 64

# value大小小于等于hll-sparse-max-bytes使用稀疏数据结构（sparse），
# 大于hll-sparse-max-bytes使用稠密的数据结构（dense）。
# 一个比16000大的value是几乎没用的，建议的value大概为3000。
# 如果对CPU要求不高，对空间要求较高的，建议设置到10000左右。
hll-sparse-max-bytes 3000

# Redis将在每100毫秒时使用1毫秒的CPU时间来对redis的hash表进行重新hash，可以降低内存的使用。
# 当你的使用场景中，有非常严格的实时性需要，不能够接受Redis时不时的对请求有2毫秒的延迟的话，把这项配置为no。
# 如果没有这么严格的实时性要求，可以设置为yes，以便能够尽可能快的释放内存。
activerehashing yes

# 对客户端输出缓冲进行限制可以强迫那些不从服务器读取数据的客户端断开连接，用来强制关闭传输缓慢的客户端。
# 对于normal client，第一个0表示取消hard limit，第二个0和第三个0表示取消soft limit，normal client默认取消限制，因为如果没有寻问，他们是不会接收数据的。
client-output-buffer-limit normal 0 0 0
# 对于slave client和MONITER client，如果client-output-buffer一旦超过256mb，又或者超过64mb持续60秒，那么服务器就会立即断开客户端连接。
client-output-buffer-limit slave 256mb 64mb 60
# 对于pubsub client，如果client-output-buffer一旦超过32mb，又或者超过8mb持续60秒，那么服务器就会立即断开客户端连接。
client-output-buffer-limit pubsub 32mb 8mb 60

# redis执行任务的频率为1s除以hz。
hz 10

# 在aof重写的时候，如果打开了aof-rewrite-incremental-fsync开关，系统会每32MB执行一次fsync。这对于把文件写入磁盘是有帮助的，可以避免过大的延迟峰值。
aof-rewrite-incremental-fsync yes
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="精品文章"><a aria-hidden="true" tabindex="-1" href="#精品文章" class="anchor"><span class="icon icon-link"></span></a>精品文章</h2>
        <ul>
          <li><a href="https://mp.weixin.qq.com/s/BoLsVKYyu8yRXZbxd1uuQw">史上最全Redis高可用技术解决方案大全</a></li>
          <li><a href="http://blog.huangz.me/diary/2016/redis-4-outline.html">Redis 4.0 新功能简介</a></li>
          <li><a href="http://blog.huangz.me/diary/2016/how-to-learn-redis.html">Redis 学习路线</a></li>
          <li><a href="https://mp.weixin.qq.com/s/TBCEwLVAXdsTszRVpXhVug">Redis架构之防雪崩设计：网站不宕机背后的兵法</a></li>
          <li><a href="https://cachecloud.github.io/2017/02/16/Redis%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/">Redis的内存优化</a></li>
          <li><a href="https://zhuoroger.github.io/2016/08/20/redis-monitor-and-alarm/">细说Redis监控和告警</a></li>
          <li><a href="https://github.com/sohutv/cachecloud">搜狐视频(sohu tv)Redis私有云平台</a></li>
          <li><a href="https://mp.weixin.qq.com/s?__biz=MzA5NzkxMzg1Nw==&#x26;mid=2653159795&#x26;idx=1&#x26;sn=10264108e1da670774b4b53a1e6dbbe4&#x26;scene=0">优酷土豆的Redis服务平台化之路</a></li>
          <li><a href="https://mp.weixin.qq.com/s?__biz=MzA3MzYwNjQ3NA==&#x26;mid=2651296671&#x26;idx=1&#x26;sn=366de50a6787963517ff6e096c9d1643&#x26;scene=2&#x26;srcid=0601j5sEtcRyw9TtehhXW0Ix&#x26;from=timeline&#x26;isappinstalled=0#wechat_redirect">这可能是最全的 Redis 集群方案介绍了</a></li>
          <li><a href="https://mp.weixin.qq.com/s?__biz=MzAwNTg2MDUyMw==&#x26;mid=2247483661&#x26;idx=1&#x26;sn=c924b3a2b098c4211b0044de180a1c0e">如何实现高可用的redis集群</a></li>
        </ul>
        <div class="previous"><a class="prev" href="../JavaScript/思维导图来学习 Javascript 基础知识.html"><svg viewBox="0 0 1024 1024" width="16" height="16" fill="currentColor">
              <path d="M842.666667 864c-8.533333 0-14.933333-2.133333-21.333334-8.533333l-341.333333-309.333334c-6.4-6.4-10.666667-14.933333-10.666667-23.466666 0-8.533333 4.266667-17.066667 10.666667-23.466667l341.333333-309.333333c12.8-12.8 34.133333-10.666667 44.8 2.133333 12.8 12.8 10.666667 34.133333-2.133333 44.8L548.266667 522.666667l315.733333 285.866666c12.8 10.666667 14.933333 32 2.133333 44.8-6.4 6.4-14.933333 10.666667-23.466666 10.666667z"></path>
              <path d="M512 864c-8.533333 0-14.933333-2.133333-21.333333-8.533333L149.333333 546.133333c-6.4-6.4-10.666667-14.933333-10.666666-23.466666 0-8.533333 4.266667-17.066667 10.666666-23.466667L490.666667 189.866667c12.8-12.8 34.133333-10.666667 44.8 2.133333 12.8 12.8 10.666667 34.133333-2.133334 44.8L217.6 522.666667 533.333333 808.533333c12.8 12.8 14.933333 32 2.133334 44.8-6.4 6.4-14.933333 10.666667-23.466667 10.666667z"></path>
            </svg>
<span>基础知识(思维导图)
</span></a><a class="next" href="../Android/react-native.html"><span>React Native Android 环境搭建
</span><svg viewBox="0 0 1024 1024" width="16" height="16" fill="currentColor">
              <path d="M544 522.666667c0-8.533333-4.266667-17.066667-10.666667-23.466667L192 189.866667c-12.8-12.8-34.133333-10.666667-44.8 2.133333-12.8 12.8-10.666667 34.133333 2.133333 44.8l315.733334 285.866667L149.333333 808.533333c-12.8 12.8-14.933333 32-2.133333 44.8 6.4 6.4 14.933333 10.666667 23.466667 10.666667 8.533333 0 14.933333-2.133333 21.333333-8.533333l341.333333-309.333334c6.4-6.4 10.666667-14.933333 10.666667-23.466666z"></path>
              <path d="M864 499.2l-341.333333-309.333333c-12.8-12.8-34.133333-10.666667-44.8 2.133333-12.8 12.8-10.666667 34.133333 2.133333 44.8l315.733333 285.866667-315.733333 285.866666c-12.8 12.8-14.933333 32-2.133333 44.8 6.4 6.4 14.933333 10.666667 23.466666 10.666667 8.533333 0 14.933333-2.133333 21.333334-8.533333l341.333333-309.333334c6.4-6.4 10.666667-14.933333 10.666667-23.466666 0-8.533333-4.266667-17.066667-10.666667-23.466667z"></path>
            </svg></a></div>
        <section class="article-footer"><a href="https://github.com/jaywcjlove/handbook/blob/master/docs/Redis/README.md" class="edit-button" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
            </svg>
<span>Edit this page on GitHub</span>
</a><span class="atime">2025/04/28</span></section>
      </markdown-style>
      <nav class="tocs">
        <aside class="inner toc">
          <ol class="tocs-list">
            <li><a href="#redis安装" class="tocs-link">Redis安装</a>
              <ol class="tocs-list is-collapsed">
                <li><a href="#官方编译安装" class="tocs-link">官方编译安装</a></li>
                <li><a href="#通过epel源安装" class="tocs-link">通过EPEL源安装</a></li>
                <li><a href="#redis升级" class="tocs-link">Redis升级</a></li>
              </ol>
            </li>
            <li><a href="#服务管理" class="tocs-link">服务管理</a>
              <ol class="tocs-list is-collapsed">
                <li><a href="#基本服务操作" class="tocs-link">基本服务操作</a></li>
                <li><a href="#查看版本" class="tocs-link">查看版本</a></li>
                <li><a href="#服务管理-1" class="tocs-link">服务管理</a></li>
                <li><a href="#开机启动" class="tocs-link">开机启动</a></li>
              </ol>
            </li>
            <li><a href="#更改配置" class="tocs-link">更改配置</a></li>
            <li><a href="#设置请求密码" class="tocs-link">设置请求密码</a></li>
            <li><a href="#主从架构配置" class="tocs-link">主从架构配置</a></li>
            <li><a href="#基本操作" class="tocs-link">基本操作</a></li>
            <li><a href="#支持的数据类型" class="tocs-link">支持的数据类型</a>
              <ol class="tocs-list is-collapsed">
                <li><a href="#字符串" class="tocs-link">字符串</a></li>
                <li><a href="#hashes---哈希值" class="tocs-link">Hashes - 哈希值</a></li>
                <li><a href="#lists---列表" class="tocs-link">Lists - 列表</a></li>
                <li><a href="#有序集合" class="tocs-link">有序集合</a></li>
              </ol>
            </li>
            <li><a href="#开启通知" class="tocs-link">开启通知</a></li>
            <li><a href="#开启远程登录连接" class="tocs-link">开启远程登录连接</a>
              <ol class="tocs-list is-collapsed">
                <li><a href="#修改防火墙配置" class="tocs-link">修改防火墙配置</a></li>
                <li><a href="#修改配置文件" class="tocs-link">修改配置文件</a></li>
              </ol>
            </li>
            <li><a href="#提供的原生监控" class="tocs-link">提供的原生监控</a>
              <ol class="tocs-list is-collapsed">
                <li><a href="#当前链接的客户端数和连接数" class="tocs-link">当前链接的客户端数和连接数</a></li>
                <li><a href="#内存最大的键值和平均的键值数据" class="tocs-link">内存最大的键值和平均的键值数据</a></li>
                <li><a href="#查看当前的键值情况" class="tocs-link">查看当前的键值情况</a></li>
                <li><a href="#原生的monitor监控" class="tocs-link">原生的Monitor监控</a></li>
              </ol>
            </li>
            <li><a href="#配置说明" class="tocs-link">配置说明</a></li>
            <li><a href="#精品文章" class="tocs-link">精品文章</a></li>
          </ol>
        </aside>
      </nav>
    </div>
    <script src="../js/demo-preview.js?v=1.34.1"></script>
    <div class="footer warpper">
      <a href="https://wangchujiang.com/#/app" target="_blank">App</a> •
      <a href="https://wangchujiang.com/#/projects" target="_blank">Projects</a> •
      <a href="https://wangchujiang.com/#/sponsor" target="_blank">Sponsor</a> •
      <a href="https://wangchujiang.com/#/app" target="_blank">More Apps</a><br><br>Released under the MIT License. Copyright © 2024 <a href="https://wangchujiang.com/#/about" target="_blank">Kenny Wong</a><br>Generated by <a href="https://github.com/jaywcjlove/idoc" target="_blank">idoc</a> v1.34.1
    </div>
    <script src="../js/tocbot.js?v=1.34.1"></script>
  </body>
</html>
