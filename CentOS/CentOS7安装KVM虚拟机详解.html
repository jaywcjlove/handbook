<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CentOS7安装KVM虚拟机详解 handbook</title>
    <meta name="description" content="基于 CentOS Linux release 7.2.1511 (Core) 的环境下命令行的方式安装KVM的详细过程。">
    <meta name="keywords" content="handbook,笔记,搜集,摘录,实践,tutorial">
    <link rel="stylesheet" type="text/css" href="../css/main.css?v=1.34.1">
    <link rel="stylesheet" type="text/css" href="../css/tocbot.css?v=1.34.1">
    <link rel="stylesheet" type="text/css" href="../css/media.css?v=1.34.1">
    <link rel="stylesheet" type="text/css" href="../css/sidebar.css?v=1.34.1">
    <link rel="stylesheet" type="text/css" href="../css/copy.css?v=1.34.1">
    <link rel="stylesheet" type="text/css" href="../css/demo-preview.css?v=1.34.1">
    <link rel="icon" href="data:image/png;base64,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" type="image/x-icon">
    <script src="../js/copy.js?v=1.34.1"></script>
    <script src="../js/dark-mode.js?v=1.34.1"></script>
    <script src="../js/markdown-style.js?v=1.34.1"></script>
  </head>
  <body id="idoctotop"><a href="#idoctotop" class="gototop">top</a>
    <header class="header">
      <article class="inner warpper"><a class="logo" href="../index.html"><img alt="handbook logo" src="data:image/png;base64,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">
<span class="title">handbook</span></a>
        <div class="content">
          <ul class="menu">
            <li><a href="../index.html" target="" class="">Home</a></li>
            <li><a href="../awesome.html" target="" class="">Awesome</a></li>
            <li><a href="https://wangchujiang.com/#/app" target="__blank" class="">Apps</a></li>
            <li><a href="https://wangchujiang.com/#/sponsor" target="__blank" class="">Sponsor</a></li>
          </ul><a href="https://github.com/jaywcjlove/handbook" target="_blank" rel="noopener noreferrer" title="Github" name="Github" class="github"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
            </svg></a>
          <dark-mode permanent=""></dark-mode>
        </div>
      </article>
    </header>
    <div class="warpper-content warpper sidebar">
      <div class="sidebar-border">
        <aside class="sidebar" role="navigation">
          <div>
            <label>JavaScript</label>
            <a href="../JavaScript/RegExp.html" class="">一些正则表达式随记</a>
            <a href="../JavaScript/SDK.html" class="">开源 JS 插件和库</a>
            <a href="../JavaScript/nodejs.html" class="">NodeJS 包搜集</a>
            <a href="../JavaScript/思维导图来学习 Javascript 基础知识.html" class="">基础知识(思维导图)</a>
            <label>Redis</label>
            <a href="../Redis/index.html" class="">快速入门 Redis</a>
            <label>Android</label>
            <a href="../Android/react-native.html" class="">React Native Android 环境搭建</a>
            <label>CentOS</label>
            <a href="CentOS.html" class="">CentOS 常用命令</a>
            <a href="CentOS7网络配置.html" class="">CentOS7 网络配置</a>
            <a href="常用基础命令.html" class="">常用基础命令</a>
            <a href="CentOS7安装KVM虚拟机详解.html" class="active">安装 KVM 虚拟机详解</a>
            <a href="CentOS7更换yum软件镜像源.html" class="">更换 yum 软件镜像源</a>
            <a href="CentOS7安装维护Gitlab.html" class="">安装维护 GitLab</a>
            <a href="CentOS7安装配置vsftp搭建FTP.html" class="">安装搭建 FTP</a>
            <a href="Centos7安装编译Node.html" class="">Centos7安装编译Node</a>
            <a href="Elasticsearch安装维护.html" class="">Elasticsearch安装维护</a>
            <a href="Frp内网穿透搭建.html" class="">Frp内网穿透搭建</a>
            <a href="Linux添加、删除用户和用户组.html" class="">Linux添加、删除用户和用户组</a>
            <a href="Mac使用NFS连接CentOS上的共享文件夹.html" class="">Mac使用NFS连接CentOS上的共享文件夹</a>
            <a href="Mac下制作CentOS7启动盘.html" class="">Mac下制作CentOS7启动盘</a>
            <a href="Python2升级到Python3.html" class="">Python2 升级到 Python3</a>
            <a href="Rocket.Chat.html" class="">Rocket.Chat</a>
            <a href="Ruby安装.html" class="">Ruby 安装</a>
            <a href="samba.html" class="">Samba 安装</a>
            <a href="在5分钟内搭建企业内部私有npm仓库.html" class="">搭建私有 npm 仓库</a>
            <a href="Java.html" class="">安装 Java</a>
            <a href="部署Seafile搭建自己的网盘.html" class="">部署 Seafile 搭建自己的网盘</a>
            <a href="搭建Shadowsocks服务器.html" class="">搭建 Shadowsocks 服务器</a>
            <a href="部署YApi平台.html" class="">部署 YApi 平台</a>
            <a href="openstack.html" class="">搭建 OpenStack</a>
            <a href="pip.html" class="">安装 pip 工具</a>
            <a href="修改ssh端口号的方法.html" class="">修改 ssh 端口号的方法</a>
            <a href="尝试在CentOS7.2上编译安装Swift.html" class="">在CentOS 上编译安装 Swift</a>
            <a href="使用免费SSL证书让网站支持HTTPS访问.html" class="">使用免费 SSL 证书支持 HTTPS 访问</a>
            <a href="svn.html" class="">安装使用 svn</a>
            <a href="管理远程会话screen工具.html" class="">管理远程会话screen工具</a>
            <label>macOS</label>
            <a href="../macOS/创建 macOS 操作系统的 App 图标文件 icons.html" class="">创建 macOS 操作系统的 App 图标文件 icons</a>
            <label>其它</label>
            <a href="../other/weixin-public-account.html" class="">公众账号推荐</a>
            <a href="../other/google.html" class="">谷歌(Google)镜像</a>
            <a href="../other/离线预览各种前端文档网站.html" class="">离线预览前端文档</a>
            <a href="../other/通过代理工具提高Github Clone速度.html" class="">提高 Github Clone 速度</a>
            <a href="../other/github-oraganizations.html" class="">国内互联网公司的开源项目汇总</a>
            <a href="../other/HTTP-status-codes.html" class="">常见HTTP/FTP错误代码大全</a>
            <a href="../other/Lua5.3.html" class="">Lua 5.3 文档</a>
            <a href="../Shortcuts/Sketch.html" class="">Sketch 设计软件快捷键</a>
            <a href="../Shortcuts/bash.html" class="">命令行工具bash快捷键</a>
          </div>
        </aside>
      </div>
      <markdown-style theme-auto-switch-disabled="">
        <h1 id="centos7安装kvm虚拟机详解"><a aria-hidden="true" tabindex="-1" href="#centos7安装kvm虚拟机详解" class="anchor"><span class="icon icon-link"></span></a>CentOS7安装KVM虚拟机详解</h1>
        <p>
          <img src="img/kvmbanner-logo3.png" alt="">
        </p>
        <p>基于 CentOS Linux release 7.2.1511 (Core) 的环境下命令行的方式安装KVM的详细过程。</p>
        <h2 id="检测是否支持kvm"><a aria-hidden="true" tabindex="-1" href="#检测是否支持kvm" class="anchor"><span class="icon icon-link"></span></a>检测是否支持KVM</h2>
        <p>KVM 是基于 x86 虚拟化扩展(Intel VT 或者 AMD-V) 技术的虚拟机软件，所以查看 CPU 是否支持 VT 技术，就可以判断是否支持KVM。有返回结果，如果结果中有vmx（Intel）或svm(AMD)字样，就说明CPU的支持的。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">cat</span> /proc/cpuinfo <span class="token operator">|</span> <span class="token function">egrep</span> <span class="token string">'vmx|svm'</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3">flags   <span class="token builtin class-name">:</span> fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf eagerfpu pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm arat epb pln pts dtherm tpr_shadow vnmi flexpriority ept vpid fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm xsaveopt cqm_llc cqm_occup_llc
</span></code><input type="hidden" value="cat /proc/cpuinfo | egrep &#x27;vmx|svm&#x27;

flags   : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf eagerfpu pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm arat epb pln pts dtherm tpr_shadow vnmi flexpriority ept vpid fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm xsaveopt cqm_llc cqm_occup_llc
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>关闭SELinux，将 /etc/sysconfig/selinux 中的 <code>SELinux=enforcing</code> 修改为 <code>SELinux=disabled</code></p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">vi</span> /etc/sysconfig/selinux
</span></code><input type="hidden" value="vi /etc/sysconfig/selinux
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="安装-kvm-环境"><a aria-hidden="true" tabindex="-1" href="#安装-kvm-环境" class="anchor"><span class="icon icon-link"></span></a>安装 KVM 环境</h2>
        <p>通过 <a href="https://jaywcjlove.github.io/linux-command/c/yum.html">yum</a> 安装 kvm 基础包和管理工具</p>
        <p>kvm相关安装包及其作用:</p>
        <ul>
          <li><code>qemu-kvm</code> 主要的KVM程序包</li>
          <li><code>python-virtinst</code> 创建虚拟机所需要的命令行工具和程序库</li>
          <li><code>virt-manager</code> GUI虚拟机管理工具</li>
          <li><code>virt-top</code> 虚拟机统计命令</li>
          <li><code>virt-viewer</code> GUI连接程序，连接到已配置好的虚拟机</li>
          <li><code>libvirt</code> C语言工具包，提供libvirt服务</li>
          <li><code>libvirt-client</code> 为虚拟客户机提供的C语言工具包</li>
          <li><code>virt-install</code> 基于libvirt服务的虚拟机创建命令</li>
          <li><code>bridge-utils</code> 创建和管理桥接设备的工具</li>
        </ul>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># 安装 kvm </span>
</span><span class="code-line line-number" line="2"><span class="token comment"># ------------------------</span>
</span><span class="code-line line-number" line="3"><span class="token comment"># yum -y install qemu-kvm python-virtinst libvirt libvirt-python virt-manager libguestfs-tools bridge-utils virt-install</span>
</span><span class="code-line line-number" line="4">
</span><span class="code-line line-number" line="5">yum <span class="token parameter variable">-y</span> <span class="token function">install</span> qemu-kvm libvirt virt-install bridge-utils 
</span><span class="code-line line-number" line="6">
</span><span class="code-line line-number" line="7"><span class="token comment"># 重启宿主机，以便加载 kvm 模块</span>
</span><span class="code-line line-number" line="8"><span class="token comment"># ------------------------</span>
</span><span class="code-line line-number" line="9"><span class="token function">reboot</span>
</span><span class="code-line line-number" line="10">
</span><span class="code-line line-number" line="11"><span class="token comment"># 查看KVM模块是否被正确加载</span>
</span><span class="code-line line-number" line="12"><span class="token comment"># ------------------------</span>
</span><span class="code-line line-number" line="13">lsmod <span class="token operator">|</span> <span class="token function">grep</span> kvm
</span><span class="code-line line-number" line="14">
</span><span class="code-line line-number" line="15">kvm_intel             <span class="token number">162153</span>  <span class="token number">0</span>
</span><span class="code-line line-number" line="16">kvm                   <span class="token number">525259</span>  <span class="token number">1</span> kvm_intel
</span><span class="code-line line-number" line="17">
</span></code><input type="hidden" value="# 安装 kvm 
# ------------------------
# yum -y install qemu-kvm python-virtinst libvirt libvirt-python virt-manager libguestfs-tools bridge-utils virt-install

yum -y install qemu-kvm libvirt virt-install bridge-utils 

# 重启宿主机，以便加载 kvm 模块
# ------------------------
reboot

# 查看KVM模块是否被正确加载
# ------------------------
lsmod | grep kvm

kvm_intel             162153  0
kvm                   525259  1 kvm_intel

"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>开启kvm服务，并且设置其开机自动启动</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">systemctl start libvirtd
</span><span class="code-line line-number" line="2">systemctl <span class="token builtin class-name">enable</span> libvirtd
</span></code><input type="hidden" value="systemctl start libvirtd
systemctl enable libvirtd
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>查看状态操作结果，如<code>Active: active (running)</code>，说明运行情况良好</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">systemctl status libvirtd
</span><span class="code-line line-number" line="2">systemctl is-enabled libvirtd
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4">● libvirtd.service - Virtualization daemon
</span><span class="code-line line-number" line="5">   Loaded: loaded <span class="token punctuation">(</span>/usr/lib/systemd/system/libvirtd.service<span class="token punctuation">;</span> enabled<span class="token punctuation">;</span> vendor preset: enabled<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="6">   Active: active <span class="token punctuation">(</span>running<span class="token punctuation">)</span> since 二 <span class="token number">2001</span>-01-02 <span class="token number">11</span>:29:53 CST<span class="token punctuation">;</span> 1h 41min ago
</span><span class="code-line line-number" line="7">     Docs: man:libvirtd<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="8">           http://libvirt.org
</span></code><input type="hidden" value="systemctl status libvirtd
systemctl is-enabled libvirtd

● libvirtd.service - Virtualization daemon
   Loaded: loaded (/usr/lib/systemd/system/libvirtd.service; enabled; vendor preset: enabled)
   Active: active (running) since 二 2001-01-02 11:29:53 CST; 1h 41min ago
     Docs: man:libvirtd(8)
           http://libvirt.org
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="安装虚拟机"><a aria-hidden="true" tabindex="-1" href="#安装虚拟机" class="anchor"><span class="icon icon-link"></span></a>安装虚拟机</h2>
        <p>安装前要设置环境语言为英文<code>LANG="en_US.UTF-8"</code>，如果是中文的话某些版本可能会报错。<code>CentOS 7</code> 在这里修改 <code>/etc/locale.conf</code>。</p>
        <p>kvm创建虚拟机，特别注意<code>.iso</code>镜像文件一定放到<code>/home</code> 或者根目录重新创建目录，不然会因为权限报错，无法创建虚拟机。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">virt-install <span class="token punctuation">\</span>
</span><span class="code-line line-number" line="2">--virt-type<span class="token operator">=</span>kvm <span class="token punctuation">\</span>
</span><span class="code-line line-number" line="3"><span class="token parameter variable">--name</span><span class="token operator">=</span>centos78 <span class="token punctuation">\</span>
</span><span class="code-line line-number" line="4"><span class="token parameter variable">--vcpus</span><span class="token operator">=</span><span class="token number">2</span> <span class="token punctuation">\</span>
</span><span class="code-line line-number" line="5"><span class="token parameter variable">--memory</span><span class="token operator">=</span><span class="token number">4096</span> <span class="token punctuation">\</span>
</span><span class="code-line line-number" line="6"><span class="token parameter variable">--location</span><span class="token operator">=</span>/tmp/CentOS-7-x86_64-Minimal-1511.iso <span class="token punctuation">\</span>
</span><span class="code-line line-number" line="7"><span class="token parameter variable">--disk</span> <span class="token assign-left variable">path</span><span class="token operator">=</span>/home/vms/centos78.qcow2,size<span class="token operator">=</span><span class="token number">40</span>,format<span class="token operator">=</span>qcow2 <span class="token punctuation">\</span>
</span><span class="code-line line-number" line="8"><span class="token parameter variable">--network</span> <span class="token assign-left variable">bridge</span><span class="token operator">=</span>br0 <span class="token punctuation">\</span>
</span><span class="code-line line-number" line="9"><span class="token parameter variable">--graphics</span> none <span class="token punctuation">\</span>
</span><span class="code-line line-number" line="10">--extra-args<span class="token operator">=</span><span class="token string">'console=ttyS0'</span> <span class="token punctuation">\</span>
</span><span class="code-line line-number" line="11"><span class="token parameter variable">--force</span>
</span><span class="code-line line-number" line="12"><span class="token comment"># ------------------------</span>
</span><span class="code-line line-number" line="13">virt-install --virt-type<span class="token operator">=</span>kvm <span class="token parameter variable">--name</span><span class="token operator">=</span>centos88 <span class="token parameter variable">--vcpus</span><span class="token operator">=</span><span class="token number">2</span> <span class="token parameter variable">--memory</span><span class="token operator">=</span><span class="token number">4096</span> <span class="token parameter variable">--location</span><span class="token operator">=</span>/tmp/CentOS-7-x86_64-Minimal-1511.iso <span class="token parameter variable">--disk</span> <span class="token assign-left variable">path</span><span class="token operator">=</span>/home/vms/centos88.qcow2,size<span class="token operator">=</span><span class="token number">40</span>,format<span class="token operator">=</span>qcow2 <span class="token parameter variable">--network</span> <span class="token assign-left variable">bridge</span><span class="token operator">=</span>br0 <span class="token parameter variable">--graphics</span> none --extra-args<span class="token operator">=</span><span class="token string">'console=ttyS0'</span> <span class="token parameter variable">--force</span>
</span></code><input type="hidden" value="virt-install \
--virt-type=kvm \
--name=centos78 \
--vcpus=2 \
--memory=4096 \
--location=/tmp/CentOS-7-x86_64-Minimal-1511.iso \
--disk path=/home/vms/centos78.qcow2,size=40,format=qcow2 \
--network bridge=br0 \
--graphics none \
--extra-args=&#x27;console=ttyS0&#x27; \
--force
# ------------------------
virt-install --virt-type=kvm --name=centos88 --vcpus=2 --memory=4096 --location=/tmp/CentOS-7-x86_64-Minimal-1511.iso --disk path=/home/vms/centos88.qcow2,size=40,format=qcow2 --network bridge=br0 --graphics none --extra-args=&#x27;console=ttyS0&#x27; --force
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h3 id="命令行配置系统"><a aria-hidden="true" tabindex="-1" href="#命令行配置系统" class="anchor"><span class="icon icon-link"></span></a>命令行配置系统</h3>
        <p>上面创建虚拟机命令最终需要你配置系统基础设置，带 <code>[!]</code> 基本都是要配置的，按照顺序往下配置，按对用的数字以此进行设置。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">
</span><span class="code-line line-number" line="2">Installation
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4"> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>x<span class="token punctuation">]</span> Language settings                 <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">]</span> Timezone settings
</span><span class="code-line line-number" line="5">        <span class="token punctuation">(</span>English <span class="token punctuation">(</span>United States<span class="token punctuation">))</span>                <span class="token punctuation">(</span>Timezone is not set.<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="6"> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">]</span> Installation <span class="token builtin class-name">source</span>               <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">]</span> Software selection
</span><span class="code-line line-number" line="7">        <span class="token punctuation">(</span>Processing<span class="token punctuation">..</span>.<span class="token punctuation">)</span>                          <span class="token punctuation">(</span>Processing<span class="token punctuation">..</span>.<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="8"> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">]</span> Installation Destination          <span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>x<span class="token punctuation">]</span> Kdump
</span><span class="code-line line-number" line="9">        <span class="token punctuation">(</span>No disks selected<span class="token punctuation">)</span>                      <span class="token punctuation">(</span>Kdump is enabled<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="10"> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span> Network configuration             <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">]</span> Root password
</span><span class="code-line line-number" line="11">        <span class="token punctuation">(</span>Not connected<span class="token punctuation">)</span>                          <span class="token punctuation">(</span>Password is not set.<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="12"> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">]</span> User creation
</span><span class="code-line line-number" line="13">        <span class="token punctuation">(</span>No user will be created<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="14">  Please <span class="token function">make</span> your choice from above <span class="token punctuation">[</span><span class="token string">'q'</span> to quit <span class="token operator">|</span> <span class="token string">'b'</span> to begin installation <span class="token operator">|</span>
</span><span class="code-line line-number" line="15">  <span class="token string">'r'</span> to refresh<span class="token punctuation">]</span>:
</span></code><input type="hidden" value="
Installation

 1) [x] Language settings                 2) [!] Timezone settings
        (English (United States))                (Timezone is not set.)
 3) [!] Installation source               4) [!] Software selection
        (Processing...)                          (Processing...)
 5) [!] Installation Destination          6) [x] Kdump
        (No disks selected)                      (Kdump is enabled)
 7) [ ] Network configuration             8) [!] Root password
        (Not connected)                          (Password is not set.)
 9) [!] User creation
        (No user will be created)
  Please make your choice from above [&#x27;q&#x27; to quit | &#x27;b&#x27; to begin installation |
  &#x27;r&#x27; to refresh]:
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <ol start="2">
          <li>Timezone settings 时区设置选择 <code>5) Asia亚洲</code>，再选择城市 <code>62) Shanghai上海</code></li>
        </ol>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">Available regions
</span><span class="code-line line-number" line="2"> <span class="token number">1</span><span class="token punctuation">)</span>  Africa                 <span class="token number">6</span><span class="token punctuation">)</span>  Atlantic              <span class="token number">10</span><span class="token punctuation">)</span>  Pacific
</span><span class="code-line line-number" line="3"> <span class="token number">2</span><span class="token punctuation">)</span>  America                <span class="token number">7</span><span class="token punctuation">)</span>  Australia             <span class="token number">11</span><span class="token punctuation">)</span>  US
</span><span class="code-line line-number" line="4"> <span class="token number">3</span><span class="token punctuation">)</span>  Antarctica             <span class="token number">8</span><span class="token punctuation">)</span>  Europe                <span class="token number">12</span><span class="token punctuation">)</span>  Etc
</span><span class="code-line line-number" line="5"> <span class="token number">4</span><span class="token punctuation">)</span>  Arctic                 <span class="token number">9</span><span class="token punctuation">)</span>  Indian
</span><span class="code-line line-number" line="6"> <span class="token number">5</span><span class="token punctuation">)</span>  Asia
</span><span class="code-line line-number" line="7">Please <span class="token keyword">select</span> the timezone.
</span><span class="code-line line-number" line="8">Use numbers or <span class="token builtin class-name">type</span> names directly <span class="token punctuation">[</span>b to region list, q to quit<span class="token punctuation">]</span>: <span class="token number">5</span>
</span><span class="code-line line-number" line="9">--------------------
</span><span class="code-line line-number" line="10">
</span><span class="code-line line-number" line="11"> <span class="token number">8</span><span class="token punctuation">)</span>  Baghdad               <span class="token number">35</span><span class="token punctuation">)</span>  Kathmandu             <span class="token number">61</span><span class="token punctuation">)</span>  Seoul
</span><span class="code-line line-number" line="12"> <span class="token number">9</span><span class="token punctuation">)</span>  Bahrain               <span class="token number">36</span><span class="token punctuation">)</span>  Khandyga              <span class="token number">62</span><span class="token punctuation">)</span>  Shanghai
</span><span class="code-line line-number" line="13"><span class="token number">10</span><span class="token punctuation">)</span>  Baku                  <span class="token number">37</span><span class="token punctuation">)</span>  Kolkata               <span class="token number">63</span><span class="token punctuation">)</span>  Singapore
</span><span class="code-line line-number" line="14"><span class="token number">26</span><span class="token punctuation">)</span>  Hong_Kong             <span class="token number">53</span><span class="token punctuation">)</span>  Pontianak
</span><span class="code-line line-number" line="15"><span class="token number">27</span><span class="token punctuation">)</span>  Hovd
</span><span class="code-line line-number" line="16">Please <span class="token keyword">select</span> the timezone.
</span><span class="code-line line-number" line="17">Use numbers or <span class="token builtin class-name">type</span> names directly <span class="token punctuation">[</span>b to region list, q to quit<span class="token punctuation">]</span>: <span class="token number">62</span>
</span><span class="code-line line-number" line="18">
</span></code><input type="hidden" value="Available regions
 1)  Africa                 6)  Atlantic              10)  Pacific
 2)  America                7)  Australia             11)  US
 3)  Antarctica             8)  Europe                12)  Etc
 4)  Arctic                 9)  Indian
 5)  Asia
Please select the timezone.
Use numbers or type names directly [b to region list, q to quit]: 5
--------------------

 8)  Baghdad               35)  Kathmandu             61)  Seoul
 9)  Bahrain               36)  Khandyga              62)  Shanghai
10)  Baku                  37)  Kolkata               63)  Singapore
26)  Hong_Kong             53)  Pontianak
27)  Hovd
Please select the timezone.
Use numbers or type names directly [b to region list, q to quit]: 62

"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <ol start="3">
          <li>Installation source 安装源输入数字<code>2</code></li>
        </ol>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">Choose an installation <span class="token builtin class-name">source</span> type.
</span><span class="code-line line-number" line="2"> <span class="token number">1</span><span class="token punctuation">)</span>  CD/DVD
</span><span class="code-line line-number" line="3"> <span class="token number">2</span><span class="token punctuation">)</span>  <span class="token builtin class-name">local</span> ISO <span class="token function">file</span>
</span><span class="code-line line-number" line="4"> <span class="token number">3</span><span class="token punctuation">)</span>  Network
</span><span class="code-line line-number" line="5">  Please <span class="token function">make</span> your choice from above <span class="token punctuation">[</span><span class="token string">'q'</span> to quit <span class="token operator">|</span> <span class="token string">'c'</span> to <span class="token builtin class-name">continue</span> <span class="token operator">|</span>
</span><span class="code-line line-number" line="6">  <span class="token string">'r'</span> to refresh<span class="token punctuation">]</span>: <span class="token number">2</span>
</span></code><input type="hidden" value="Choose an installation source type.
 1)  CD/DVD
 2)  local ISO file
 3)  Network
  Please make your choice from above [&#x27;q&#x27; to quit | &#x27;c&#x27; to continue |
  &#x27;r&#x27; to refresh]: 2
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <ol start="4">
          <li>Software selection 软件选择</li>
        </ol>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">Base environment
</span><span class="code-line line-number" line="2">Software selection
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4">Base environment
</span><span class="code-line line-number" line="5">
</span><span class="code-line line-number" line="6"> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token punctuation">[</span>x<span class="token punctuation">]</span> Minimal Install
</span><span class="code-line line-number" line="7">  Please <span class="token function">make</span> your choice from above <span class="token punctuation">[</span><span class="token string">'q'</span> to quit <span class="token operator">|</span> <span class="token string">'c'</span> to <span class="token builtin class-name">continue</span> <span class="token operator">|</span>
</span><span class="code-line line-number" line="8">  <span class="token string">'r'</span> to refresh<span class="token punctuation">]</span>:
</span></code><input type="hidden" value="Base environment
Software selection

Base environment

 1)  [x] Minimal Install
  Please make your choice from above [&#x27;q&#x27; to quit | &#x27;c&#x27; to continue |
  &#x27;r&#x27; to refresh]:
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <ol start="5">
          <li>Installation Destination 安装目的地</li>
        </ol>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">Installation Destination
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token builtin class-name">:</span> <span class="token number">40</span> GiB <span class="token punctuation">(</span>vda<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="4">
</span><span class="code-line line-number" line="5"><span class="token number">1</span> disk selected<span class="token punctuation">;</span> <span class="token number">40</span> GiB capacity<span class="token punctuation">;</span> <span class="token number">40</span> GiB <span class="token function">free</span> <span class="token punctuation">..</span>.
</span><span class="code-line line-number" line="6">
</span><span class="code-line line-number" line="7">  Please <span class="token function">make</span> your choice from above <span class="token punctuation">[</span><span class="token string">'q'</span> to quit <span class="token operator">|</span> <span class="token string">'c'</span> to <span class="token builtin class-name">continue</span> <span class="token operator">|</span>
</span><span class="code-line line-number" line="8">  <span class="token string">'r'</span> to refresh<span class="token punctuation">]</span>: c
</span><span class="code-line line-number" line="9">
</span><span class="code-line line-number" line="10">
</span><span class="code-line line-number" line="11">Autopartitioning Options 自动分区选项
</span><span class="code-line line-number" line="12">
</span><span class="code-line line-number" line="13"><span class="token punctuation">[</span> <span class="token punctuation">]</span> <span class="token number">1</span><span class="token punctuation">)</span> Replace Existing Linux system<span class="token punctuation">(</span>s<span class="token punctuation">)</span> 替换现有的Linux系统
</span><span class="code-line line-number" line="14">
</span><span class="code-line line-number" line="15"><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token number">2</span><span class="token punctuation">)</span> Use All Space 使用所有空间
</span><span class="code-line line-number" line="16">
</span><span class="code-line line-number" line="17"><span class="token punctuation">[</span> <span class="token punctuation">]</span> <span class="token number">3</span><span class="token punctuation">)</span> Use Free Space 使用可用空间
</span><span class="code-line line-number" line="18">
</span><span class="code-line line-number" line="19"><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
</span><span class="code-line line-number" line="20">Partition Scheme Options 分区方案选项
</span><span class="code-line line-number" line="21">
</span><span class="code-line line-number" line="22"><span class="token punctuation">[</span> <span class="token punctuation">]</span> <span class="token number">1</span><span class="token punctuation">)</span> Standard Partition 标准分区
</span><span class="code-line line-number" line="23">
</span><span class="code-line line-number" line="24"><span class="token punctuation">[</span> <span class="token punctuation">]</span> <span class="token number">2</span><span class="token punctuation">)</span> Btrfs Btrfs
</span><span class="code-line line-number" line="25">
</span><span class="code-line line-number" line="26"><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token number">3</span><span class="token punctuation">)</span> LVM LVM<span class="token punctuation">(</span>逻辑卷管理<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="27">
</span><span class="code-line line-number" line="28"><span class="token punctuation">[</span> <span class="token punctuation">]</span> <span class="token number">4</span><span class="token punctuation">)</span> LVM Thin Provisioning 精简配置
</span><span class="code-line line-number" line="29">
</span><span class="code-line line-number" line="30">Select a partition scheme configuration.
</span><span class="code-line line-number" line="31">
</span><span class="code-line line-number" line="32">  Please <span class="token function">make</span> your choice from above <span class="token punctuation">[</span><span class="token string">'q'</span> to quit <span class="token operator">|</span> <span class="token string">'c'</span> to <span class="token builtin class-name">continue</span> <span class="token operator">|</span>
</span><span class="code-line line-number" line="33">  <span class="token string">'r'</span> to refresh<span class="token punctuation">]</span>: c
</span><span class="code-line line-number" line="34">
</span></code><input type="hidden" value="Installation Destination

[x] 1) : 40 GiB (vda)

1 disk selected; 40 GiB capacity; 40 GiB free ...

  Please make your choice from above [&#x27;q&#x27; to quit | &#x27;c&#x27; to continue |
  &#x27;r&#x27; to refresh]: c


Autopartitioning Options 自动分区选项

[ ] 1) Replace Existing Linux system(s) 替换现有的Linux系统

[x] 2) Use All Space 使用所有空间

[ ] 3) Use Free Space 使用可用空间

================================================================================
Partition Scheme Options 分区方案选项

[ ] 1) Standard Partition 标准分区

[ ] 2) Btrfs Btrfs

[x] 3) LVM LVM(逻辑卷管理)

[ ] 4) LVM Thin Provisioning 精简配置

Select a partition scheme configuration.

  Please make your choice from above [&#x27;q&#x27; to quit | &#x27;c&#x27; to continue |
  &#x27;r&#x27; to refresh]: c

"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>此处也可以只设置 <code>Root 密码</code>和<code>Installation Destination 安装目的地</code>其它进入系统设置比如时区设置如下：</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token builtin class-name">echo</span> <span class="token string">"TZ='Asia/Shanghai'; export TZ"</span> <span class="token operator">>></span> /etc/profile
</span></code><input type="hidden" value="echo &#x22;TZ=&#x27;Asia/Shanghai&#x27;; export TZ&#x22; >> /etc/profile
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h3 id="连接虚拟机"><a aria-hidden="true" tabindex="-1" href="#连接虚拟机" class="anchor"><span class="icon icon-link"></span></a>连接虚拟机</h3>
        <p>通过 <code>virsh console &#x3C;虚拟机名称></code> 命令来连接虚拟机</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># 查看虚拟机</span>
</span><span class="code-line line-number" line="2"><span class="token function">virsh</span> list              <span class="token comment"># 查看在运行的虚拟机</span>
</span><span class="code-line line-number" line="3"><span class="token function">virsh</span> list <span class="token parameter variable">--all</span>         <span class="token comment"># 查看所有虚拟机</span>
</span><span class="code-line line-number" line="4">
</span><span class="code-line line-number" line="5"> Id    Name                           State
</span><span class="code-line line-number" line="6">----------------------------------------------------
</span><span class="code-line line-number" line="7"> <span class="token number">7</span>     centos72                       running
</span></code><input type="hidden" value="# 查看虚拟机
virsh list              # 查看在运行的虚拟机
virsh list --all         # 查看所有虚拟机

 Id    Name                           State
----------------------------------------------------
 7     centos72                       running
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>连接虚拟机</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">virsh</span> console centos72
</span></code><input type="hidden" value="virsh console centos72
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>配置虚拟机网络，编辑<code>vi /etc/sysconfig/network-scripts/ifcfg-eth0</code></p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token assign-left variable">TYPE</span><span class="token operator">=</span>Ethernet
</span><span class="code-line line-number" line="2"><span class="token assign-left variable">BOOTPROTO</span><span class="token operator">=</span>static
</span><span class="code-line line-number" line="3"><span class="token assign-left variable">IPADDR</span><span class="token operator">=</span><span class="token number">192.168</span>.120.200
</span><span class="code-line line-number" line="4"><span class="token assign-left variable">PREFIX</span><span class="token operator">=</span><span class="token number">24</span>
</span><span class="code-line line-number" line="5"><span class="token assign-left variable">GATEWAY</span><span class="token operator">=</span><span class="token number">192.168</span>.120.1
</span><span class="code-line line-number" line="6"><span class="token assign-left variable">DEFROUTE</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="7"><span class="token assign-left variable">PEERDNS</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="8"><span class="token assign-left variable">PEERROUTES</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="9"><span class="token assign-left variable">IPV4_FAILURE_FATAL</span><span class="token operator">=</span>no
</span><span class="code-line line-number" line="10"><span class="token assign-left variable">IPV6INIT</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="11"><span class="token assign-left variable">IPV6_AUTOCONF</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="12"><span class="token assign-left variable">IPV6_DEFROUTE</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="13"><span class="token assign-left variable">IPV6_PEERDNS</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="14"><span class="token assign-left variable">IPV6_PEERROUTES</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="15"><span class="token assign-left variable">IPV6_FAILURE_FATAL</span><span class="token operator">=</span>no
</span><span class="code-line line-number" line="16"><span class="token assign-left variable">NAME</span><span class="token operator">=</span>eth0
</span><span class="code-line line-number" line="17"><span class="token assign-left variable">UUID</span><span class="token operator">=</span>adfa3b7d-bf60-47e6-8482-871dee686fb5
</span><span class="code-line line-number" line="18"><span class="token assign-left variable">DEVICE</span><span class="token operator">=</span>eth0
</span><span class="code-line line-number" line="19"><span class="token assign-left variable">ONBOOT</span><span class="token operator">=</span>yes
</span></code><input type="hidden" value="TYPE=Ethernet
BOOTPROTO=static
IPADDR=192.168.120.200
PREFIX=24
GATEWAY=192.168.120.1
DEFROUTE=yes
PEERDNS=yes
PEERROUTES=yes
IPV4_FAILURE_FATAL=no
IPV6INIT=yes
IPV6_AUTOCONF=yes
IPV6_DEFROUTE=yes
IPV6_PEERDNS=yes
IPV6_PEERROUTES=yes
IPV6_FAILURE_FATAL=no
NAME=eth0
UUID=adfa3b7d-bf60-47e6-8482-871dee686fb5
DEVICE=eth0
ONBOOT=yes
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>添加DNS配置，也可以放到<code>ifcfg-eth0</code>中，DNS不是随便设置的，你可以通过<a href="https://jaywcjlove.github.io/linux-command/c/host.html">host</a>、<a href="https://jaywcjlove.github.io/linux-command/c/dig.html">dig</a>、<a href="https://jaywcjlove.github.io/linux-command/c/nslookup.html">nslookup</a>命令查询DNS，如果这些工具不存在可以通过<code>yum install bind-utils -y</code>来安装一下。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># 如果没有在网络配置添加DNS可以这种方式添加DNS</span>
</span><span class="code-line line-number" line="2"><span class="token builtin class-name">echo</span> <span class="token string">"nameserver 192.168.188.1"</span> <span class="token operator">></span> /etc/resolv.conf
</span></code><input type="hidden" value="# 如果没有在网络配置添加DNS可以这种方式添加DNS
echo &#x22;nameserver 192.168.188.1&#x22; > /etc/resolv.conf
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>激活网卡</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">ifup</span> eth0 <span class="token comment"># 激活网卡</span>
</span></code><input type="hidden" value="ifup eth0 # 激活网卡
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h3 id="虚拟机其它管理"><a aria-hidden="true" tabindex="-1" href="#虚拟机其它管理" class="anchor"><span class="icon icon-link"></span></a>虚拟机其它管理</h3>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">virsh</span> start centos72     <span class="token comment"># 虚拟机开启（启动）：</span>
</span><span class="code-line line-number" line="2"><span class="token function">virsh</span> <span class="token function">reboot</span> centos72    <span class="token comment"># 虚拟机重新启动</span>
</span><span class="code-line line-number" line="3"><span class="token function">virsh</span> <span class="token function">shutdown</span> centos72  <span class="token comment"># 虚拟机关机</span>
</span><span class="code-line line-number" line="4"><span class="token function">virsh</span> destroy centos72   <span class="token comment"># 强制关机（强制断电）</span>
</span><span class="code-line line-number" line="5"><span class="token function">virsh</span> <span class="token function">suspend</span> centos72   <span class="token comment"># 暂停（挂起）KVM 虚拟机</span>
</span><span class="code-line line-number" line="6"><span class="token function">virsh</span> resume centos72    <span class="token comment"># 恢复被挂起的 KVM 虚拟机</span>
</span><span class="code-line line-number" line="7"><span class="token function">virsh</span> undefine centos72  <span class="token comment"># 该方法只删除配置文件，磁盘文件未删除</span>
</span><span class="code-line line-number" line="8"><span class="token function">virsh</span> autostart centos72 <span class="token comment"># 随物理机启动而启动（开机启动）</span>
</span><span class="code-line line-number" line="9"><span class="token function">virsh</span> autostart <span class="token parameter variable">--disable</span> centos72 <span class="token comment"># 取消标记为自动开始（取消开机启动）</span>
</span></code><input type="hidden" value="virsh start centos72     # 虚拟机开启（启动）：
virsh reboot centos72    # 虚拟机重新启动
virsh shutdown centos72  # 虚拟机关机
virsh destroy centos72   # 强制关机（强制断电）
virsh suspend centos72   # 暂停（挂起）KVM 虚拟机
virsh resume centos72    # 恢复被挂起的 KVM 虚拟机
virsh undefine centos72  # 该方法只删除配置文件，磁盘文件未删除
virsh autostart centos72 # 随物理机启动而启动（开机启动）
virsh autostart --disable centos72 # 取消标记为自动开始（取消开机启动）
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="配置物理机网络"><a aria-hidden="true" tabindex="-1" href="#配置物理机网络" class="anchor"><span class="icon icon-link"></span></a>配置物理机网络</h2>
        <p>目前我只有一个固定IP，通过配置<code>eno2</code>，网桥当做路由器，虚拟机共享物理机进出网络。物理机网络配置，网络进出走<code>eno2</code> 编辑<code>vi /etc/sysconfig/network-scripts/ifcfg-eno2</code></p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token assign-left variable">TYPE</span><span class="token operator">=</span>Ethernet
</span><span class="code-line line-number" line="2"><span class="token assign-left variable">BOOTPROTO</span><span class="token operator">=</span>static
</span><span class="code-line line-number" line="3"><span class="token assign-left variable">DEFROUTE</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="4"><span class="token assign-left variable">PEERDNS</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="5"><span class="token assign-left variable">PEERROUTES</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="6"><span class="token assign-left variable">IPV4_FAILURE_FATAL</span><span class="token operator">=</span>no
</span><span class="code-line line-number" line="7"><span class="token assign-left variable">IPV6INIT</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="8"><span class="token assign-left variable">IPV6_AUTOCONF</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="9"><span class="token assign-left variable">IPV6_DEFROUTE</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="10"><span class="token assign-left variable">IPV6_PEERDNS</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="11"><span class="token assign-left variable">IPV6_PEERROUTES</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="12"><span class="token assign-left variable">IPV6_FAILURE_FATAL</span><span class="token operator">=</span>no
</span><span class="code-line line-number" line="13"><span class="token assign-left variable">NAME</span><span class="token operator">=</span>eno2
</span><span class="code-line line-number" line="14"><span class="token assign-left variable">UUID</span><span class="token operator">=</span>f66c303e-994a-43cf-bd91-bb897dc2088d
</span><span class="code-line line-number" line="15"><span class="token assign-left variable">DEVICE</span><span class="token operator">=</span>eno2
</span><span class="code-line line-number" line="16"><span class="token assign-left variable">ONBOOT</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="17">
</span><span class="code-line line-number" line="18"><span class="token assign-left variable">IPADDR</span><span class="token operator">=</span><span class="token operator">&#x3C;</span>这里固定IP配置的地方<span class="token operator">></span>  <span class="token comment"># 设置IP地址</span>
</span><span class="code-line line-number" line="19"><span class="token assign-left variable">PREFIX</span><span class="token operator">=</span><span class="token number">24</span>                   <span class="token comment"># 设置子网掩码</span>
</span><span class="code-line line-number" line="20"><span class="token assign-left variable">GATEWAY</span><span class="token operator">=</span><span class="token operator">&#x3C;</span>这里设置网关<span class="token operator">></span>        <span class="token comment"># 设置网关</span>
</span><span class="code-line line-number" line="21"><span class="token assign-left variable">DNS1</span><span class="token operator">=</span><span class="token operator">&#x3C;</span>这里设置DNS<span class="token operator">></span>           <span class="token comment"># DNS</span>
</span></code><input type="hidden" value="TYPE=Ethernet
BOOTPROTO=static
DEFROUTE=yes
PEERDNS=yes
PEERROUTES=yes
IPV4_FAILURE_FATAL=no
IPV6INIT=yes
IPV6_AUTOCONF=yes
IPV6_DEFROUTE=yes
IPV6_PEERDNS=yes
IPV6_PEERROUTES=yes
IPV6_FAILURE_FATAL=no
NAME=eno2
UUID=f66c303e-994a-43cf-bd91-bb897dc2088d
DEVICE=eno2
ONBOOT=yes

IPADDR=<这里固定IP配置的地方>  # 设置IP地址
PREFIX=24                   # 设置子网掩码
GATEWAY=<这里设置网关>        # 设置网关
DNS1=<这里设置DNS>           # DNS
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p><code>ifcfg-br0</code> 桥接网卡配置在同一个目录中。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token assign-left variable">TYPE</span><span class="token operator">=</span>Bridge
</span><span class="code-line line-number" line="2"><span class="token assign-left variable">BOOTPROTO</span><span class="token operator">=</span>static
</span><span class="code-line line-number" line="3"><span class="token assign-left variable">NAME</span><span class="token operator">=</span>br0
</span><span class="code-line line-number" line="4"><span class="token assign-left variable">DEVICE</span><span class="token operator">=</span>br0
</span><span class="code-line line-number" line="5"><span class="token assign-left variable">ONBOOT</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="6"><span class="token assign-left variable">IPADDR</span><span class="token operator">=</span><span class="token number">192.168</span>.120.1
</span><span class="code-line line-number" line="7"><span class="token assign-left variable">PREFIX</span><span class="token operator">=</span><span class="token number">24</span>
</span></code><input type="hidden" value="TYPE=Bridge
BOOTPROTO=static
NAME=br0
DEVICE=br0
ONBOOT=yes
IPADDR=192.168.120.1
PREFIX=24
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p><code>ifcfg-eno1</code> 物理网卡指定桥接网卡<code>BRIDGE="br0"</code></p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token assign-left variable">TYPE</span><span class="token operator">=</span>Ethernet
</span><span class="code-line line-number" line="2"><span class="token assign-left variable">BOOTPROTO</span><span class="token operator">=</span>none
</span><span class="code-line line-number" line="3"><span class="token assign-left variable">NAME</span><span class="token operator">=</span>eno1
</span><span class="code-line line-number" line="4"><span class="token assign-left variable">DEVICE</span><span class="token operator">=</span>eno1
</span><span class="code-line line-number" line="5"><span class="token assign-left variable">ONBOOT</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="6"><span class="token assign-left variable">BRIDGE</span><span class="token operator">=</span><span class="token string">"br0"</span>
</span></code><input type="hidden" value="TYPE=Ethernet
BOOTPROTO=none
NAME=eno1
DEVICE=eno1
ONBOOT=yes
BRIDGE=&#x22;br0&#x22;
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>配置路由转发<code>vi /etc/sysctl.conf</code></p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># Controls IP packet forwarding</span>
</span><span class="code-line line-number" line="2">net.ipv4.ip_forward <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line line-number" line="3">修改为
</span><span class="code-line line-number" line="4"><span class="token comment"># Controls IP packet forwarding</span>
</span><span class="code-line line-number" line="5">net.ipv4.ip_forward <span class="token operator">=</span> <span class="token number">1</span>    允许内置路由
</span></code><input type="hidden" value="# Controls IP packet forwarding
net.ipv4.ip_forward = 0
修改为
# Controls IP packet forwarding
net.ipv4.ip_forward = 1    允许内置路由
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>再执行 <code>sysctl -p</code> 使其生效</p>
        <h2 id="端口转发"><a aria-hidden="true" tabindex="-1" href="#端口转发" class="anchor"><span class="icon icon-link"></span></a>端口转发</h2>
        <p>现在我们还以上述VM为例，目前该KVM的公网IP为<code>211.11.61.7</code>，VM的IP为<code>192.168.188.115</code>，现在我要求通过访问KVM的2222端口访问VM的22端口。</p>
        <p>编辑<code>vi /etc/rc.d/rc.local</code> 添加下面命令，达到开机重启配置网络转发规则。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># 启动网络转发规则</span>
</span><span class="code-line line-number" line="2">iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-A</span> <span class="token builtin class-name">:</span> <span class="token parameter variable">-s</span> <span class="token number">192.168</span>.188.0/24 <span class="token parameter variable">-j</span> SNAT --to-source <span class="token number">211.11</span>.61.7
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4">iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-A</span> POSTROUTING <span class="token parameter variable">-s</span> <span class="token number">192.168</span>.188.0/24 <span class="token parameter variable">-j</span> SNAT --to-source <span class="token number">211.11</span>.61.7
</span><span class="code-line line-number" line="5">iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-A</span> PREROUTING <span class="token parameter variable">-d</span>  <span class="token number">211.11</span>.61.7 <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">2222</span>  <span class="token parameter variable">-j</span> DNAT --to-dest <span class="token number">192.168</span>.188.115:22
</span><span class="code-line line-number" line="6">iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-A</span> PREROUTING <span class="token parameter variable">-d</span>  <span class="token number">211.11</span>.61.7 <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">2221</span>  <span class="token parameter variable">-j</span> DNAT --to-dest <span class="token number">192.168</span>.188.115:21
</span><span class="code-line line-number" line="7">
</span><span class="code-line line-number" line="8"><span class="token comment"># 实际效果可以通过外网连接虚拟机</span>
</span><span class="code-line line-number" line="9"><span class="token function">ssh</span> <span class="token parameter variable">-p</span> <span class="token number">2222</span> root@211.11.61.7
</span></code><input type="hidden" value="# 启动网络转发规则
iptables -t nat -A : -s 192.168.188.0/24 -j SNAT --to-source 211.11.61.7

iptables -t nat -A POSTROUTING -s 192.168.188.0/24 -j SNAT --to-source 211.11.61.7
iptables -t nat -A PREROUTING -d  211.11.61.7 -p tcp --dport 2222  -j DNAT --to-dest 192.168.188.115:22
iptables -t nat -A PREROUTING -d  211.11.61.7 -p tcp --dport 2221  -j DNAT --to-dest 192.168.188.115:21

# 实际效果可以通过外网连接虚拟机
ssh -p 2222 root@211.11.61.7
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>通过<a href="https://jaywcjlove.github.io/linux-command/c/iptables.html">iptables</a>命令来设置转发规则，源SNAT规则，源网络地址转换，SNAT就是重写包的源IP地址。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># 数据包进行 源NAT(SNAT)，系统先路由——>再过滤（FORWARD)——>最后才进行POSTROUTING SNAT地址翻译</span>
</span><span class="code-line line-number" line="2"><span class="token comment"># -t&#x3C;表>：指定要操纵的表；</span>
</span><span class="code-line line-number" line="3"><span class="token comment"># -A：向规则链中添加条目；</span>
</span><span class="code-line line-number" line="4"><span class="token comment"># -s：指定要匹配的数据包源ip地址；</span>
</span><span class="code-line line-number" line="5"><span class="token comment"># -j&#x3C;目标>：指定要跳转的目标；</span>
</span><span class="code-line line-number" line="6"><span class="token comment"># -j SNAT：源网络地址转换，SNAT就是重写包的源IP地址</span>
</span><span class="code-line line-number" line="7"><span class="token comment"># --to-source ipaddr[-ipaddr][:port-port] </span>
</span><span class="code-line line-number" line="8"><span class="token comment">#   它可以指定单个新的源IP地址，IP地址的包含范围，以及可选的端口范围（仅当规则还指定-p tcp或-p udp时才有效）。 </span>
</span><span class="code-line line-number" line="9"><span class="token comment">#   如果没有指定端口范围，则低于512的源端口将映射到512以下的其他端口：512和1023之间的端口将映射到低于1024的端口，</span>
</span><span class="code-line line-number" line="10"><span class="token comment">#   其他端口将被映射到1024或更高。 在可能的情况下，不会发生港口更改。</span>
</span><span class="code-line line-number" line="11"><span class="token comment">#   在内核高达2.6.10，您可以添加几个 - 源选项。 </span>
</span><span class="code-line line-number" line="12"><span class="token comment">#   对于这些内核，如果通过地址范围或多个源选项指定多个源地址，则会在这些地址之间进行简单的循环（循环中循环）。 </span>
</span><span class="code-line line-number" line="13"><span class="token comment">#   后来的内核（> = 2.6.11-rc1）不再具有NAT到多个范围的能力。</span>
</span><span class="code-line line-number" line="14">iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-A</span> POSTROUTING <span class="token parameter variable">-s</span> <span class="token number">192.168</span>.120.0/24 <span class="token parameter variable">-j</span> SNAT --to-source <span class="token operator">&#x3C;</span>固定IP<span class="token operator">></span>
</span><span class="code-line line-number" line="15"><span class="token comment"># cat /etc/sysconfig/iptables</span>
</span></code><input type="hidden" value="# 数据包进行 源NAT(SNAT)，系统先路由——>再过滤（FORWARD)——>最后才进行POSTROUTING SNAT地址翻译
# -t<表>：指定要操纵的表；
# -A：向规则链中添加条目；
# -s：指定要匹配的数据包源ip地址；
# -j<目标>：指定要跳转的目标；
# -j SNAT：源网络地址转换，SNAT就是重写包的源IP地址
# --to-source ipaddr[-ipaddr][:port-port] 
#   它可以指定单个新的源IP地址，IP地址的包含范围，以及可选的端口范围（仅当规则还指定-p tcp或-p udp时才有效）。 
#   如果没有指定端口范围，则低于512的源端口将映射到512以下的其他端口：512和1023之间的端口将映射到低于1024的端口，
#   其他端口将被映射到1024或更高。 在可能的情况下，不会发生港口更改。
#   在内核高达2.6.10，您可以添加几个 - 源选项。 
#   对于这些内核，如果通过地址范围或多个源选项指定多个源地址，则会在这些地址之间进行简单的循环（循环中循环）。 
#   后来的内核（> = 2.6.11-rc1）不再具有NAT到多个范围的能力。
iptables -t nat -A POSTROUTING -s 192.168.120.0/24 -j SNAT --to-source <固定IP>
# cat /etc/sysconfig/iptables
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="公网访问虚拟机"><a aria-hidden="true" tabindex="-1" href="#公网访问虚拟机" class="anchor"><span class="icon icon-link"></span></a>公网访问虚拟机</h2>
        <p>通过公网ip <code>192.168.188.222</code>端口<code>2280</code>，转发到虚拟机<code>192.168.111.133:80</code>上面</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-A</span> PREROUTING <span class="token parameter variable">-d</span> <span class="token number">192.168</span>.188.222 <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">2280</span> <span class="token parameter variable">-j</span> DNAT --to-dest <span class="token number">192.168</span>.111.133:80
</span></code><input type="hidden" value="iptables -t nat -A PREROUTING -d 192.168.188.222 -p tcp --dport 2280 -j DNAT --to-dest 192.168.111.133:80
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>重启并保存 <code>iptables</code> 配置。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># 保存 </span>
</span><span class="code-line line-number" line="2"><span class="token function">service</span> iptables save
</span><span class="code-line line-number" line="3"><span class="token comment"># 重启</span>
</span><span class="code-line line-number" line="4"><span class="token function">service</span> iptables restart
</span></code><input type="hidden" value="# 保存 
service iptables save
# 重启
service iptables restart
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="配置宿主机网络"><a aria-hidden="true" tabindex="-1" href="#配置宿主机网络" class="anchor"><span class="icon icon-link"></span></a>配置宿主机网络</h2>
        <ol>
          <li>KVM 虚拟机是基于 NAT 的网络配置；</li>
          <li>只有同一宿主机的虚拟键之间可以互相访问，跨宿主机是不能访问；</li>
          <li>虚拟机需要和宿主机配置成桥接模式，以便虚拟机可以在局域网内可见；</li>
        </ol>
        <h3 id="bridge模式配置"><a aria-hidden="true" tabindex="-1" href="#bridge模式配置" class="anchor"><span class="icon icon-link"></span></a>Bridge模式配置</h3>
        <p>Bridge方式即虚拟网桥的网络连接方式，是客户机和子网里面的机器能够互相通信。可以使虚拟机成为网络中具有独立IP的主机。<strong>桥接网络</strong>（也叫 <strong>物理设备共享</strong>）被用作把一个物理设备复制到一台虚拟机。网桥多用作高级设置，特别是主机多个网络接口的情况。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">┌─────────────────────────┐      ┌─────────────────┐
</span><span class="code-line line-number" line="2">│          HOST           │      │Virtual Machine <span class="token number">1</span>│
</span><span class="code-line line-number" line="3">│ ┌──────┐      ┌───────┐ │      │    ┌──────┐     │
</span><span class="code-line line-number" line="4">│ │ br0  │──┬───│ vnet0 │─│─ ─ ─ │    │ br0  │     │
</span><span class="code-line line-number" line="5">│ └──────┘  │   └───────┘ │      │    └──────┘     │
</span><span class="code-line line-number" line="6">│     │     │             │      └─────────────────┘
</span><span class="code-line line-number" line="7">│     │     │   ┌───────┐ │      ┌─────────────────┐
</span><span class="code-line line-number" line="8">│ ┌──────┐  └───│ vnet1 │─│─     │Virtual Machine <span class="token number">2</span>│
</span><span class="code-line line-number" line="9">│ │ eno0 │      └───────┘ │ │    │    ┌──────┐     │
</span><span class="code-line line-number" line="10">│ └──────┘                │  ─ ─ │    │ br0  │     │
</span><span class="code-line line-number" line="11">│ ┌──────┐                │      │    └──────┘     │
</span><span class="code-line line-number" line="12">│ │ eno1 │                │      └─────────────────┘
</span><span class="code-line line-number" line="13">│ └──────┘                │
</span><span class="code-line line-number" line="14">└─────────────────────────┘
</span></code><input type="hidden" value="┌─────────────────────────┐      ┌─────────────────┐
│          HOST           │      │Virtual Machine 1│
│ ┌──────┐      ┌───────┐ │      │    ┌──────┐     │
│ │ br0  │──┬───│ vnet0 │─│─ ─ ─ │    │ br0  │     │
│ └──────┘  │   └───────┘ │      │    └──────┘     │
│     │     │             │      └─────────────────┘
│     │     │   ┌───────┐ │      ┌─────────────────┐
│ ┌──────┐  └───│ vnet1 │─│─     │Virtual Machine 2│
│ │ eno0 │      └───────┘ │ │    │    ┌──────┐     │
│ └──────┘                │  ─ ─ │    │ br0  │     │
│ ┌──────┐                │      │    └──────┘     │
│ │ eno1 │                │      └─────────────────┘
│ └──────┘                │
└─────────────────────────┘
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>通过<a href="https://jaywcjlove.github.io/linux-command/c/ip.html">ip</a> 命令查看宿主机配置文件的名字</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">ip</span> addr
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token number">6</span>: eno1: <span class="token operator">&#x3C;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">></span> mtu <span class="token number">1500</span> qdisc mq state UP qlen <span class="token number">1000</span>
</span><span class="code-line line-number" line="4">    link/ether <span class="token number">38</span>:63:bb:44:cf:6c brd ff:ff:ff:ff:ff:ff
</span><span class="code-line line-number" line="5">    inet <span class="token number">192.168</span>.188.132/24 brd <span class="token number">192.168</span>.188.255 scope global dynamic eno1
</span><span class="code-line line-number" line="6">       valid_lft 2822sec preferred_lft 2822sec
</span><span class="code-line line-number" line="7">    inet6 fe80::3a63:bbff:fe44:cf6c/64 scope <span class="token function">link</span>
</span><span class="code-line line-number" line="8">       valid_lft forever preferred_lft forever
</span></code><input type="hidden" value="ip addr

6: eno1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP qlen 1000
    link/ether 38:63:bb:44:cf:6c brd ff:ff:ff:ff:ff:ff
    inet 192.168.188.132/24 brd 192.168.188.255 scope global dynamic eno1
       valid_lft 2822sec preferred_lft 2822sec
    inet6 fe80::3a63:bbff:fe44:cf6c/64 scope link
       valid_lft forever preferred_lft forever
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>可以看到上面<code>eno1</code>是有获取到ip地址的，相对应的文件在<code>/etc/sysconfig/network-scripts/</code>目录中，<code>ifcfg-eno1</code> 宿主机的物理网卡配置文件</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># cat ifcfg-eno1</span>
</span><span class="code-line line-number" line="2"><span class="token assign-left variable">TYPE</span><span class="token operator">=</span>Ethernet
</span><span class="code-line line-number" line="3"><span class="token assign-left variable">BOOTPROTO</span><span class="token operator">=</span>static
</span><span class="code-line line-number" line="4"><span class="token assign-left variable">NAME</span><span class="token operator">=</span>eno1
</span><span class="code-line line-number" line="5"><span class="token assign-left variable">DEVICE</span><span class="token operator">=</span>eno1
</span><span class="code-line line-number" line="6"><span class="token assign-left variable">UUID</span><span class="token operator">=</span>242b3d4d-37a5-4f46-b072-55554c185ecf
</span><span class="code-line line-number" line="7"><span class="token assign-left variable">ONBOOT</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="8">
</span><span class="code-line line-number" line="9"><span class="token assign-left variable">BRIDGE</span><span class="token operator">=</span><span class="token string">"br0"</span> <span class="token comment"># 指定桥接网卡的名称</span>
</span></code><input type="hidden" value="# cat ifcfg-eno1
TYPE=Ethernet
BOOTPROTO=static
NAME=eno1
DEVICE=eno1
UUID=242b3d4d-37a5-4f46-b072-55554c185ecf
ONBOOT=yes

BRIDGE=&#x22;br0&#x22; # 指定桥接网卡的名称
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p><code>ifcfg-br0</code> 桥接网卡配置在同一个目录中。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># cat ifcfg-br0</span>
</span><span class="code-line line-number" line="2"><span class="token assign-left variable">BOOTPROTO</span><span class="token operator">=</span>static
</span><span class="code-line line-number" line="3"><span class="token assign-left variable">DEFROUTE</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="4"><span class="token assign-left variable">PEERDNS</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="5"><span class="token assign-left variable">PEERROUTES</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="6"><span class="token assign-left variable">IPV4_FAILURE_FATAL</span><span class="token operator">=</span>no
</span><span class="code-line line-number" line="7"><span class="token assign-left variable">IPV6INIT</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="8"><span class="token assign-left variable">IPV6_AUTOCONF</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="9"><span class="token assign-left variable">IPV6_DEFROUTE</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="10"><span class="token assign-left variable">IPV6_PEERDNS</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="11"><span class="token assign-left variable">IPV6_PEERROUTES</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="12"><span class="token assign-left variable">IPV6_FAILURE_FATAL</span><span class="token operator">=</span>no
</span><span class="code-line line-number" line="13"><span class="token assign-left variable">NAME</span><span class="token operator">=</span>br0
</span><span class="code-line line-number" line="14"><span class="token assign-left variable">UUID</span><span class="token operator">=</span>242b3d4d-37a5-4f46-b072-55554c185ecf
</span><span class="code-line line-number" line="15"><span class="token assign-left variable">DEVICE</span><span class="token operator">=</span>br0
</span><span class="code-line line-number" line="16"><span class="token assign-left variable">ONBOOT</span><span class="token operator">=</span>yes
</span><span class="code-line line-number" line="17"><span class="token assign-left variable">TYPE</span><span class="token operator">=</span>bridge  <span class="token comment"># 将制定为桥接类型</span>
</span><span class="code-line line-number" line="18"><span class="token assign-left variable">IPADDR</span><span class="token operator">=</span><span class="token number">192.168</span>.188.133  <span class="token comment"># 设置IP地址</span>
</span><span class="code-line line-number" line="19"><span class="token assign-left variable">PREFIX</span><span class="token operator">=</span><span class="token number">24</span>               <span class="token comment"># 设置子网掩码</span>
</span><span class="code-line line-number" line="20"><span class="token assign-left variable">GATEWAY</span><span class="token operator">=</span><span class="token number">192.168</span>.188.1   <span class="token comment"># 设置网关</span>
</span></code><input type="hidden" value="# cat ifcfg-br0
BOOTPROTO=static
DEFROUTE=yes
PEERDNS=yes
PEERROUTES=yes
IPV4_FAILURE_FATAL=no
IPV6INIT=yes
IPV6_AUTOCONF=yes
IPV6_DEFROUTE=yes
IPV6_PEERDNS=yes
IPV6_PEERROUTES=yes
IPV6_FAILURE_FATAL=no
NAME=br0
UUID=242b3d4d-37a5-4f46-b072-55554c185ecf
DEVICE=br0
ONBOOT=yes
TYPE=bridge  # 将制定为桥接类型
IPADDR=192.168.188.133  # 设置IP地址
PREFIX=24               # 设置子网掩码
GATEWAY=192.168.188.1   # 设置网关
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>配置好之后，通过<a href="https://jaywcjlove.github.io/linux-command/c/systemctl.html">systemctl</a> 命令重启网卡。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">ifup</span> eno1 <span class="token comment"># 激活网卡</span>
</span><span class="code-line line-number" line="2"><span class="token function">ifup</span> br0 <span class="token comment"># 激活桥接网卡</span>
</span><span class="code-line line-number" line="3"><span class="token comment"># 两种重启网络的方法</span>
</span><span class="code-line line-number" line="4">systemctl restart network.service
</span><span class="code-line line-number" line="5"><span class="token function">service</span> network restart
</span><span class="code-line line-number" line="6">
</span><span class="code-line line-number" line="7"><span class="token comment"># 校验桥接接口</span>
</span><span class="code-line line-number" line="8">brctl show
</span><span class="code-line line-number" line="9">
</span><span class="code-line line-number" line="10">bridge name bridge <span class="token function">id</span>   STP enabled interfaces
</span><span class="code-line line-number" line="11">br0   <span class="token number">8000</span>.3863bb44cf6c no    eno1
</span><span class="code-line line-number" line="12">              vnet0
</span><span class="code-line line-number" line="13">virbr0    <span class="token number">8000</span>.525400193f0f <span class="token function">yes</span>   virbr0-nic
</span></code><input type="hidden" value="ifup eno1 # 激活网卡
ifup br0 # 激活桥接网卡
# 两种重启网络的方法
systemctl restart network.service
service network restart

# 校验桥接接口
brctl show

bridge name bridge id   STP enabled interfaces
br0   8000.3863bb44cf6c no    eno1
              vnet0
virbr0    8000.525400193f0f yes   virbr0-nic
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h3 id="nat模式"><a aria-hidden="true" tabindex="-1" href="#nat模式" class="anchor"><span class="icon icon-link"></span></a>NAT模式</h3>
        <p>NAT(Network Address Translation网络地址翻译)，NAT方式是kvm安装后的默认方式。它支持主机与虚拟机的互访，同时也支持虚拟机访问互联网，但不支持外界访问虚拟机。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">virsh</span> net-edit default <span class="token comment"># 如果要创建或者修改NAT网络，要先编辑default.xml：</span>
</span><span class="code-line line-number" line="2"><span class="token function">virsh</span> net-list <span class="token parameter variable">--all</span>
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4"> Name                 State      Autostart     Persistent
</span><span class="code-line line-number" line="5">----------------------------------------------------------
</span><span class="code-line line-number" line="6"> default              active     no            no
</span></code><input type="hidden" value="virsh net-edit default # 如果要创建或者修改NAT网络，要先编辑default.xml：
virsh net-list --all

 Name                 State      Autostart     Persistent
----------------------------------------------------------
 default              active     no            no
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>default是宿主机安装虚拟机支持模块的时候自动安装的。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">ip</span> a l
</span><span class="code-line line-number" line="2"><span class="token number">1</span>: lo: <span class="token operator">&#x3C;</span>LOOPBACK,UP,LOWER_UP<span class="token operator">></span> mtu <span class="token number">65536</span> qdisc noqueue state UNKNOWN
</span><span class="code-line line-number" line="3">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span><span class="code-line line-number" line="4">    inet <span class="token number">127.0</span>.0.1/8 scope <span class="token function">host</span> lo
</span><span class="code-line line-number" line="5">       valid_lft forever preferred_lft forever
</span><span class="code-line line-number" line="6">    inet6 ::1/128 scope <span class="token function">host</span>
</span><span class="code-line line-number" line="7">       valid_lft forever preferred_lft forever
</span><span class="code-line line-number" line="8"><span class="token number">2</span>: ens1f0: <span class="token operator">&#x3C;</span>BROADCAST,MULTICAST<span class="token operator">></span> mtu <span class="token number">1500</span> qdisc mq state DOWN qlen <span class="token number">1000</span>
</span><span class="code-line line-number" line="9">    link/ether 2c:44:fd:8c:43:44 brd ff:ff:ff:ff:ff:ff
</span><span class="code-line line-number" line="10"><span class="token number">3</span>: ens1f1: <span class="token operator">&#x3C;</span>BROADCAST,MULTICAST<span class="token operator">></span> mtu <span class="token number">1500</span> qdisc mq state DOWN qlen <span class="token number">1000</span>
</span><span class="code-line line-number" line="11">    link/ether 2c:44:fd:8c:43:45 brd ff:ff:ff:ff:ff:ff
</span><span class="code-line line-number" line="12"><span class="token number">4</span>: ens1f2: <span class="token operator">&#x3C;</span>BROADCAST,MULTICAST<span class="token operator">></span> mtu <span class="token number">1500</span> qdisc mq state DOWN qlen <span class="token number">1000</span>
</span><span class="code-line line-number" line="13">    link/ether 2c:44:fd:8c:43:46 brd ff:ff:ff:ff:ff:ff
</span><span class="code-line line-number" line="14"><span class="token number">5</span>: ens1f3: <span class="token operator">&#x3C;</span>BROADCAST,MULTICAST<span class="token operator">></span> mtu <span class="token number">1500</span> qdisc mq state DOWN qlen <span class="token number">1000</span>
</span><span class="code-line line-number" line="15">    link/ether 2c:44:fd:8c:43:47 brd ff:ff:ff:ff:ff:ff
</span><span class="code-line line-number" line="16"><span class="token number">6</span>: eno1: <span class="token operator">&#x3C;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">></span> mtu <span class="token number">1500</span> qdisc mq master br0 state UP qlen <span class="token number">1000</span>
</span><span class="code-line line-number" line="17">    link/ether <span class="token number">38</span>:63:bb:44:cf:6c brd ff:ff:ff:ff:ff:ff
</span><span class="code-line line-number" line="18"><span class="token number">7</span>: eno2: <span class="token operator">&#x3C;</span>BROADCAST,MULTICAST<span class="token operator">></span> mtu <span class="token number">1500</span> qdisc mq state DOWN qlen <span class="token number">1000</span>
</span><span class="code-line line-number" line="19">    link/ether <span class="token number">38</span>:63:bb:44:cf:6d brd ff:ff:ff:ff:ff:ff
</span><span class="code-line line-number" line="20"><span class="token number">8</span>: eno3: <span class="token operator">&#x3C;</span>BROADCAST,MULTICAST<span class="token operator">></span> mtu <span class="token number">1500</span> qdisc mq state DOWN qlen <span class="token number">1000</span>
</span><span class="code-line line-number" line="21">    link/ether <span class="token number">38</span>:63:bb:44:cf:6e brd ff:ff:ff:ff:ff:ff
</span><span class="code-line line-number" line="22"><span class="token number">9</span>: eno4: <span class="token operator">&#x3C;</span>BROADCAST,MULTICAST<span class="token operator">></span> mtu <span class="token number">1500</span> qdisc mq state DOWN qlen <span class="token number">1000</span>
</span><span class="code-line line-number" line="23">    link/ether <span class="token number">38</span>:63:bb:44:cf:6f brd ff:ff:ff:ff:ff:ff
</span><span class="code-line line-number" line="24"><span class="token number">10</span>: virbr0: <span class="token operator">&#x3C;</span>NO-CARRIER,BROADCAST,MULTICAST,UP<span class="token operator">></span> mtu <span class="token number">1500</span> qdisc noqueue state DOWN
</span><span class="code-line line-number" line="25">    link/ether <span class="token number">52</span>:54:00:19:3f:0f brd ff:ff:ff:ff:ff:ff
</span><span class="code-line line-number" line="26">    inet <span class="token number">192.168</span>.122.1/24 brd <span class="token number">192.168</span>.122.255 scope global virbr0
</span><span class="code-line line-number" line="27">       valid_lft forever preferred_lft forever
</span><span class="code-line line-number" line="28"><span class="token number">11</span>: virbr0-nic: <span class="token operator">&#x3C;</span>BROADCAST,MULTICAST<span class="token operator">></span> mtu <span class="token number">1500</span> qdisc pfifo_fast master virbr0 state DOWN qlen <span class="token number">500</span>
</span><span class="code-line line-number" line="29">    link/ether <span class="token number">52</span>:54:00:19:3f:0f brd ff:ff:ff:ff:ff:ff
</span><span class="code-line line-number" line="30"><span class="token number">12</span>: br0: <span class="token operator">&#x3C;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">></span> mtu <span class="token number">1500</span> qdisc noqueue state UP
</span><span class="code-line line-number" line="31">    link/ether <span class="token number">38</span>:63:bb:44:cf:6c brd ff:ff:ff:ff:ff:ff
</span><span class="code-line line-number" line="32">    inet <span class="token number">192.168</span>.188.132/24 brd <span class="token number">192.168</span>.188.255 scope global dynamic br0
</span><span class="code-line line-number" line="33">       valid_lft 3397sec preferred_lft 3397sec
</span><span class="code-line line-number" line="34">    inet <span class="token number">192.168</span>.188.133/24 brd <span class="token number">192.168</span>.188.255 scope global secondary br0
</span><span class="code-line line-number" line="35">       valid_lft forever preferred_lft forever
</span><span class="code-line line-number" line="36">    inet6 fe80::3a63:bbff:fe44:cf6c/64 scope <span class="token function">link</span>
</span><span class="code-line line-number" line="37">       valid_lft forever preferred_lft forever
</span><span class="code-line line-number" line="38"><span class="token number">19</span>: vnet0: <span class="token operator">&#x3C;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">></span> mtu <span class="token number">1500</span> qdisc pfifo_fast master br0 state UNKNOWN qlen <span class="token number">500</span>
</span><span class="code-line line-number" line="39">    link/ether fe:54:00:72:12:a8 brd ff:ff:ff:ff:ff:ff
</span><span class="code-line line-number" line="40">    inet6 fe80::fc54:ff:fe72:12a8/64 scope <span class="token function">link</span>
</span><span class="code-line line-number" line="41">       valid_lft forever preferred_lft forever
</span></code><input type="hidden" value="ip a l
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
2: ens1f0: <BROADCAST,MULTICAST> mtu 1500 qdisc mq state DOWN qlen 1000
    link/ether 2c:44:fd:8c:43:44 brd ff:ff:ff:ff:ff:ff
3: ens1f1: <BROADCAST,MULTICAST> mtu 1500 qdisc mq state DOWN qlen 1000
    link/ether 2c:44:fd:8c:43:45 brd ff:ff:ff:ff:ff:ff
4: ens1f2: <BROADCAST,MULTICAST> mtu 1500 qdisc mq state DOWN qlen 1000
    link/ether 2c:44:fd:8c:43:46 brd ff:ff:ff:ff:ff:ff
5: ens1f3: <BROADCAST,MULTICAST> mtu 1500 qdisc mq state DOWN qlen 1000
    link/ether 2c:44:fd:8c:43:47 brd ff:ff:ff:ff:ff:ff
6: eno1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq master br0 state UP qlen 1000
    link/ether 38:63:bb:44:cf:6c brd ff:ff:ff:ff:ff:ff
7: eno2: <BROADCAST,MULTICAST> mtu 1500 qdisc mq state DOWN qlen 1000
    link/ether 38:63:bb:44:cf:6d brd ff:ff:ff:ff:ff:ff
8: eno3: <BROADCAST,MULTICAST> mtu 1500 qdisc mq state DOWN qlen 1000
    link/ether 38:63:bb:44:cf:6e brd ff:ff:ff:ff:ff:ff
9: eno4: <BROADCAST,MULTICAST> mtu 1500 qdisc mq state DOWN qlen 1000
    link/ether 38:63:bb:44:cf:6f brd ff:ff:ff:ff:ff:ff
10: virbr0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc noqueue state DOWN
    link/ether 52:54:00:19:3f:0f brd ff:ff:ff:ff:ff:ff
    inet 192.168.122.1/24 brd 192.168.122.255 scope global virbr0
       valid_lft forever preferred_lft forever
11: virbr0-nic: <BROADCAST,MULTICAST> mtu 1500 qdisc pfifo_fast master virbr0 state DOWN qlen 500
    link/ether 52:54:00:19:3f:0f brd ff:ff:ff:ff:ff:ff
12: br0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP
    link/ether 38:63:bb:44:cf:6c brd ff:ff:ff:ff:ff:ff
    inet 192.168.188.132/24 brd 192.168.188.255 scope global dynamic br0
       valid_lft 3397sec preferred_lft 3397sec
    inet 192.168.188.133/24 brd 192.168.188.255 scope global secondary br0
       valid_lft forever preferred_lft forever
    inet6 fe80::3a63:bbff:fe44:cf6c/64 scope link
       valid_lft forever preferred_lft forever
19: vnet0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast master br0 state UNKNOWN qlen 500
    link/ether fe:54:00:72:12:a8 brd ff:ff:ff:ff:ff:ff
    inet6 fe80::fc54:ff:fe72:12a8/64 scope link
       valid_lft forever preferred_lft forever
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>其中virbr0是由宿主机虚拟机支持模块安装时产生的虚拟网络接口，也是一个switch和bridge，负责把内容分发到各虚拟机。几个虚拟机管理模块产生的接口关系如下图:</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">┌───────────────────────┐                      
</span><span class="code-line line-number" line="2">│         HOST          │                      
</span><span class="code-line line-number" line="3">│ ┌──────┐              │   ┌─────────────────┐
</span><span class="code-line line-number" line="4">│ │ br0  │─┬──────┐     │   │Virtual Machine <span class="token number">1</span>│
</span><span class="code-line line-number" line="5">│ └──────┘ │      │     │   │   ┌──────┐      │
</span><span class="code-line line-number" line="6">│     │    │  ┌───────┐ │ ─ │   │ br0  │      │
</span><span class="code-line line-number" line="7">│     │    │  │ vnet0 │─│┘  │   └──────┘      │
</span><span class="code-line line-number" line="8">│ ┌──────┐ │  └───────┘ │   └─────────────────┘
</span><span class="code-line line-number" line="9">│ │virbr0│ │  ┌───────┐ │   ┌─────────────────┐
</span><span class="code-line line-number" line="10">│ │ <span class="token parameter variable">-nic</span> │ └──│ vnet1 │─│┐  │Virtual Machine <span class="token number">2</span>│
</span><span class="code-line line-number" line="11">│ └──────┘    └───────┘ │   │                 │
</span><span class="code-line line-number" line="12">│ ┌──────┐              │└ ─│   ┌──────┐      │
</span><span class="code-line line-number" line="13">│ │ eno0 │              │   │   │ br0  │      │
</span><span class="code-line line-number" line="14">│ └──────┘              │   │   └──────┘      │
</span><span class="code-line line-number" line="15">│ ┌──────┐              │   └─────────────────┘
</span><span class="code-line line-number" line="16">│ │ eno1 │              │
</span><span class="code-line line-number" line="17">│ └──────┘              │
</span><span class="code-line line-number" line="18">└───────────────────────┘
</span></code><input type="hidden" value="┌───────────────────────┐                      
│         HOST          │                      
│ ┌──────┐              │   ┌─────────────────┐
│ │ br0  │─┬──────┐     │   │Virtual Machine 1│
│ └──────┘ │      │     │   │   ┌──────┐      │
│     │    │  ┌───────┐ │ ─ │   │ br0  │      │
│     │    │  │ vnet0 │─│┘  │   └──────┘      │
│ ┌──────┐ │  └───────┘ │   └─────────────────┘
│ │virbr0│ │  ┌───────┐ │   ┌─────────────────┐
│ │ -nic │ └──│ vnet1 │─│┐  │Virtual Machine 2│
│ └──────┘    └───────┘ │   │                 │
│ ┌──────┐              │└ ─│   ┌──────┐      │
│ │ eno0 │              │   │   │ br0  │      │
│ └──────┘              │   │   └──────┘      │
│ ┌──────┐              │   └─────────────────┘
│ │ eno1 │              │
│ └──────┘              │
└───────────────────────┘
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>从图上可以看出，虚拟接口和物理接口之间没有连接关系，所以虚拟机只能在通过虚拟的网络访问外部世界，无法从网络上定位和访问虚拟主机。</p>
        <p>virbr0是一个桥接器，接收所有到网络192.168.122.*的内容。从下面命令可以验证：</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">brctl show
</span><span class="code-line line-number" line="2"><span class="token comment"># 输出结果</span>
</span><span class="code-line line-number" line="3"><span class="token comment"># ---------------------</span>
</span><span class="code-line line-number" line="4"><span class="token comment"># bridge name bridge id   STP enabled interfaces</span>
</span><span class="code-line line-number" line="5"><span class="token comment"># br0   8000.3863bb44cf6c no    eno1</span>
</span><span class="code-line line-number" line="6"><span class="token comment">#               vnet0</span>
</span><span class="code-line line-number" line="7"><span class="token comment"># virbr0    8000.525400193f0f yes   virbr0-nic</span>
</span><span class="code-line line-number" line="8">
</span><span class="code-line line-number" line="9"><span class="token function">ip</span> route
</span><span class="code-line line-number" line="10"><span class="token comment"># default via 192.168.188.1 dev br0</span>
</span><span class="code-line line-number" line="11"><span class="token comment"># 169.254.0.0/16 dev br0  scope link  metric 1012</span>
</span><span class="code-line line-number" line="12"><span class="token comment"># 192.168.122.0/24 dev virbr0  proto kernel  scope link  src 192.168.122.1</span>
</span><span class="code-line line-number" line="13"><span class="token comment"># 192.168.188.0/24 dev br0  proto kernel  scope link  src 192.168.188.132</span>
</span></code><input type="hidden" value="brctl show
# 输出结果
# ---------------------
# bridge name bridge id   STP enabled interfaces
# br0   8000.3863bb44cf6c no    eno1
#               vnet0
# virbr0    8000.525400193f0f yes   virbr0-nic

ip route
# default via 192.168.188.1 dev br0
# 169.254.0.0/16 dev br0  scope link  metric 1012
# 192.168.122.0/24 dev virbr0  proto kernel  scope link  src 192.168.122.1
# 192.168.188.0/24 dev br0  proto kernel  scope link  src 192.168.188.132
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>同时，虚拟机支持模块会修改iptables规则，通过命令可以查看：</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-L</span> <span class="token parameter variable">-nv</span>
</span><span class="code-line line-number" line="2">iptables <span class="token parameter variable">-t</span> filter <span class="token parameter variable">-L</span> <span class="token parameter variable">-nv</span>
</span></code><input type="hidden" value="iptables -t nat -L -nv
iptables -t filter -L -nv
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>如果没有default的话，或者需要扩展自己的虚拟网络，可以使用命令重新安装NAT。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">virsh</span> net-define /usr/share/libvirt/networks/default.xml
</span></code><input type="hidden" value="virsh net-define /usr/share/libvirt/networks/default.xml
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>此命令定义一个虚拟网络，default.xml的内容：</p>
        <pre class="language-html"><code class="language-html code-highlight"><span class="code-line line-number" line="1"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>network</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="2">  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>name</span><span class="token punctuation">></span></span>default<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>name</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="3">  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>bridge</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>virbr0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
</span><span class="code-line line-number" line="4">  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>forward</span><span class="token punctuation">/></span></span>
</span><span class="code-line line-number" line="5">  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>ip</span> <span class="token attr-name">address</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>192.168.122.1<span class="token punctuation">"</span></span> <span class="token attr-name">netmask</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>255.255.255.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="6">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>dhcp</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="7">      <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>range</span> <span class="token attr-name">start</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>192.168.122.2<span class="token punctuation">"</span></span> <span class="token attr-name">end</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>192.168.122.254<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
</span><span class="code-line line-number" line="8">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>dhcp</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="9">  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>ip</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="10"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>network</span><span class="token punctuation">></span></span>
</span></code><input type="hidden" value="<network>
  <name>default</name>
  <bridge name=&#x22;virbr0&#x22; />
  <forward/>
  <ip address=&#x22;192.168.122.1&#x22; netmask=&#x22;255.255.255.0&#x22;>
    <dhcp>
      <range start=&#x22;192.168.122.2&#x22; end=&#x22;192.168.122.254&#x22; />
    </dhcp>
  </ip>
</network>
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>也可以修改xml，创建自己的虚拟网络。</p>
        <p>重新加载和激活配置：</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">virsh</span>  net-define /etc/libvirt/qemu/networks/default.xml
</span></code><input type="hidden" value="virsh  net-define /etc/libvirt/qemu/networks/default.xml
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>标记为自动启动：</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">virsh</span> net-autostart default
</span><span class="code-line line-number" line="2"><span class="token comment"># Network default marked as autostarted</span>
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4"><span class="token function">virsh</span> net-start default
</span></code><input type="hidden" value="virsh net-autostart default
# Network default marked as autostarted

virsh net-start default
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>启动网络：</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">virsh</span> net-start default
</span><span class="code-line line-number" line="2"><span class="token comment"># Network default started</span>
</span></code><input type="hidden" value="virsh net-start default
# Network default started
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>网络启动后可以用命令brctl show 查看和验证。</p>
        <p>修改<code>vi /etc/sysctl.conf</code>中参数，允许ip转发，CentOS7是在<code>vi /usr/lib/sysctl.d/00-system.conf</code> 这里面修改</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token assign-left variable">net.ipv4.ip_forward</span><span class="token operator">=</span><span class="token number">1</span>
</span></code><input type="hidden" value="net.ipv4.ip_forward=1
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>通过 <code>sysctl -p</code> 查看修改结果</p>
        <h3 id="自定义nat网络"><a aria-hidden="true" tabindex="-1" href="#自定义nat网络" class="anchor"><span class="icon icon-link"></span></a>自定义NAT网络</h3>
        <p>创建名为<code>management</code>的NAT网络，<code>vi /usr/share/libvirt/networks/management.xml</code></p>
        <pre class="language-html"><code class="language-html code-highlight"><span class="code-line line-number" line="1"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>network</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="2">  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>name</span><span class="token punctuation">></span></span>management<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>name</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="3">  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>bridge</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>virbr1<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
</span><span class="code-line line-number" line="4">  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>forward</span><span class="token punctuation">/></span></span>
</span><span class="code-line line-number" line="5">  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>ip</span> <span class="token attr-name">address</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>192.168.123.1<span class="token punctuation">"</span></span> <span class="token attr-name">netmask</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>255.255.255.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="6">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>dhcp</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="7">      <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>range</span> <span class="token attr-name">start</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>192.168.123.2<span class="token punctuation">"</span></span> <span class="token attr-name">end</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>192.168.123.254<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
</span><span class="code-line line-number" line="8">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>dhcp</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="9">  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>ip</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="10"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>network</span><span class="token punctuation">></span></span>
</span></code><input type="hidden" value="<network>
  <name>management</name>
  <bridge name=&#x22;virbr1&#x22;/>
  <forward/>
  <ip address=&#x22;192.168.123.1&#x22; netmask=&#x22;255.255.255.0&#x22;>
    <dhcp>
      <range start=&#x22;192.168.123.2&#x22; end=&#x22;192.168.123.254&#x22;/>
    </dhcp>
  </ip>
</network>
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>启用新建的NAT网络</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">virsh</span> net-define /usr/share/libvirt/networks/management.xml
</span><span class="code-line line-number" line="2"><span class="token function">virsh</span> net-start management
</span><span class="code-line line-number" line="3"><span class="token function">virsh</span> net-autostart management
</span></code><input type="hidden" value="virsh net-define /usr/share/libvirt/networks/management.xml
virsh net-start management
virsh net-autostart management
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>验证</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">brctl show
</span><span class="code-line line-number" line="2"><span class="token comment"># bridge name bridge id   STP enabled interfaces</span>
</span><span class="code-line line-number" line="3"><span class="token comment"># br0   8000.3863bb44cf6c no    eno1</span>
</span><span class="code-line line-number" line="4"><span class="token comment">#               vnet0</span>
</span><span class="code-line line-number" line="5"><span class="token comment"># virbr0    8000.525400193f0f yes   virbr0-nic</span>
</span><span class="code-line line-number" line="6"><span class="token comment"># virbr1    8000.52540027f0ba yes   virbr1-nic</span>
</span><span class="code-line line-number" line="7">
</span><span class="code-line line-number" line="8"><span class="token function">virsh</span> net-list <span class="token parameter variable">--all</span>
</span><span class="code-line line-number" line="9"><span class="token comment">#  Name                 State      Autostart     Persistent</span>
</span><span class="code-line line-number" line="10"><span class="token comment"># ----------------------------------------------------------</span>
</span><span class="code-line line-number" line="11"><span class="token comment">#  default              active     no            no</span>
</span><span class="code-line line-number" line="12"><span class="token comment">#  management           active     yes           yes</span>
</span></code><input type="hidden" value="brctl show
# bridge name bridge id   STP enabled interfaces
# br0   8000.3863bb44cf6c no    eno1
#               vnet0
# virbr0    8000.525400193f0f yes   virbr0-nic
# virbr1    8000.52540027f0ba yes   virbr1-nic

virsh net-list --all
#  Name                 State      Autostart     Persistent
# ----------------------------------------------------------
#  default              active     no            no
#  management           active     yes           yes
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h3 id="退出虚拟机"><a aria-hidden="true" tabindex="-1" href="#退出虚拟机" class="anchor"><span class="icon icon-link"></span></a>退出虚拟机</h3>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token builtin class-name">exit</span> <span class="token comment"># 退出系统到登录界面</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3">Ctrl+5 <span class="token comment"># 从虚拟机登录页面，退出到宿主机命令行页面</span>
</span><span class="code-line line-number" line="4">Ctrl+<span class="token punctuation">]</span> <span class="token comment"># 或者下面</span>
</span></code><input type="hidden" value="exit # 退出系统到登录界面

Ctrl+5 # 从虚拟机登录页面，退出到宿主机命令行页面
Ctrl+] # 或者下面
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="修改虚拟机配置信息"><a aria-hidden="true" tabindex="-1" href="#修改虚拟机配置信息" class="anchor"><span class="icon icon-link"></span></a>修改虚拟机配置信息</h2>
        <p>直接通过vim命令修改</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">vim</span>  /etc/libvirt/qemu/centos72.xml
</span></code><input type="hidden" value="vim  /etc/libvirt/qemu/centos72.xml
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>通过virsh命令修改</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">virsh</span> edit centos72
</span></code><input type="hidden" value="virsh edit centos72
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="克隆虚拟机"><a aria-hidden="true" tabindex="-1" href="#克隆虚拟机" class="anchor"><span class="icon icon-link"></span></a>克隆虚拟机</h2>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># 暂停原始虚拟机</span>
</span><span class="code-line line-number" line="2"><span class="token function">virsh</span> <span class="token function">shutdown</span> centos72
</span><span class="code-line line-number" line="3">virt-clone <span class="token parameter variable">-o</span> centos72 <span class="token parameter variable">-n</span> centos.112 <span class="token parameter variable">-f</span> /home/vms/centos.112.qcow2 <span class="token parameter variable">-m</span> 00:00:00:00:00:01
</span><span class="code-line line-number" line="4">virt-clone <span class="token parameter variable">-o</span> centos88 <span class="token parameter variable">-n</span> centos.112 <span class="token parameter variable">--file</span> /home/vms/centos.112.qcow2 <span class="token parameter variable">--nonsparse</span>
</span></code><input type="hidden" value="# 暂停原始虚拟机
virsh shutdown centos72
virt-clone -o centos72 -n centos.112 -f /home/vms/centos.112.qcow2 -m 00:00:00:00:00:01
virt-clone -o centos88 -n centos.112 --file /home/vms/centos.112.qcow2 --nonsparse
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p><code>virt-clone</code> 参数介绍</p>
        <ul>
          <li><code>--version</code> 查看版本。</li>
          <li><code>-h，--help</code> 查看帮助信息。</li>
          <li><code>--connect=URI</code> 连接到虚拟机管理程序 libvirt 的URI。</li>
          <li><code>-o 原始虚拟机名称</code> 原始虚拟机名称，必须为关闭或者暂停状态。</li>
          <li><code>-n 新虚拟机名称</code> --name 新虚拟机名称。</li>
          <li><code>--auto-clone</code> 从原来的虚拟机配置自动生成克隆名称和存储路径。</li>
          <li><code>-u NEW_UUID, --uuid=NEW_UUID</code> 克隆虚拟机的新的UUID，默认值是一个随机生成的UUID。</li>
          <li><code>-m NEW_MAC, --mac=NEW_MAC</code> 设置一个新的mac地址，默认为随机生成 MAC。</li>
          <li><code>-f NEW_DISKFILE, --file=NEW_DISKFILE</code> 为新客户机使用新的磁盘镜像文件地址。</li>
          <li><code>--force-copy=TARGET</code> 强制复制设备。</li>
          <li><code>--nonsparse</code> 不使用稀疏文件复制磁盘映像。</li>
        </ul>
        <h2 id="通过镜像创建虚拟机"><a aria-hidden="true" tabindex="-1" href="#通过镜像创建虚拟机" class="anchor"><span class="icon icon-link"></span></a>通过镜像创建虚拟机</h2>
        <p>创建虚拟机镜像文件</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># 复制第一次安装的干净系统镜像，作为基础镜像文件，</span>
</span><span class="code-line line-number" line="2"><span class="token comment"># 后面创建虚拟机使用这个基础镜像</span>
</span><span class="code-line line-number" line="3"><span class="token function">cp</span> /home/vms/centos.88.qcow2 /home/vms/centos7.base.qcow2
</span><span class="code-line line-number" line="4">
</span><span class="code-line line-number" line="5"><span class="token comment"># 使用基础镜像文件，创建新的虚拟机镜像</span>
</span><span class="code-line line-number" line="6"><span class="token function">cp</span> /home/vms/centos7.base.qcow2 /home/vms/centos7.113.qcow2
</span></code><input type="hidden" value="# 复制第一次安装的干净系统镜像，作为基础镜像文件，
# 后面创建虚拟机使用这个基础镜像
cp /home/vms/centos.88.qcow2 /home/vms/centos7.base.qcow2

# 使用基础镜像文件，创建新的虚拟机镜像
cp /home/vms/centos7.base.qcow2 /home/vms/centos7.113.qcow2
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>创建虚拟机配置文件</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># 复制第一次安装的干净系统镜像，作为基础配置文件。</span>
</span><span class="code-line line-number" line="2"><span class="token function">virsh</span> dumpxml centos.88 <span class="token operator">></span> /home/vms/centos7.base.xml
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4"><span class="token comment"># 使用基础虚拟机镜像配置文件，创建新的虚拟机配置文件</span>
</span><span class="code-line line-number" line="5"><span class="token function">cp</span> /home/vms/centos7.base.xml /home/vms/centos7.113.xml
</span><span class="code-line line-number" line="6">
</span><span class="code-line line-number" line="7"><span class="token comment"># 编辑新虚拟机配置文件</span>
</span><span class="code-line line-number" line="8"><span class="token function">vi</span> /home/vms/centos7.113.xml
</span></code><input type="hidden" value="# 复制第一次安装的干净系统镜像，作为基础配置文件。
virsh dumpxml centos.88 > /home/vms/centos7.base.xml

# 使用基础虚拟机镜像配置文件，创建新的虚拟机配置文件
cp /home/vms/centos7.base.xml /home/vms/centos7.113.xml

# 编辑新虚拟机配置文件
vi /home/vms/centos7.113.xml
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>主要是修改虚拟机文件名，UUID，镜像地址和网卡地址，其中 UUID 在 Linux 下可以使用 <code>uuidgen</code> 命令生成</p>
        <pre class="language-html"><code class="language-html code-highlight"><span class="code-line line-number" line="1"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>domain</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>kvm<span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="2">  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>name</span><span class="token punctuation">></span></span>centos7.113<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>name</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="3">  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>uuid</span><span class="token punctuation">></span></span>1e86167a-33a9-4ce8-929e-58013fbf9122<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>uuid</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="4">  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>devices</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="5">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>disk</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>file<span class="token punctuation">'</span></span> <span class="token attr-name">device</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>disk<span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="6">      <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>source</span> <span class="token attr-name">file</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>/home/vms/centos7.113.img<span class="token punctuation">'</span></span><span class="token punctuation">/></span></span>
</span><span class="code-line line-number" line="7">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>disk</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="8">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>interface</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>bridge<span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="9">      <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>mac</span> <span class="token attr-name">address</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>00:00:00:00:00:04<span class="token punctuation">'</span></span><span class="token punctuation">/></span></span>
</span><span class="code-line line-number" line="10">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>interface</span><span class="token punctuation">></span></span>    
</span><span class="code-line line-number" line="11">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>devices</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="12"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>domain</span><span class="token punctuation">></span></span>
</span></code><input type="hidden" value="<domain type=&#x27;kvm&#x27;>
  <name>centos7.113</name>
  <uuid>1e86167a-33a9-4ce8-929e-58013fbf9122</uuid>
  <devices>
    <disk type=&#x27;file&#x27; device=&#x27;disk&#x27;>
      <source file=&#x27;/home/vms/centos7.113.img&#x27;/>
    </disk>
    <interface type=&#x27;bridge&#x27;>
      <mac address=&#x27;00:00:00:00:00:04&#x27;/>
    </interface>    
    </devices>
</domain>
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">virsh</span> define /home/vms/centos7.113.xml
</span><span class="code-line line-number" line="2"><span class="token comment"># Domain centos.113 defined from /home/vms/centos7.113.xml</span>
</span></code><input type="hidden" value="virsh define /home/vms/centos7.113.xml
# Domain centos.113 defined from /home/vms/centos7.113.xml
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="动态更改cpu数量和内存大小"><a aria-hidden="true" tabindex="-1" href="#动态更改cpu数量和内存大小" class="anchor"><span class="icon icon-link"></span></a>动态更改cpu数量和内存大小</h2>
        <p>动态调整，如果超过给虚拟机分配的最大内存，需要重启虚拟机。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">virsh</span> list <span class="token parameter variable">--all</span>
</span><span class="code-line line-number" line="2"><span class="token comment">#  Id    名称                         状态</span>
</span><span class="code-line line-number" line="3"><span class="token comment"># ----------------------------------------------------</span>
</span><span class="code-line line-number" line="4"><span class="token comment">#  2     working112                     running</span>
</span><span class="code-line line-number" line="5">
</span><span class="code-line line-number" line="6"><span class="token comment"># 更改CPU</span>
</span><span class="code-line line-number" line="7"><span class="token function">virsh</span> setvcpus working112 <span class="token parameter variable">--maximum</span> <span class="token number">4</span> <span class="token parameter variable">--config</span>
</span><span class="code-line line-number" line="8"><span class="token comment"># 更改内存</span>
</span><span class="code-line line-number" line="9"><span class="token function">virsh</span> setmaxmem working112 <span class="token number">1048576</span> <span class="token parameter variable">--config</span>
</span><span class="code-line line-number" line="10"><span class="token comment"># 查看信息</span>
</span><span class="code-line line-number" line="11"><span class="token function">virsh</span> dominfo working112
</span></code><input type="hidden" value="virsh list --all
#  Id    名称                         状态
# ----------------------------------------------------
#  2     working112                     running

# 更改CPU
virsh setvcpus working112 --maximum 4 --config
# 更改内存
virsh setmaxmem working112 1048576 --config
# 查看信息
virsh dominfo working112
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="挂载磁盘"><a aria-hidden="true" tabindex="-1" href="#挂载磁盘" class="anchor"><span class="icon icon-link"></span></a>挂载磁盘</h2>
        <h3 id="创建磁盘"><a aria-hidden="true" tabindex="-1" href="#创建磁盘" class="anchor"><span class="icon icon-link"></span></a>创建磁盘</h3>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">mkdir</span> /home/vms
</span></code><input type="hidden" value="mkdir /home/vms
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>查看镜像信息</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">virt-filesystems <span class="token parameter variable">--long</span> <span class="token parameter variable">--parts</span> <span class="token parameter variable">--blkdevs</span> <span class="token parameter variable">-h</span> <span class="token parameter variable">-a</span> working112.qcow2
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token comment"># Name       Type       Size  Parent</span>
</span><span class="code-line line-number" line="4"><span class="token comment"># /dev/sda1  partition  200M  /dev/sda</span>
</span><span class="code-line line-number" line="5"><span class="token comment"># /dev/sda2  partition  9.8G  /dev/sda</span>
</span><span class="code-line line-number" line="6"><span class="token comment"># /dev/sda   device     10G   -</span>
</span><span class="code-line line-number" line="7">
</span><span class="code-line line-number" line="8">qemu-img info working112.qcow2
</span><span class="code-line line-number" line="9">
</span><span class="code-line line-number" line="10"><span class="token comment"># image: working112.qcow2</span>
</span><span class="code-line line-number" line="11"><span class="token comment"># file format: qcow2</span>
</span><span class="code-line line-number" line="12"><span class="token comment"># virtual size: 140G (150323855360 bytes)</span>
</span><span class="code-line line-number" line="13"><span class="token comment"># disk size: 33G</span>
</span><span class="code-line line-number" line="14"><span class="token comment"># cluster_size: 65536</span>
</span><span class="code-line line-number" line="15"><span class="token comment"># Format specific information:</span>
</span><span class="code-line line-number" line="16"><span class="token comment">#     compat: 1.1</span>
</span><span class="code-line line-number" line="17"><span class="token comment">#     lazy refcounts: true</span>
</span></code><input type="hidden" value="virt-filesystems --long --parts --blkdevs -h -a working112.qcow2

# Name       Type       Size  Parent
# /dev/sda1  partition  200M  /dev/sda
# /dev/sda2  partition  9.8G  /dev/sda
# /dev/sda   device     10G   -

qemu-img info working112.qcow2

# image: working112.qcow2
# file format: qcow2
# virtual size: 140G (150323855360 bytes)
# disk size: 33G
# cluster_size: 65536
# Format specific information:
#     compat: 1.1
#     lazy refcounts: true
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>给虚拟机镜像添加<code>200G</code>大小，注意需要停止<code>working112</code>虚拟机</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">qemu-img resize working112.qcow2 +200G
</span><span class="code-line line-number" line="2"><span class="token comment"># Image resized.</span>
</span></code><input type="hidden" value="qemu-img resize working112.qcow2 +200G
# Image resized.
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>首先，我们制作如下所示的磁盘的备份副本。</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">cp</span> working112.qcow2 working112-orig.qcow2
</span></code><input type="hidden" value="cp working112.qcow2 working112-orig.qcow2
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>然后我们运行下面的命令来增加 <code>/dev/sda</code></p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">virt-resize <span class="token parameter variable">--expand</span> /dev/sda1 working112-orig.qcow2 working112.qcow2
</span></code><input type="hidden" value="virt-resize --expand /dev/sda1 working112-orig.qcow2 working112.qcow2
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>查看镜像信息</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">qemu-img info working112.qcow2
</span><span class="code-line line-number" line="2"><span class="token comment"># image: working112.qcow2</span>
</span><span class="code-line line-number" line="3"><span class="token comment"># file format: qcow2</span>
</span><span class="code-line line-number" line="4"><span class="token comment"># virtual size: 140G (150323855360 bytes)</span>
</span><span class="code-line line-number" line="5"><span class="token comment"># disk size: 33G</span>
</span><span class="code-line line-number" line="6"><span class="token comment"># cluster_size: 65536</span>
</span><span class="code-line line-number" line="7"><span class="token comment"># Format specific information:</span>
</span><span class="code-line line-number" line="8"><span class="token comment">#     compat: 1.1</span>
</span><span class="code-line line-number" line="9"><span class="token comment">#     lazy refcounts: true</span>
</span></code><input type="hidden" value="qemu-img info working112.qcow2
# image: working112.qcow2
# file format: qcow2
# virtual size: 140G (150323855360 bytes)
# disk size: 33G
# cluster_size: 65536
# Format specific information:
#     compat: 1.1
#     lazy refcounts: true
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>进入虚拟机<code>virsh console working112</code> 查看信息：</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">vgdisplay <span class="token comment"># 显示卷组大小</span>
</span><span class="code-line line-number" line="2">lvdisplay <span class="token comment"># 显示逻辑卷大小</span>
</span></code><input type="hidden" value="vgdisplay # 显示卷组大小
lvdisplay # 显示逻辑卷大小
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>卷组大小已增加，下面需要分配容量给逻辑卷</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">lvextend <span class="token parameter variable">-L</span> +60G /dev/centos/root
</span></code><input type="hidden" value="lvextend -L +60G /dev/centos/root
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>还有最后一步，分配好了需要做系统调整</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># ext 系统格式使用：</span>
</span><span class="code-line line-number" line="2">resize2fs /dev/centos/root
</span><span class="code-line line-number" line="3"><span class="token comment"># xfs 系统格式使用下面命令</span>
</span><span class="code-line line-number" line="4">xfs_growfs /dev/centos/root
</span></code><input type="hidden" value="# ext 系统格式使用：
resize2fs /dev/centos/root
# xfs 系统格式使用下面命令
xfs_growfs /dev/centos/root
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="常用命令说明"><a aria-hidden="true" tabindex="-1" href="#常用命令说明" class="anchor"><span class="icon icon-link"></span></a>常用命令说明</h2>
        <h3 id="virt-install"><a aria-hidden="true" tabindex="-1" href="#virt-install" class="anchor"><span class="icon icon-link"></span></a>virt-install</h3>
        <p>常用参数说明</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">–name指定虚拟机名称
</span><span class="code-line line-number" line="2">–memory分配内存大小。
</span><span class="code-line line-number" line="3">–vcpus分配CPU核心数，最大与实体机CPU核心数相同
</span><span class="code-line line-number" line="4">–disk指定虚拟机镜像，size指定分配大小单位为G。
</span><span class="code-line line-number" line="5">–network网络类型，此处用的是默认，一般用的应该是bridge桥接。
</span><span class="code-line line-number" line="6">–accelerate加速
</span><span class="code-line line-number" line="7">–cdrom指定安装镜像iso
</span><span class="code-line line-number" line="8">–vnc启用VNC远程管理，一般安装系统都要启用。
</span><span class="code-line line-number" line="9">–vncport指定VNC监控端口，默认端口为5900，端口不能重复。
</span><span class="code-line line-number" line="10">–vnclisten指定VNC绑定IP，默认绑定127.0.0.1，这里改为0.0.0.0。
</span><span class="code-line line-number" line="11">–os-type<span class="token operator">=</span>linux,windows
</span><span class="code-line line-number" line="12">–os-variant<span class="token operator">=</span>rhel6
</span><span class="code-line line-number" line="13">
</span><span class="code-line line-number" line="14"><span class="token parameter variable">--name</span>      指定虚拟机名称
</span><span class="code-line line-number" line="15"><span class="token parameter variable">--ram</span>       虚拟机内存大小，以 MB 为单位
</span><span class="code-line line-number" line="16"><span class="token parameter variable">--vcpus</span>     分配CPU核心数，最大与实体机CPU核心数相同
</span><span class="code-line line-number" line="17">–-vnc       启用VNC远程管理，一般安装系统都要启用。
</span><span class="code-line line-number" line="18">–-vncport   指定VNC监控端口，默认端口为5900，端口不能重复。
</span><span class="code-line line-number" line="19">–-vnclisten  指定VNC绑定IP，默认绑定127.0.0.1，这里改为0.0.0.0。
</span><span class="code-line line-number" line="20"><span class="token parameter variable">--network</span>   虚拟机网络配置
</span><span class="code-line line-number" line="21">  <span class="token comment"># 其中子选项，bridge=br0 指定桥接网卡的名称。</span>
</span><span class="code-line line-number" line="22">
</span><span class="code-line line-number" line="23">–os-type<span class="token operator">=</span>linux,windows
</span><span class="code-line line-number" line="24">–os-variant<span class="token operator">=</span>rhel7.2
</span><span class="code-line line-number" line="25">
</span><span class="code-line line-number" line="26"><span class="token parameter variable">--disk</span> 指定虚拟机的磁盘存储位置
</span><span class="code-line line-number" line="27">  <span class="token comment"># size，初始磁盘大小，以 GB 为单位。</span>
</span><span class="code-line line-number" line="28">
</span><span class="code-line line-number" line="29"><span class="token parameter variable">--location</span> 指定安装介质路径，如光盘镜像的文件路径。
</span><span class="code-line line-number" line="30"><span class="token parameter variable">--graphics</span> 图形化显示配置
</span><span class="code-line line-number" line="31">  <span class="token comment"># 全新安装虚拟机过程中可能会有很多交互操作，比如设置语言，初始化 root 密码等等。</span>
</span><span class="code-line line-number" line="32">  <span class="token comment"># graphics 选项的作用就是配置图形化的交互方式，可以使用 vnc（一种远程桌面软件）进行链接。</span>
</span><span class="code-line line-number" line="33">  <span class="token comment"># 我们这列使用命令行的方式安装，所以这里要设置为 none，但要通过 --extra-args 选项指定终端信息，</span>
</span><span class="code-line line-number" line="34">  <span class="token comment"># 这样才能将安装过程中的交互信息输出到当前控制台。</span>
</span><span class="code-line line-number" line="35">--extra-args 根据不同的安装方式设置不同的额外选项
</span></code><input type="hidden" value="–name指定虚拟机名称
–memory分配内存大小。
–vcpus分配CPU核心数，最大与实体机CPU核心数相同
–disk指定虚拟机镜像，size指定分配大小单位为G。
–network网络类型，此处用的是默认，一般用的应该是bridge桥接。
–accelerate加速
–cdrom指定安装镜像iso
–vnc启用VNC远程管理，一般安装系统都要启用。
–vncport指定VNC监控端口，默认端口为5900，端口不能重复。
–vnclisten指定VNC绑定IP，默认绑定127.0.0.1，这里改为0.0.0.0。
–os-type=linux,windows
–os-variant=rhel6

--name      指定虚拟机名称
--ram       虚拟机内存大小，以 MB 为单位
--vcpus     分配CPU核心数，最大与实体机CPU核心数相同
–-vnc       启用VNC远程管理，一般安装系统都要启用。
–-vncport   指定VNC监控端口，默认端口为5900，端口不能重复。
–-vnclisten  指定VNC绑定IP，默认绑定127.0.0.1，这里改为0.0.0.0。
--network   虚拟机网络配置
  # 其中子选项，bridge=br0 指定桥接网卡的名称。

–os-type=linux,windows
–os-variant=rhel7.2

--disk 指定虚拟机的磁盘存储位置
  # size，初始磁盘大小，以 GB 为单位。

--location 指定安装介质路径，如光盘镜像的文件路径。
--graphics 图形化显示配置
  # 全新安装虚拟机过程中可能会有很多交互操作，比如设置语言，初始化 root 密码等等。
  # graphics 选项的作用就是配置图形化的交互方式，可以使用 vnc（一种远程桌面软件）进行链接。
  # 我们这列使用命令行的方式安装，所以这里要设置为 none，但要通过 --extra-args 选项指定终端信息，
  # 这样才能将安装过程中的交互信息输出到当前控制台。
--extra-args 根据不同的安装方式设置不同的额外选项
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h3 id="virsh"><a aria-hidden="true" tabindex="-1" href="#virsh" class="anchor"><span class="icon icon-link"></span></a>virsh</h3>
        <p>基础命令</p>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">virsh</span> list <span class="token parameter variable">--all</span>           <span class="token comment"># 查看所有运行和没有运行的虚拟机</span>
</span><span class="code-line line-number" line="2"><span class="token function">virsh</span> list                 <span class="token comment"># 查看在运行的虚拟机</span>
</span><span class="code-line line-number" line="3"><span class="token function">virsh</span> dumpxml vm-name      <span class="token comment"># 查看kvm虚拟机配置文件</span>
</span><span class="code-line line-number" line="4"><span class="token function">virsh</span> start vm-name        <span class="token comment"># 启动kvm虚拟机</span>
</span><span class="code-line line-number" line="5"><span class="token function">virsh</span> <span class="token function">shutdown</span> vm-name     <span class="token comment"># 正常关机</span>
</span><span class="code-line line-number" line="6">
</span><span class="code-line line-number" line="7"><span class="token function">virsh</span> destroy vm-name      <span class="token comment"># 非正常关机，强制关闭虚拟机（相当于物理机直接拔掉电源）</span>
</span><span class="code-line line-number" line="8"><span class="token function">virsh</span> undefine vm-name     <span class="token comment"># 删除vm的配置文件</span>
</span><span class="code-line line-number" line="9">
</span><span class="code-line line-number" line="10"><span class="token function">ls</span> /etc/libvirt/qemu
</span><span class="code-line line-number" line="11"><span class="token comment"># 查看删除结果，Centos-6.6的配置文件被删除，但磁盘文件不会被删除</span>
</span><span class="code-line line-number" line="12">
</span><span class="code-line line-number" line="13"><span class="token function">virsh</span> define file-name.xml <span class="token comment"># 根据配置文件定义虚拟机</span>
</span><span class="code-line line-number" line="14"><span class="token function">virsh</span> <span class="token function">suspend</span> vm-name      <span class="token comment"># 挂起，终止</span>
</span><span class="code-line line-number" line="15"><span class="token function">virsh</span> resumed vm-name      <span class="token comment"># 恢复被挂起的虚拟机</span>
</span><span class="code-line line-number" line="16"><span class="token function">virsh</span> autostart vm-name    <span class="token comment"># 开机自启动vm</span>
</span><span class="code-line line-number" line="17"><span class="token function">virsh</span> console <span class="token operator">&#x3C;</span>虚拟机名称<span class="token operator">></span>   <span class="token comment"># 连接虚拟机</span>
</span></code><input type="hidden" value="virsh list --all           # 查看所有运行和没有运行的虚拟机
virsh list                 # 查看在运行的虚拟机
virsh dumpxml vm-name      # 查看kvm虚拟机配置文件
virsh start vm-name        # 启动kvm虚拟机
virsh shutdown vm-name     # 正常关机

virsh destroy vm-name      # 非正常关机，强制关闭虚拟机（相当于物理机直接拔掉电源）
virsh undefine vm-name     # 删除vm的配置文件

ls /etc/libvirt/qemu
# 查看删除结果，Centos-6.6的配置文件被删除，但磁盘文件不会被删除

virsh define file-name.xml # 根据配置文件定义虚拟机
virsh suspend vm-name      # 挂起，终止
virsh resumed vm-name      # 恢复被挂起的虚拟机
virsh autostart vm-name    # 开机自启动vm
virsh console <虚拟机名称>   # 连接虚拟机
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="错误解决"><a aria-hidden="true" tabindex="-1" href="#错误解决" class="anchor"><span class="icon icon-link"></span></a>错误解决</h2>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1">console <span class="token builtin class-name">test</span>
</span><span class="code-line line-number" line="2">Connected to domain <span class="token builtin class-name">test</span>
</span><span class="code-line line-number" line="3">Escape character is ^<span class="token punctuation">]</span>
</span></code><input type="hidden" value="console test
Connected to domain test
Escape character is ^]
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <p>如果出现上面字符串使用 <kbd>CTRL+Shift+5</kbd> <kbd>CTRL+Shift+]</kbd></p>
        <ol>
          <li>
            <p>
              ERROR Format cannot be specified for unmanaged storage.
              virt-manager 没有找到存储池，创建储存池即可
            </p>
          </li>
          <li>
            <p>
              KVM VNC客户端连接闪退
              使用real vnc或者其它vnc客户端连接kvm闪退，把客户端设置中的ColourLevel值设置为rgb222或full即可
            </p>
          </li>
          <li>
            <p>virsh shutdown 
              <domain>
                无法关闭虚拟机
                使用该命令关闭虚拟机时，KVM是向虚拟机发送一个ACPI的指令，需要虚拟机安装acpid服务：
              </domain>
            </p>
          </li>
          <li>
            <p>operation failed: Active console session exists for this domain</p>
          </li>
        </ol>
        <pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token comment"># 方案1</span>
</span><span class="code-line line-number" line="2">$ <span class="token function">ps</span> aux <span class="token operator">|</span> <span class="token function">grep</span> console
</span><span class="code-line line-number" line="3">$ <span class="token function">kill</span> <span class="token parameter variable">-9</span> <span class="token operator">&#x3C;</span>进程号<span class="token operator">></span>
</span><span class="code-line line-number" line="4"><span class="token comment"># 方案2</span>
</span><span class="code-line line-number" line="5">$ /etc/init.d/libvirt-bin restart
</span><span class="code-line line-number" line="6"><span class="token comment"># 方案3</span>
</span><span class="code-line line-number" line="7">$ <span class="token function">ps</span> aux <span class="token operator">|</span> <span class="token function">grep</span> kvm
</span><span class="code-line line-number" line="8">$ <span class="token function">kill</span> 对应的虚拟机进程
</span></code><input type="hidden" value="# 方案1
$ ps aux | grep console
$ kill -9 <进程号>
# 方案2
$ /etc/init.d/libvirt-bin restart
# 方案3
$ ps aux | grep kvm
$ kill 对应的虚拟机进程
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="参考文章"><a aria-hidden="true" tabindex="-1" href="#参考文章" class="anchor"><span class="icon icon-link"></span></a>参考文章</h2>
        <ul>
          <li><a href="https://www.linux-kvm.org/page/Main_Page">KVM官方网站</a></li>
          <li><a href="http://www.cnblogs.com/ilanni/p/3878151.html">KVM虚拟机Linux系统增加硬盘</a></li>
          <li><a href="https://www.ibm.com/support/knowledgecenter/zh/linuxonibm/liaat/liaatvirtinstalloptions.htm">virt-install 命令参数详解</a></li>
          <li><a href="https://raymii.org/s/articles/virt-install_introduction_and_copy_paste_distro_install_commands.html">使用virt-install安装虚拟机，发行版安装代码直接复制运行</a></li>
          <li><a href="http://blog.oneiroi.co.uk/linux/kvm/virt-resize/RHEL/LVM/kvm-linux-expanding-a-lvm-guest-file-system-using-virt-resize/">KVM Linux - Expanding a Guest LVM File System Using Virt-resize</a></li>
        </ul>
        <div class="previous"><a class="prev" href="常用基础命令.html"><svg viewBox="0 0 1024 1024" width="16" height="16" fill="currentColor">
              <path d="M842.666667 864c-8.533333 0-14.933333-2.133333-21.333334-8.533333l-341.333333-309.333334c-6.4-6.4-10.666667-14.933333-10.666667-23.466666 0-8.533333 4.266667-17.066667 10.666667-23.466667l341.333333-309.333333c12.8-12.8 34.133333-10.666667 44.8 2.133333 12.8 12.8 10.666667 34.133333-2.133333 44.8L548.266667 522.666667l315.733333 285.866666c12.8 10.666667 14.933333 32 2.133333 44.8-6.4 6.4-14.933333 10.666667-23.466666 10.666667z"></path>
              <path d="M512 864c-8.533333 0-14.933333-2.133333-21.333333-8.533333L149.333333 546.133333c-6.4-6.4-10.666667-14.933333-10.666666-23.466666 0-8.533333 4.266667-17.066667 10.666666-23.466667L490.666667 189.866667c12.8-12.8 34.133333-10.666667 44.8 2.133333 12.8 12.8 10.666667 34.133333-2.133334 44.8L217.6 522.666667 533.333333 808.533333c12.8 12.8 14.933333 32 2.133334 44.8-6.4 6.4-14.933333 10.666667-23.466667 10.666667z"></path>
            </svg>
<span>常用基础命令
</span></a><a class="next" href="CentOS7更换yum软件镜像源.html"><span>更换 yum 软件镜像源
</span><svg viewBox="0 0 1024 1024" width="16" height="16" fill="currentColor">
              <path d="M544 522.666667c0-8.533333-4.266667-17.066667-10.666667-23.466667L192 189.866667c-12.8-12.8-34.133333-10.666667-44.8 2.133333-12.8 12.8-10.666667 34.133333 2.133333 44.8l315.733334 285.866667L149.333333 808.533333c-12.8 12.8-14.933333 32-2.133333 44.8 6.4 6.4 14.933333 10.666667 23.466667 10.666667 8.533333 0 14.933333-2.133333 21.333333-8.533333l341.333333-309.333334c6.4-6.4 10.666667-14.933333 10.666667-23.466666z"></path>
              <path d="M864 499.2l-341.333333-309.333333c-12.8-12.8-34.133333-10.666667-44.8 2.133333-12.8 12.8-10.666667 34.133333 2.133333 44.8l315.733333 285.866667-315.733333 285.866666c-12.8 12.8-14.933333 32-2.133333 44.8 6.4 6.4 14.933333 10.666667 23.466666 10.666667 8.533333 0 14.933333-2.133333 21.333334-8.533333l341.333333-309.333334c6.4-6.4 10.666667-14.933333 10.666667-23.466666 0-8.533333-4.266667-17.066667-10.666667-23.466667z"></path>
            </svg></a></div>
        <section class="article-footer"><a href="https://github.com/jaywcjlove/handbook/blob/master/docs/CentOS/CentOS7安装KVM虚拟机详解.md" class="edit-button" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
            </svg>
<span>Edit this page on GitHub</span>
</a><span class="atime">2025/02/08</span></section>
      </markdown-style>
      <nav class="tocs">
        <aside class="inner toc">
          <ol class="tocs-list">
            <li><a href="#检测是否支持kvm" class="tocs-link">检测是否支持KVM</a></li>
            <li><a href="#安装-kvm-环境" class="tocs-link">安装 KVM 环境</a></li>
            <li><a href="#安装虚拟机" class="tocs-link">安装虚拟机</a>
              <ol class="tocs-list is-collapsed">
                <li><a href="#命令行配置系统" class="tocs-link">命令行配置系统</a></li>
                <li><a href="#连接虚拟机" class="tocs-link">连接虚拟机</a></li>
                <li><a href="#虚拟机其它管理" class="tocs-link">虚拟机其它管理</a></li>
              </ol>
            </li>
            <li><a href="#配置物理机网络" class="tocs-link">配置物理机网络</a></li>
            <li><a href="#端口转发" class="tocs-link">端口转发</a></li>
            <li><a href="#公网访问虚拟机" class="tocs-link">公网访问虚拟机</a></li>
            <li><a href="#配置宿主机网络" class="tocs-link">配置宿主机网络</a>
              <ol class="tocs-list is-collapsed">
                <li><a href="#bridge模式配置" class="tocs-link">Bridge模式配置</a></li>
                <li><a href="#nat模式" class="tocs-link">NAT模式</a></li>
                <li><a href="#自定义nat网络" class="tocs-link">自定义NAT网络</a></li>
                <li><a href="#退出虚拟机" class="tocs-link">退出虚拟机</a></li>
              </ol>
            </li>
            <li><a href="#修改虚拟机配置信息" class="tocs-link">修改虚拟机配置信息</a></li>
            <li><a href="#克隆虚拟机" class="tocs-link">克隆虚拟机</a></li>
            <li><a href="#通过镜像创建虚拟机" class="tocs-link">通过镜像创建虚拟机</a></li>
            <li><a href="#动态更改cpu数量和内存大小" class="tocs-link">动态更改cpu数量和内存大小</a></li>
            <li><a href="#挂载磁盘" class="tocs-link">挂载磁盘</a>
              <ol class="tocs-list is-collapsed">
                <li><a href="#创建磁盘" class="tocs-link">创建磁盘</a></li>
              </ol>
            </li>
            <li><a href="#常用命令说明" class="tocs-link">常用命令说明</a>
              <ol class="tocs-list is-collapsed">
                <li><a href="#virt-install" class="tocs-link">virt-install</a></li>
                <li><a href="#virsh" class="tocs-link">virsh</a></li>
              </ol>
            </li>
            <li><a href="#错误解决" class="tocs-link">错误解决</a></li>
            <li><a href="#参考文章" class="tocs-link">参考文章</a></li>
          </ol>
        </aside>
      </nav>
    </div>
    <script src="../js/demo-preview.js?v=1.34.1"></script>
    <div class="footer warpper">
      <a href="https://wangchujiang.com/#/app" target="_blank">App</a> •
      <a href="https://wangchujiang.com/#/projects" target="_blank">Projects</a> •
      <a href="https://wangchujiang.com/#/sponsor" target="_blank">Sponsor</a> •
      <a href="https://wangchujiang.com/#/app" target="_blank">More Apps</a><br><br>Released under the MIT License. Copyright © 2024 <a href="https://wangchujiang.com/#/about" target="_blank">Kenny Wong</a><br>Generated by <a href="https://github.com/jaywcjlove/idoc" target="_blank">idoc</a> v1.34.1
    </div>
    <script src="../js/tocbot.js?v=1.34.1"></script>
  </body>
</html>
