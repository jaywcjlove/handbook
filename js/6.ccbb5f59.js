(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{524:function(n,s){n.exports="\x3c!--\ntitle: samba\nsort: 6\n--\x3e\n\n# sambaç®€ä»‹\n\n[samba](https://www.samba.org/)ï¼Œæ˜¯ä¸€ä¸ªåŸºäº[GPL](https://www.samba.org/samba/docs/GPL.html)åè®®çš„è‡ªç”±è½¯ä»¶ã€‚å®ƒé‡æ–°å®ç°äº†[SMB/CIFS](https://en.wikipedia.org/wiki/Server_Message_Block)åè®®ï¼Œå¯ä»¥åœ¨å„ä¸ªå¹³å°å…±äº«æ–‡ä»¶å’Œæ‰“å°æœºã€‚\n\n1991å¹´ï¼Œè¿˜æ˜¯å¤§å­¦ç”Ÿçš„[Andrew Tridgwell](https://en.wikipedia.org/wiki/Andrew_Tridgell)ï¼Œæœ‰ä¸‰å°æœºå™¨ï¼Œåˆ†åˆ«æ˜¯Microsoftçš„DOSç³»ç»Ÿã€DECçš„Digital Unixç³»ç»Ÿã€ä»¥åŠSunçš„Unixç³»ç»Ÿã€‚å½“æ—¶çš„æŠ€æœ¯æ— æ³•è®©ä¸‰è€…å…±äº«æ–‡ä»¶ã€‚ä¸ºæ­¤ï¼Œä»–å¼€å‘äº†sambaå¹¶å°†å…¶å¼€æºã€‚\n\næœ¬æ¥æ”¹åä¸ºsmbserverï¼Œä½†æ˜¯ä¸€å®¶å•†ä¸šå…¬å¸æ³¨å†Œäº†SMBServerå•†æ ‡ã€‚ä»–è¢«å‘ŠçŸ¥ä¸èƒ½ä½¿ç”¨ã€‚äºæ˜¯æ‰§è¡Œäº†`grep -i '^s.*m.*b' /usr/share/dict/words`ï¼Œä»ä¸­é€‰æ‹©äº†sambaè¿™ä¸ªè¯ã€‚æˆ‘è§‰å¾—è¿™ä¸ªæ˜¯ä¸€ä¸ªå¥½æƒ³æ³•ï¼Œä»¥åæˆ‘ä¹Ÿå¾—ç€ä¹ˆå¹²ğŸ˜„ã€‚\n\n# å®‰è£…\n\n```bash\nyum -y install samba samba-client samba-common\n```\n\n# ä¿®æ”¹ samba çš„é…ç½®æ–‡ä»¶\n\nvim åœ¨æ–‡ä»¶å‚æ•°åé¢æ¥ `+` å¯ä»¥ç›´æ¥æ‰“å¼€åˆ°æ–‡ä»¶æœ«å°¾ï¼Œç›¸å½“äºåœ¨å‘½ä»¤è¡Œæ¨¡å¼ä¸‹æŒ‰ `G`ï¼Œç„¶åç›´æ¥æŒ‰ `o` å¯ä»¥åœ¨ä¸‹ä¸€è¡Œæ’å…¥ä¸‹é¢å†…å®¹ã€‚\n\n```bash\nsudo vim /etc/samba/smb.conf +\ntestparm # æµ‹è¯•smb.confé…ç½®æ˜¯å¦æ­£ç¡®\ntestparm â€“v # å‘½ä»¤å¯ä»¥è¯¦ç»†çš„åˆ—å‡ºsmb.confæ”¯æŒçš„é…ç½®å‚æ•°\n```\n\n## é…ç½®è¯´æ˜\n\n```bash\n[myshare] \ncomment = My share \npath = /home/public                     # å…±äº«è·¯å¾„ \nbrowseable = Yes                        # å¯ä»¥è¢«æµè§ˆï¼Œå°±æ˜¯åœ¨ç½‘ç»œé‚»å±…ä¸­èƒ½çœ‹åˆ°å…±äº«å \nread only = No                          # å¯è¯»å†™ \nguest ok = Yes                          # å…è®¸åŒ¿åè®¿é—®ï¼Œè¿™ä¸ªä¹Ÿéœ€è¦è®¾ç½®ï¼Œå¦åˆ™åŒ¿åæ— æ³•è®¿é—® \nvalid users = samba liuag guest         # æœ‰æ•ˆçš„ç”¨æˆ·å’Œç»„ \ninvalid users = liuben                  # æ— æ•ˆç”¨æˆ·å’Œç»„    \nread list = samba                       # åªè¯»ç”¨æˆ·å’Œç»„(å¦‚æœread only = Noï¼Œåªè¯»ç”¨æˆ·éœ€è¦åœ¨æ­¤è®¾ç½®) \nwrite list = liuag                      # å¯è¯»å†™ç”¨æˆ·å’Œç»„(å¦‚æœread only = Yesï¼Œå¯è¯»å†™ç”¨æˆ·éœ€è¦åœ¨æ­¤è®¾ç½®) \nallow hosts = 192.168.100.236    # å…è®¸è®¿é—®ä¸»æœºåˆ—è¡¨ï¼Œæ”¯æŒé€šé…ç¬¦ \ndeny hosts = 192.168.100.0/24    # ç¦æ­¢è®¿é—®ä¸»æœºåˆ—è¡¨ï¼Œæ”¯æŒé€šé…ç¬¦ \n\n\nsecurity = user #è¿™é‡ŒæŒ‡å®šsambaçš„å®‰å…¨ç­‰çº§ã€‚å…³äºå®‰å…¨ç­‰çº§æœ‰å››ç§ï¼š\n  # shareï¼šç”¨æˆ·ä¸éœ€è¦è´¦æˆ·åŠå¯†ç å³å¯ç™»å½•sambaæœåŠ¡å™¨\n  # userï¼šç”±æä¾›æœåŠ¡çš„sambaæœåŠ¡å™¨è´Ÿè´£æ£€æŸ¥è´¦æˆ·åŠå¯†ç ï¼ˆé»˜è®¤ï¼‰\n  # serverï¼šæ£€æŸ¥è´¦æˆ·åŠå¯†ç çš„å·¥ä½œç”±å¦ä¸€å°windowsæˆ–sambaæœåŠ¡å™¨è´Ÿè´£\n  # domainï¼šæŒ‡å®šwindowsåŸŸæ§åˆ¶æœåŠ¡å™¨æ¥éªŒè¯ç”¨æˆ·çš„è´¦æˆ·åŠå¯†ç ã€‚\n\n\n```\n\n# é‡å¯æœåŠ¡\n\n```\nsystemctl restart smb\nsystemctl reload smb\nsystemctl status smb\n```\n\n# æŸ¥çœ‹å®‰è£…çŠ¶å†µ\n\n```\nrpm -qa|grep samba\n```\n\n# è®¾ç½®å¼€æœºè‡ªå¯åŠ¨\n\n```\nchkconfig --level 35 smb on             //åœ¨3ã€5çº§åˆ«ä¸Šè‡ªåŠ¨è¿è¡ŒsambaæœåŠ¡\n```\n\n# sambaç”¨æˆ·ç®¡ç†\n\n```\npdbedit â€“a usernameï¼šæ–°å»ºSambaè´¦æˆ·ã€‚\npdbedit â€“x usernameï¼šåˆ é™¤Sambaè´¦æˆ·ã€‚\npdbedit â€“Lï¼šåˆ—å‡ºSambaç”¨æˆ·åˆ—è¡¨ï¼Œè¯»å–passdb.tdbæ•°æ®åº“æ–‡ä»¶ã€‚\npdbedit â€“Lvï¼šåˆ—å‡ºSambaç”¨æˆ·åˆ—è¡¨çš„è¯¦ç»†ä¿¡æ¯ã€‚\npdbedit â€“c â€œ[D]â€ â€“u usernameï¼šæš‚åœè¯¥Sambaç”¨æˆ·çš„è´¦å·ã€‚\npdbedit â€“c â€œ[]â€ â€“u usernameï¼šæ¢å¤è¯¥Sambaç”¨æˆ·çš„è´¦å·ã€‚\n\n\nsmbpasswd -a å¢åŠ ç”¨æˆ·ï¼ˆè¦å¢åŠ çš„ç”¨æˆ·å¿…é¡»ä»¥æ˜¯ç³»ç»Ÿç”¨æˆ·ï¼‰   \nsmbpasswd -d å†»ç»“ç”¨æˆ·ï¼Œå°±æ˜¯è¿™ä¸ªç”¨æˆ·ä¸èƒ½åœ¨ç™»å½•äº†   \nsmbpasswd -e æ¢å¤ç”¨æˆ·ï¼Œè§£å†»ç”¨æˆ·ï¼Œè®©å†»ç»“çš„ç”¨æˆ·å¯ä»¥åœ¨ä½¿ç”¨   \nsmbpasswd -n æŠŠç”¨æˆ·çš„å¯†ç è®¾ç½®æˆç©º.   \n             è¦åœ¨globalä¸­å†™å…¥ null passwords -true   \nsmbpasswd -x  åˆ é™¤ç”¨æˆ·  \n```\n\n\n`netstat -anlp | grep samba` \n\n# å…³é—­é˜²ç«å¢™\n\n```bash\nsystemctl stop firewalld        #å…³é—­é˜²ç«å¢™\nsystemctl disable firewalld        #å¼€æœºç¦ç”¨é˜²ç«å¢™\n```\n\n\nå¦‚ä½•è®©Finderä¸åœ¨è¿œç¨‹è¿æ¥æ—¶äº§ç”Ÿ`.DS_Store`æ‰“å¼€Macçš„Terminalï¼Œè¾“å…¥\n\n```bash\ndefaults write com.apple.desktopservices DSDontWriteNetworkStores true\n```\n\nç„¶åé‡å¯Macï¼Œå†è¯•è¯•è¿œç¨‹è¿æ¥ã€‚\n\n# é”™è¯¯è§£å†³\n\n## å¢åŠ sambaç”¨æˆ·æç¤ºFailed to add entry for user\n\n```\n[root@ubuntu ~]# smbpasswd -a wcj\nNew SMB password:\nRetype new SMB password:\nFailed to add entry for user wcj.\n\n```\n\n**è§£å†³åŠæ³•:**\n\nè¿™æ˜¯å› ä¸ºæ²¡æœ‰åŠ ç›¸åº”çš„ç³»ç»Ÿè´¦å·ï¼Œæ‰€ä»¥ä¼šæç¤º`Failed to add entry for user`çš„é”™è¯¯ï¼Œåªéœ€å¢åŠ ç›¸åº”çš„ç³»ç»Ÿè´¦å·`wcj`å°±å¯ä»¥äº†:\n\n`sudo useradd wcj`\n`useradd -g test wcj`   æ³¨ï¼šæ–°å»ºwcjç”¨æˆ·å¹¶å¢åŠ åˆ°testå·¥ä½œç»„   \n\nè€Œä¸”sambaçš„ç™»å½•å¯†ç å¯ä»¥å’Œæœ¬æœºç™»å½•å¯†ç ä¸ä¸€æ ·ã€‚  \n\n`sudo touch /etc/samba/smbpasswd`  \n`sudo smbpasswd -a wcj`  \n\n\n`smbclient -L \\\\192.168.0.104 -U username`  \n`smbclient  //192.168.60.231/username` #ç™»å½•SambaæœåŠ¡å™¨  \n\n## æˆ‘çš„é…ç½®\n\n```\n[global]\n    workgroup = MYGROUP\n    server string = Samba Server Version %v\n\n    # log files split per-machine:\n    log file = /var/log/samba/log.%m\n    # maximum size of 50KB per log file, then rotate:\n    max log size = 50\n\n    security = user\n    passdb backend = tdbsam\n\n    load printers = yes\n    cups options = raw\n\n    printcap name = /dev/null\n    ;printable = yes\n\n    directory mask =0777\n    force directorymode = 0777\n    directorysecurity mask = 0777\n    force directorysecurity mode = 0777\n    create mask =0777\n    force createmode = 0777\n    security mask =0777\n    force securitymode = 0777\n\n[homes]\n    comment = Home Directories\n    browseable = no\n    writable = yes\n;   valid users = %S\n;   valid users = MYDOMAIN\\%S\n[dev]\n    path = /home/wangchuajiang/shared\n    writeable = yes\n    browseable = yes\n    write list = wangchujiang\n```\n\n## session setup failed\n\n[sambaæŠ¥é”™ï¼šsession setup failed: NT_STATUS_LOGON_FAILURE è§£å†³](http://shineforever.blog.51cto.com/1429204/317305/)\n\n## é”™è¯¯ä¸‰\n\n[Failed to retrieve printer list: NT_STATUS_UNSUCCESSFULè§£å†³](http://www.sotechdesign.com.au/samba-log-showing-error-failed-to-retrieve-printer-list/)\n\n```\nprinting = bsd\nprintcap name = /dev/null\n```\n\n## é”™è¯¯å››\n\nsecurityä¸å†æ”¯æŒshare  \nWARNING: Ignoring invalid value 'share' forparameter 'security'  \n\n## é”™è¯¯äº”\n\nè¯·æ£€æŸ¥æœåŠ¡å™¨åç§°æˆ– IP åœ°å€ï¼Œç„¶åå†è¯•ä¸€æ¬¡ã€‚å¦‚æœé—®é¢˜æŒç»­å‘ç”Ÿï¼Œè¯·è”ç³»ç³»ç»Ÿç®¡ç†å‘˜ã€‚\n\nè§£å†³åŠæ³•ï¼šé‡å¯ç”µè„‘\n\n## é”™è¯¯å…­\n\n```bash\n# è§£æ±ºæ–¹æ³•ï¼šæ–¼smb.confä¸­åŠ å…¥ä»¥ä¸‹è¨­å®š \nload printers = no \nprinting = bsd \nprintcap name = /dev/null \ndisable spoolss = yes \n```\n\n[about:Unable to connect to CUPS server localhost:631 - Connection refused](http://blog.csdn.net/wzhwho/article/details/6275063)\n\n## é”™è¯¯å…­\n\nSTATUS=daemon 'smbd' finished starting up and ready to serve connections\n\n# å‚è€ƒ\n\n[sambaå®˜ç½‘](https://www.samba.org)  \n[Macè¿æ¥è¿œç¨‹Linuxç®¡ç†æ–‡ä»¶ï¼ˆsambaï¼‰](http://www.jianshu.com/p/fe7fd0286c4e)  \n[ç®€å•çš„é…ç½® samba å…±äº«](http://www.jianshu.com/p/a6d70f1fbfa1)  \n[Ubuntuä¸‹é…ç½®sambaæœåŠ¡å™¨](http://my.oschina.net/junn/blog/171388)  \n[linux6-sambaæœåŠ¡å™¨ï¼†SSHå·¥å…·](http://www.jianshu.com/p/a6d70f1fbfa1)  \n[CentOS7å®‰è£…é…ç½®SAMBAæœåŠ¡å™¨](http://www.cnblogs.com/kluan/p/4452684.html)  "}}]);